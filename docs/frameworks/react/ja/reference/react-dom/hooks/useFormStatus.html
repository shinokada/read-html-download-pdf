<!doctype html><html lang="ja"><meta charset="utf-8"><title>useFormStatus</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="useformstatus"><h1 id="useformstatus">useFormStatus</h1><p>canary: true</p><canary><p><code>useFormStatus</code> ãƒ•ãƒƒã‚¯ã¯ã€ç¾åœ¨ React ã® Canary ãŠã‚ˆã³ experimental ãƒãƒ£ãƒ³ãƒãƒ«ã§ã®ã¿åˆ©ç”¨å¯èƒ½ã§ã™ã€‚<a href="/community/versioning-policy#all-release-channels">ãƒªãƒªãƒ¼ã‚¹ãƒãƒ£ãƒ³ãƒãƒ«ã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„</a>ã€‚</p></canary><intro><p><code>useFormStatus</code> ã¯ã€ç›´è¿‘ã®ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã«é–¢ã™ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã‚’æä¾›ã™ã‚‹ãƒ•ãƒƒã‚¯ã§ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> pending<span class="token punctuation">,</span> data<span class="token punctuation">,</span> method<span class="token punctuation">,</span> action <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></intro><inlinetoc><section class="level2"aria-labelledby="ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹-reference"><h2 id="ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹-reference">ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="useformstatus-use-form-status"><h3 id="useformstatus-use-form-status"><code>useFormStatus()</code> {/<em>use-form-status</em>/}</h3><p><code>useFormStatus</code> ãƒ•ãƒƒã‚¯ã¯ã€ç›´è¿‘ã®ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã«é–¢ã™ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã‚’æä¾›ã—ã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useFormStatus <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports">action</span> <span class="token keyword module">from</span> <span class="token string">'./actions'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Submit</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> status <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>button disabled<span class="token operator">=</span><span class="token punctuation">{</span>status<span class="token punctuation">.</span><span class="token property-access">pending</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Submit</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>action<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Submit</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€ã“ã® <code>Submit</code> ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒ <code>&#x3C;form></code> å†…ã§ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ãƒ•ãƒƒã‚¯ã¯ã€ãƒ•ã‚©ãƒ¼ãƒ ãŒé€ä¿¡ä¸­ã‹ã©ã†ã‹ã‚’ç¤ºã™<codestep step="{1}"><code>pending</code></codestep>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãªã©ã®æƒ…å ±ã‚’è¿”ã—ã¾ã™ã€‚<p>ä¸Šè¨˜ã®ä¾‹ã§ã¯ã€<code>Submit</code> ãŒã“ã®æƒ…å ±ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ•ã‚©ãƒ¼ãƒ ãŒé€ä¿¡ä¸­ã®é–“ <code>&#x3C;button></code> ã‚’ç„¡åŠ¹ã«ã—ã¦æŠ¼ã›ãªãã—ã¦ã„ã¾ã™ã€‚<p><a href="#usage">ã•ã‚‰ã«ä¾‹ã‚’è¦‹ã‚‹</a><section class="level4"aria-labelledby="å¼•æ•°-parameters"><h4 id="å¼•æ•°-parameters">å¼•æ•° {/<em>parameters</em>/}</h4><p><code>useFormStatus</code> ã¯å¼•æ•°ã‚’å—ã‘å–ã‚Šã¾ã›ã‚“ã€‚</section><section class="level4"aria-labelledby="è¿”ã‚Šå€¤-returns"><h4 id="è¿”ã‚Šå€¤-returns">è¿”ã‚Šå€¤ {/<em>returns</em>/}</h4><p>ä»¥ä¸‹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤ <code>status</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚<ul><li><p><code>pending</code>: ãƒ–ãƒ¼ãƒªã‚¢ãƒ³ã€‚<code>true</code> ã®å ´åˆã€è¦ª <code>&#x3C;form></code> ã§é€ä¿¡ãŒé€²è¡Œä¸­ã§ã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ãã‚Œä»¥å¤–ã®å ´åˆã¯ <code>false</code> ã¨ãªã‚Šã¾ã™ã€‚<li><p><code>data</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData"><code>FormData</code> ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</a>ã‚’å®Ÿè£…ã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚è¦ª <code>&#x3C;form></code> ãŒé€ä¿¡ä¸­ã®ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚“ã§ã„ã¾ã™ã€‚é€ä¿¡ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ãªã„å ´åˆã‚„è¦ª <code>&#x3C;form></code> ãŒãªã„å ´åˆã¯ <code>null</code> ã«ãªã‚Šã¾ã™ã€‚<li><p><code>method</code>: <code>'get'</code> ã¾ãŸã¯ <code>'post'</code> ã®ã„ãšã‚Œã‹ã®æ–‡å­—åˆ—ã€‚è¦ª <code>&#x3C;form></code> ãŒ <code>GET</code> ã¨ <code>POST</code> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods">HTTP ãƒ¡ã‚½ãƒƒãƒ‰</a>ã®ã©ã¡ã‚‰ã§é€ä¿¡ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’è¡¨ã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€<code>&#x3C;form></code> ã¯ <code>GET</code> ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ãŒã€<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#method"><code>method</code></a> ã«ã‚ˆã£ã¦æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</ul><ul><li><code>action</code>: è¦ª <code>&#x3C;form></code> ã® props ã§ã‚ã‚‹ <code>action</code> ã«æ¸¡ã•ã‚ŒãŸé–¢æ•°ã¸ã®å‚ç…§ã€‚è¦ª <code>&#x3C;form></code> ãŒãªã„å ´åˆã€ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ <code>null</code> ã§ã™ã€‚<code>action</code> ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« URI å€¤ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã‚„ <code>action</code> ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã‚‚ã€<code>status.action</code> ã¯ <code>null</code> ã«ãªã‚Šã¾ã™ã€‚</ul></section><section class="level4"aria-labelledby="æ³¨æ„ç‚¹-caveats"><h4 id="æ³¨æ„ç‚¹-caveats">æ³¨æ„ç‚¹ {/<em>caveats</em>/}</h4><ul><li><code>useFormStatus</code> ãƒ•ãƒƒã‚¯ã¯ã€<code>&#x3C;form></code> å†…ã§ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<li><code>useFormStatus</code> ã¯è¦ª <code>&#x3C;form></code> ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã®ã¿ã‚’è¿”ã—ã¾ã™ã€‚åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚ŒãŸ <code>&#x3C;form></code> ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã¯è¿”ã—ã¾ã›ã‚“ã€‚</ul></section></section></section><section class="level2"aria-labelledby="ä½¿ç”¨æ³•-usage"><h2 id="ä½¿ç”¨æ³•-usage">ä½¿ç”¨æ³• {/<em>usage</em>/}</h2><section class="level3"aria-labelledby="ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ä¸­ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤º-display-a-pending-state-during-form-submission"><h3 id="ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ä¸­ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤º-display-a-pending-state-during-form-submission">ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ä¸­ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤º {/<em>display-a-pending-state-during-form-submission</em>/}</h3><p>ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡ä¸­ã«ãã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€<code>&#x3C;form></code> å†…ã§ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ <code>useFormStatus</code> ãƒ•ãƒƒã‚¯ã‚’å‘¼ã³å‡ºã—ã€è¿”ã•ã‚ŒãŸ <code>pending</code> ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’èª­ã¿å–ã‚Šã¾ã™ã€‚<p>ä»¥ä¸‹ã§ã¯ã€ãƒ•ã‚©ãƒ¼ãƒ ãŒé€ä¿¡ä¸­ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã™ãŸã‚ã« <code>pending</code> ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useFormStatus <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> submitForm <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"./actions.js"</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Submit</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> pending <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>button type<span class="token operator">=</span><span class="token string">"submit"</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>pending<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token punctuation">{</span>pending <span class="token operator">?</span> <span class="token string">"Submitting..."</span> <span class="token operator">:</span> <span class="token string">"Submit"</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> action <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>action<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Submit</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Form</span> action<span class="token operator">=</span><span class="token punctuation">{</span>submitForm<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">submitForm</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"canary"</span><span class="token punctuation">,</span>
    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"canary"</span><span class="token punctuation">,</span>
    <span class="token property">"react-scripts"</span><span class="token operator">:</span> <span class="token string">"^5.0.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"/index.js"</span><span class="token punctuation">,</span>
  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></sandpack><pitfall><section class="level5"aria-labelledby="useformstatus-ã¯åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚ŒãŸ-form-ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã‚’è¿”ã•ãªã„-useformstatus-will-not-return-status-information-for-a-form-rendered-in-the-same-component"><h5 id="useformstatus-ã¯åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚ŒãŸ-form-ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã‚’è¿”ã•ãªã„-useformstatus-will-not-return-status-information-for-a-form-rendered-in-the-same-component"><code>useFormStatus</code> ã¯åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚ŒãŸ <code>&#x3C;form></code> ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã‚’è¿”ã•ãªã„ {/<em>useformstatus-will-not-return-status-information-for-a-form-rendered-in-the-same-component</em>/}</h5><p><code>useFormStatus</code> ãƒ•ãƒƒã‚¯ã¯è¦ªã® <code>&#x3C;form></code> ã«å¯¾ã™ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã®ã¿ã‚’è¿”ã—ã¾ã™ã€‚ãƒ•ãƒƒã‚¯ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹ã®ã¨åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚Œã‚‹ <code>&#x3C;form></code> ã«ã¯å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ğŸš© `pending` will never be true</span>
  <span class="token comment">// useFormStatus does not track the form rendered in this component</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> pending <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submit<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>ã“ã†ã™ã‚‹ã®ã§ã¯ãªãã€<code>useFormStatus</code> ã‚’ <code>&#x3C;form></code> ã®å†…éƒ¨ã«ã‚ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰å‘¼ã³å‡ºã—ã¦ãã ã•ã„ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Submit</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// âœ… `pending` will be derived from the form that wraps the Submit component</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> pending <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>button disabled<span class="token operator">=</span><span class="token punctuation">{</span>pending<span class="token punctuation">}</span><span class="token operator">></span><span class="token spread operator">...</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// This is the &#x3C;form> `useFormStatus` tracks</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submit<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Submit</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section></pitfall></section><section class="level3"aria-labelledby="ãƒ¦ãƒ¼ã‚¶ãŒé€ä¿¡ä¸­ã®ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚‹-read-form-data-being-submitted"><h3 id="ãƒ¦ãƒ¼ã‚¶ãŒé€ä¿¡ä¸­ã®ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚‹-read-form-data-being-submitted">ãƒ¦ãƒ¼ã‚¶ãŒé€ä¿¡ä¸­ã®ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚‹ {/<em>read-form-data-being-submitted</em>/}</h3><p><code>useFormStatus</code> ã‹ã‚‰è¿”ã•ã‚Œã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã® <code>data</code> ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãŒé€ä¿¡ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚<p>ä»¥ä¸‹ã®ä¾‹ã¯ã€ãƒ¦ãƒ¼ã‚¶ãŒè‡ªåˆ†ã®æ¬²ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒãƒ¼ãƒ ã‚’è¦æ±‚ã§ãã‚‹ãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚<code>useFormStatus</code> ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãŒã©ã‚“ãªãƒ¦ãƒ¼ã‚¶ãƒãƒ¼ãƒ ã‚’è¦æ±‚ã—ãŸã®ã‹ç¢ºèªã§ãã‚‹ä¸€æ™‚çš„ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>useState<span class="token punctuation">,</span> useMemo<span class="token punctuation">,</span> useRef<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>useFormStatus<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">UsernameForm</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>pending<span class="token punctuation">,</span> data<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>showSubmitted<span class="token punctuation">,</span> setShowSubmitted<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> submittedUsername <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> timeoutId <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>pending<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      submittedUsername<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> data<span class="token operator">?.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>timeoutId<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">!=</span> <span class="token keyword null nil">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      timeoutId<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        timeoutId<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
        <span class="token function">setShowSubmitted</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setShowSubmitted</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>pending<span class="token punctuation">,</span> data<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span><span class="token maybe-class-name">Request</span> a <span class="token maybe-class-name">Username</span><span class="token operator">:</span> <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span><span class="token operator">&#x3C;</span>br <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"username"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button type<span class="token operator">=</span><span class="token string">"submit"</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>pending<span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token punctuation">{</span>pending <span class="token operator">?</span> <span class="token string">'Submitting...'</span> <span class="token operator">:</span> <span class="token string">'Submit'</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token punctuation">{</span>showSubmitted <span class="token operator">?</span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">Submitted</span> request <span class="token keyword control-flow">for</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token punctuation">{</span>submittedUsername<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">UsernameForm</span></span> <span class="token keyword module">from</span> <span class="token string">'./UsernameForm'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> submitForm <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"./actions.js"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submitForm<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">UsernameForm</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">submitForm</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"canary"</span><span class="token punctuation">,</span>
    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"canary"</span><span class="token punctuation">,</span>
    <span class="token property">"react-scripts"</span><span class="token operator">:</span> <span class="token string">"^5.0.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"/index.js"</span><span class="token punctuation">,</span>
  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></sandpack></section></section><section class="level2"aria-labelledby="ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°-troubleshooting"><h2 id="ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°-troubleshooting">ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° {/<em>troubleshooting</em>/}</h2><section class="level3"aria-labelledby="statuspending-ãŒ-true-ã«ãªã‚‰ãªã„-pending-is-never-true"><h3 id="statuspending-ãŒ-true-ã«ãªã‚‰ãªã„-pending-is-never-true"><code>status.pending</code> ãŒ <code>true</code> ã«ãªã‚‰ãªã„ {/<em>pending-is-never-true</em>/}</h3><p><code>useFormStatus</code> ã¯è¦ªã® <code>&#x3C;form></code> ã«å¯¾ã™ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ã®ã¿ã‚’è¿”ã—ã¾ã™ã€‚<p><code>useFormStatus</code> ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒ <code>&#x3C;form></code> ã®ä¸­ã«ãƒã‚¹ãƒˆã•ã‚Œã¦ã„ãªã„å ´åˆã€<code>status.pending</code> ã¯å¸¸ã« <code>false</code> ã‚’è¿”ã—ã¾ã™ã€‚<code>useFormStatus</code> ãŒ <code>&#x3C;form></code> è¦ç´ ã®å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§å‘¼ã³å‡ºã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚<p><code>useFormStatus</code> ã¯ã€åŒã˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚ŒãŸ <code>&#x3C;form></code> ã®çŠ¶æ…‹ã¯è¿½è·¡ã—ã¾ã›ã‚“ã€‚è©³ç´°ã¯<a href="#useformstatus-will-not-return-status-information-for-a-form-rendered-in-the-same-component">è½ã¨ã—ç©´</a>æ¬„ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚ <span style="float:footnote"><a href="../../../index.html#toc">Go to TOC</a></span></section></section></inlinetoc></section>