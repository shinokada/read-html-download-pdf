<!doctype html><html lang="ja"><meta charset="utf-8"><title>'ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‹ã‚‰ä¾å­˜å€¤ã‚’å–ã‚Šé™¤ã'</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‹ã‚‰ä¾å­˜å€¤ã‚’å–ã‚Šé™¤ã"><h1 id="ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‹ã‚‰ä¾å­˜å€¤ã‚’å–ã‚Šé™¤ã">'ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‹ã‚‰ä¾å­˜å€¤ã‚’å–ã‚Šé™¤ã'</h1><intro><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’è¨˜è¿°ã™ã‚‹éš›ã€ãƒªãƒ³ã‚¿ã¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒèª­ã¿å–ã‚‹ã™ã¹ã¦ã®ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ï¼ˆprops ã‚„ state ãªã©ï¼‰ãŒã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜å€¤ã®ãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æœ€æ–°ã® props ã‚„ state ã¨åŒæœŸã•ã‚ŒãŸçŠ¶æ…‹ã‚’ä¿ã¤ã“ã¨ãŒã§ãã¾ã™ã€‚ä¸è¦ãªä¾å­˜å€¤ãŒã‚ã‚‹ã¨ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒé »ç¹ã«å®Ÿè¡Œã•ã‚ŒéããŸã‚Šã€ç„¡é™ãƒ«ãƒ¼ãƒ—ãŒç™ºç”Ÿã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‹ã‚‰å¿…è¦ã®ãªã„ä¾å­˜å€¤ã‚’è¦‹ã¤ã‘ã€å–ã‚Šé™¤ãæ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚</p></intro><youwilllearn><ul><li>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜å€¤ã«ä¼´ã†ç„¡é™ãƒ«ãƒ¼ãƒ—ã‚’ä¿®æ­£ã™ã‚‹æ–¹æ³•<li>ä¾å­˜å€¤ã‚’å‰Šé™¤ã—ãŸã„å ´åˆã«è¡Œã†ã“ã¨<li>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…ã§ã€Œåå¿œã€ã•ã›ãšã«å€¤ã‚’èª­ã¿å–ã‚‹æ–¹æ³•<li>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã‚„é–¢æ•°å‹ã®ä¾å­˜å€¤ã‚’é¿ã‘ã‚‹ç†ç”±ã¨ãã®æ–¹æ³•<li>ä¾å­˜é…åˆ—ã®ãƒªãƒ³ã‚¿ã‚’æŠ‘åˆ¶ã™ã‚‹å±é™ºæ€§ã¨ã€ä»£ã‚ã‚Šã«è¡Œã†ã¹ãã“ã¨</ul></youwilllearn><section class="level2"aria-labelledby="ä¾å­˜é…åˆ—ã¯ã‚³ãƒ¼ãƒ‰ã«åˆã‚ã›ã‚‹ã¹ã-dependencies-should-match-the-code"><h2 id="ä¾å­˜é…åˆ—ã¯ã‚³ãƒ¼ãƒ‰ã«åˆã‚ã›ã‚‹ã¹ã-dependencies-should-match-the-code">ä¾å­˜é…åˆ—ã¯ã‚³ãƒ¼ãƒ‰ã«åˆã‚ã›ã‚‹ã¹ã {/<em>dependencies-should-match-the-code</em>/}</h2><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’è¨˜è¿°ã™ã‚‹éš›ã¯ã€ãã‚Œã«ä½•ã‚’ã•ã›ãŸã„ã®ã§ã‚ã‚Œã€<a href="/learn/lifecycle-of-reactive-effects#the-lifecycle-of-an-effect">é–‹å§‹æ–¹æ³•ãŠã‚ˆã³åœæ­¢æ–¹æ³•</a>ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">,</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>ã“ã“ã§ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜é…åˆ—ã‚’ç©º (<code>[]</code>) ã«ã—ãŸå ´åˆã€ãƒªãƒ³ã‚¿ã¯æ­£ã—ã„ä¾å­˜é…åˆ—ã‚’ææ¡ˆã—ã¾ã™ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">,</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#x3C;-- Fix the mistake here!</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Welcome</span> to the <span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> room<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> setRoomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'general'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Choose</span> the chat room<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>select
          value<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setRoomId</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"general"</span><span class="token operator">></span>general<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"travel"</span><span class="token operator">></span>travel<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"music"</span><span class="token operator">></span>music<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>select<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span> roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token parameter">serverUrl<span class="token punctuation">,</span> roomId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl <span class="token operator">+</span> <span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><p>ãƒªãƒ³ã‚¿ã®æŒ‡ç¤ºã«å¾“ã£ã¦ã€ä¾å­˜å€¤ã‚’è¨˜å…¥ã—ã¾ã—ã‚‡ã†ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">,</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p><a href="/learn/lifecycle-of-reactive-effects#effects-react-to-reactive-values">ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã«ã€Œåå¿œã€ã—ã¾ã™</a>ã€‚<code>roomId</code> ã¯ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã§ã‚ã‚‹ï¼ˆãªãœãªã‚‰å†ãƒ¬ãƒ³ãƒ€ãƒ¼æ™‚ã«å¤‰æ›´ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼‰ãŸã‚ã€ãƒªãƒ³ã‚¿ã¯ãã‚Œã‚’ä¾å­˜å€¤ã¨ã—ã¦æŒ‡å®šã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚<code>roomId</code> ã¨ã—ã¦ç•°ãªã‚‹å€¤ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆã€React ã¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’å†åŒæœŸã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒãƒ£ãƒƒãƒˆãŒé¸æŠä¸­ã®ãƒ«ãƒ¼ãƒ ã¸ã®æ¥ç¶šã‚’ç¶­æŒã—ã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã«ã€Œåå¿œã€ã™ã‚‹ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">,</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Welcome</span> to the <span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> room<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> setRoomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'general'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Choose</span> the chat room<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>select
          value<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setRoomId</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"general"</span><span class="token operator">></span>general<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"travel"</span><span class="token operator">></span>travel<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"music"</span><span class="token operator">></span>music<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>select<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span> roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token parameter">serverUrl<span class="token punctuation">,</span> roomId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl <span class="token operator">+</span> <span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><section class="level3"aria-labelledby="ä¾å­˜å€¤ã‚’å‰Šé™¤ã—ãŸã‘ã‚Œã°ä¾å­˜å€¤ã§ãªã„ã“ã¨ã‚’ç¤ºã™-to-remove-a-dependency-prove-that-its-not-a-dependency"><h3 id="ä¾å­˜å€¤ã‚’å‰Šé™¤ã—ãŸã‘ã‚Œã°ä¾å­˜å€¤ã§ãªã„ã“ã¨ã‚’ç¤ºã™-to-remove-a-dependency-prove-that-its-not-a-dependency">ä¾å­˜å€¤ã‚’å‰Šé™¤ã—ãŸã‘ã‚Œã°ä¾å­˜å€¤ã§ãªã„ã“ã¨ã‚’ç¤ºã™ {/<em>to-remove-a-dependency-prove-that-its-not-a-dependency</em>/}</h3><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜é…åˆ—ã¯è‡ªåˆ†ã§ã€Œé¸ã¶ã€ãŸãã„ã®ã‚‚ã®ã§ã¯ãªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰ã§ä½¿ç”¨ã•ã‚Œã‚‹ã™ã¹ã¦ã®<codestep step="{2}">ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤</codestep>ã¯ã€ä¾å­˜å€¤ã®ãƒªã‚¹ãƒˆå†…ã§å®£è¨€ã•ã‚Œãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ä¾å­˜é…åˆ—ã¯ã€ãã®å‘¨å›²ã«ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦æ±ºå®šã•ã‚Œã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// This is a reactive value</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">,</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This Effect reads that reactive value</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… So you must specify that reactive value as a dependency of your Effect</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p><a href="/learn/lifecycle-of-reactive-effects#all-variables-declared-in-the-component-body-are-reactive">ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤</a>ã«ã¯ props ã‚„ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã«ç›´æ¥å®£è¨€ã•ã‚ŒãŸã™ã¹ã¦ã®å¤‰æ•°ã‚„é–¢æ•°ãŒå«ã¾ã‚Œã¾ã™ã€‚<code>roomId</code> ã¯ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã§ã‚ã‚‹ãŸã‚ã€ä¾å­˜å€¤ã®ãƒªã‚¹ãƒˆã‹ã‚‰å–ã‚Šé™¤ãã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ãƒªãƒ³ã‚¿ã¯ãã‚Œã‚’è¨±å¯ã—ã¾ã›ã‚“ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">,</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ”´ React Hook useEffect has a missing dependency: 'roomId'</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>ãã—ã¦ã€ãƒªãƒ³ã‚¿ã¯æ­£ã—ã„ã®ã§ã™ï¼ <code>roomId</code> ã¯æ™‚é–“ã¨ã¨ã‚‚ã«å¤‰åŒ–ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã€ã‚³ãƒ¼ãƒ‰ã«ãƒã‚°ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚<p><strong>ä¾å­˜å€¤ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€ãã‚ŒãŒä¾å­˜å€¤ã§ã‚ã‚‹<em>å¿…è¦ãŒãªã„</em>ã“ã¨ã‚’ãƒªãƒ³ã‚¿ã«ã€Œè¨¼æ˜ã€ã—ã¾ã™</strong>ã€‚ä¾‹ãˆã°ã€<code>roomId</code> ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¤–ã«ç§»å‹•ã™ã‚Œã°ã€ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ã¯ãªãå†ãƒ¬ãƒ³ãƒ€ãƒ¼æ™‚ã«å¤‰æ›´ã•ã‚Œãªã„ã€ã¨ã„ã†ã“ã¨ã‚’è¨¼æ˜ã§ãã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> roomId <span class="token operator">=</span> <span class="token string">'music'</span><span class="token punctuation">;</span> <span class="token comment">// Not a reactive value anymore</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">,</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>ã“ã‚Œã§ã‚‚ã† <code>roomId</code> ã¯ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã§ã¯ãªããªã£ãŸï¼ˆå†ãƒ¬ãƒ³ãƒ€ãƒ¼æ™‚ã«å¤‰æ›´ã•ã‚Œãªã„ï¼‰ãŸã‚ã€ä¾å­˜å€¤ã«ã™ã‚‹å¿…è¦ã¯ãªããªã‚Šã¾ã™ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> roomId <span class="token operator">=</span> <span class="token string">'music'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">,</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Welcome</span> to the <span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> room<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token parameter">serverUrl<span class="token punctuation">,</span> roomId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl <span class="token operator">+</span> <span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><p>ã“ã‚Œã§ã€<a href="/learn/lifecycle-of-reactive-effects#what-an-effect-with-empty-dependencies-means">ä¾å­˜é…åˆ—ã‚’ç©º (<code>[]</code>) ã«ã™ã‚‹</a>ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã«ã‚‚ã¯ã‚„<em>ä¾å­˜ã—ã¦ã„ãªã„</em>ã®ã§ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã® props ã‚„ state ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã«å†å®Ÿè¡Œã™ã‚‹å¿…è¦ã¯<em>ç¢ºã‹ã«ãªã„</em>ã®ã§ã™ã€‚</section><section class="level3"aria-labelledby="ä¾å­˜é…åˆ—ã‚’å¤‰æ›´ã—ãŸã‘ã‚Œã°ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹-to-change-the-dependencies-change-the-code"><h3 id="ä¾å­˜é…åˆ—ã‚’å¤‰æ›´ã—ãŸã‘ã‚Œã°ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹-to-change-the-dependencies-change-the-code">ä¾å­˜é…åˆ—ã‚’å¤‰æ›´ã—ãŸã‘ã‚Œã°ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ {/<em>to-change-the-dependencies-change-the-code</em>/}</h3><p>ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹ã“ã¨ã«æ°—ä»˜ã„ãŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚<ol><li>ã¾ãšã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰ã‚„ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã®å®£è¨€éƒ¨åˆ†ã‚’<strong>å¤‰æ›´</strong>ã—ã¦ã¿ã‚‹ã€‚<li>æ¬¡ã«ãƒªãƒ³ã‚¿ã«æŒ‡æ‘˜ã•ã‚ŒãŸã¨ãŠã‚Šã€<strong>å¤‰æ›´ã—ãŸã‚³ãƒ¼ãƒ‰ã«åˆã‚ã›ã‚‹ã‚ˆã†ã«</strong>ä¾å­˜é…åˆ—ã‚’èª¿æ•´ã™ã‚‹ã€‚<li>ãã®ä¾å­˜é…åˆ—ã«æº€è¶³ã§ããªã„å ´åˆã¯ã€<strong>æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã«æˆ»ã‚‹</strong>ï¼ˆã‚³ãƒ¼ãƒ‰ã‚’å†åº¦å¤‰æ›´ã™ã‚‹ï¼‰ã€‚</ol><p>æœ€å¾Œã®éƒ¨åˆ†ãŒé‡è¦ã§ã™ã€‚<strong>ä¾å­˜é…åˆ—ã‚’å¤‰æ›´ã—ãŸã„å ´åˆã¯ã€ã¾ãšå‘¨å›²ã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¦ãã ã•ã„</strong>ã€‚ä¾å­˜é…åˆ—ã¯ã€<a href="/learn/lifecycle-of-reactive-effects#react-verifies-that-you-specified-every-reactive-value-as-a-dependency">ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰ã§ä½¿ç”¨ã•ã‚Œã‚‹ã™ã¹ã¦ã®ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã®ãƒªã‚¹ãƒˆ</a>ã¨è€ƒãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚ãªãŸãŒãƒªã‚¹ãƒˆã«ä½•ã‚’è¼‰ã›ã‚‹ã‹<em>é¸ã¶</em>ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒªã‚¹ãƒˆã¯ã‚ãªãŸã®ã‚³ãƒ¼ãƒ‰ã®<em>èª¬æ˜æ›¸ã</em>ã«éãã¾ã›ã‚“ã€‚ä¾å­˜å€¤ã®ãƒªã‚¹ãƒˆã‚’å¤‰æ›´ã—ãŸããªã£ãŸã‚‰ã€ã‚³ãƒ¼ãƒ‰ã®æ–¹ã‚’å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚<p>ã“ã‚Œã¯æ–¹ç¨‹å¼ã‚’è§£ãã‚ˆã†ãªæ„Ÿè¦šã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ç›®æ¨™ï¼ˆä¾‹ãˆã°ã€ã‚ã‚‹ä¾å­˜å€¤ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ï¼‰ã‹ã‚‰å§‹ã‚ã¦ã€ãã®ç›®æ¨™ã«åˆã£ãŸã‚³ãƒ¼ãƒ‰ã‚’ã€Œè¦‹ã¤ã‘ã‚‹ã€å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ–¹ç¨‹å¼ã‚’è§£ãã“ã¨ãŒæ¥½ã—ã„ã¨æ€ã‚ãªã„äººã‚‚ã„ã‚‹ã§ã—ã‚‡ã†ã—ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’æ›¸ãå ´åˆã§ã‚‚åŒã˜ã§ã—ã‚‡ã†ï¼ å¹¸ã„ã€ä»¥ä¸‹ã«è©¦ã™ã“ã¨ãŒã§ãã‚‹ä¸€èˆ¬çš„ãªãƒ¬ã‚·ãƒ”ã®ãƒªã‚¹ãƒˆãŒã‚ã‚Šã¾ã™ã€‚</p><pitfall><p>æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ãŒã‚ã‚‹å ´åˆã€æ¬¡ã®ã‚ˆã†ã«ãƒªãƒ³ã‚¿ã‚’é»™ã‚‰ã›ã¦ã„ã‚‹ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚<pre class="language-js"><code class="language-js"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// ğŸ”´ Avoid suppressing the linter like this:</span>
  <span class="token comment">// eslint-ignore-next-line react-hooks/exhaustive-deps</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><strong>ä¾å­˜é…åˆ—ãŒã‚³ãƒ¼ãƒ‰ã¨ä¸€è‡´ã—ãªã„å ´åˆã€ãƒã‚°ãŒç™ºç”Ÿã™ã‚‹ãƒªã‚¹ã‚¯ãŒéå¸¸ã«é«˜ããªã‚Šã¾ã™</strong>ã€‚ãƒªãƒ³ã‚¿ã‚’æ­¢ã‚ã‚‹ã“ã¨ã§ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒä¾å­˜ã™ã‚‹å€¤ã«ã¤ã„ã¦ React ã«ã€Œå˜˜ã€ã‚’ã¤ã„ã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚<p>ä»£ã‚ã‚Šã«ã€ä»¥ä¸‹ã«ã‚ã‚‹æ‰‹æ³•ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚</p></pitfall><deepdive><section class="level4"aria-labelledby="ä¾å­˜å€¤ã®ãƒªãƒ³ã‚¿ã‚’æ­¢ã‚ã¦ã—ã¾ã†ã“ã¨ãŒãªãœå±é™ºãªã®ã‹-why-is-suppressing-the-dependency-linter-so-dangerous"><h4 id="ä¾å­˜å€¤ã®ãƒªãƒ³ã‚¿ã‚’æ­¢ã‚ã¦ã—ã¾ã†ã“ã¨ãŒãªãœå±é™ºãªã®ã‹-why-is-suppressing-the-dependency-linter-so-dangerous">ä¾å­˜å€¤ã®ãƒªãƒ³ã‚¿ã‚’æ­¢ã‚ã¦ã—ã¾ã†ã“ã¨ãŒãªãœå±é™ºãªã®ã‹ï¼Ÿ {/<em>why-is-suppressing-the-dependency-linter-so-dangerous</em>/}</h4><p>ã“ã®ãƒªãƒ³ã‚¿ã‚’æ­¢ã‚ã¦ã—ã¾ã†ã¨ã€è¦‹ã¤ã‘ãŸã‚Šä¿®æ­£ã—ãŸã‚Šã™ã‚‹ã®ãŒé›£ã—ã„ã€éå¸¸ã«åˆ†ã‹ã‚Šã¥ã‚‰ã„ãƒã‚°ã®åŸå› ã«ãªã‚Šã¾ã™ã€‚ä¸€ä¾‹ã‚’ç¤ºã—ã¾ã—ã‚‡ã†ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Timer</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>increment<span class="token punctuation">,</span> setIncrement<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">onTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> increment<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>onTick<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">clearInterval</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// eslint-disable-next-line react-hooks/exhaustive-deps</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h1<span class="token operator">></span>
        <span class="token literal-property property">Counter</span><span class="token operator">:</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Reset</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span>
        <span class="token maybe-class-name">Every</span> second<span class="token punctuation">,</span> increment by<span class="token operator">:</span>
        <span class="token operator">&#x3C;</span>button disabled<span class="token operator">=</span><span class="token punctuation">{</span>increment <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token function">setIncrement</span><span class="token punctuation">(</span><span class="token parameter">i</span> <span class="token arrow operator">=></span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>â€“<span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>b<span class="token operator">></span><span class="token punctuation">{</span>increment<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>b<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token function">setIncrement</span><span class="token punctuation">(</span><span class="token parameter">i</span> <span class="token arrow operator">=></span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">+</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><p>ãŸã¨ãˆã°ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ã€Œãƒã‚¦ãƒ³ãƒˆæ™‚ã«ã®ã¿ã€å®Ÿè¡Œã—ãŸã„ã¨ã—ã¾ã™ã€‚ã‚ãªãŸã¯<a href="/learn/lifecycle-of-reactive-effects#what-an-effect-with-empty-dependencies-means">ç©ºã® (<code>[]</code>) ä¾å­˜é…åˆ—</a>ã‚’ä½¿ãˆã°ã‚ˆã„ã¨ã©ã“ã‹ã§èª­ã‚“ã ã®ã§ã€ãƒªãƒ³ã‚¿ã‚’ç„¡è¦–ã—ã¦å¼·åˆ¶çš„ã« <code>[]</code> ã‚’ä¾å­˜é…åˆ—ã¨ã—ã¦æŒ‡å®šã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚<p>ã“ã®ã‚«ã‚¦ãƒ³ã‚¿ã¯æ¯ç§’ã€2 ã¤ã®ãƒœã‚¿ãƒ³ã«ã‚ˆã‚ŠæŒ‡å®šã•ã‚Œã‚‹æ•°ã ã‘ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã™ã‚‹ã¯ãšã§ã™ã€‚ã—ã‹ã—ã€ã“ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ä½•ã«ã‚‚ä¾å­˜ã—ã¦ã„ãªã„ã¨ React ã«ã€Œå˜˜ã€ã‚’ã¤ã„ãŸãŸã‚ã€React ã¯åˆæœŸãƒ¬ãƒ³ãƒ€ãƒ¼æ™‚ã® <code>onTick</code> é–¢æ•°ã‚’æ°¸é ã«ä½¿ç”¨ã—ç¶šã‘ã¾ã™ã€‚<a href="/learn/state-as-a-snapshot#rendering-takes-a-snapshot-in-time">ãã®ãƒ¬ãƒ³ãƒ€ãƒ¼ä¸­</a>ã«ã¯ <code>count</code> ã¯ <code>0</code> ã§ã€<code>increment</code> ã¯ <code>1</code> ã§ã—ãŸã€‚å¾“ã£ã¦ã€ãã®ãƒ¬ãƒ³ãƒ€ãƒ¼æ™‚ã«ä½œã‚‰ã‚ŒãŸ <code>onTick</code> ã¯æ¯ç§’ <code>setCount(0 + 1)</code> ã‚’å‘¼ã³å‡ºã—ã€å¸¸ã« <code>1</code> ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã“ã®ã‚ˆã†ãªãƒã‚°ã¯ã€è¤‡æ•°ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã¾ãŸãŒã£ã¦ã„ã‚‹å ´åˆã€ä¿®æ­£ãŒã‚ˆã‚Šå›°é›£ã«ãªã‚Šã¾ã™ã€‚<p>ãƒªãƒ³ã‚¿ã‚’ç„¡è¦–ã™ã‚‹ã‚ˆã‚Šã‚‚è‰¯ã„è§£æ±ºç­–ã¯å¸¸ã«å­˜åœ¨ã—ã¾ã™ï¼ ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã™ã‚‹ã«ã¯ã€<code>onTick</code> ã‚’ä¾å­˜å€¤ã®ãƒªã‚¹ãƒˆã«è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ãŒä¸€åº¦ã ã‘è¨­å®šã•ã‚Œã‚‹ã‚ˆã†ã«ã€<a href="/learn/separating-events-from-effects#reading-latest-props-and-state-with-effect-events"><code>onTick</code> ã‚’ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆ (Effect Event) ã«ã—ã¾ã™ã€‚</a>ï¼‰<p><strong>ä¾å­˜é…åˆ—ã«é–¢ã™ã‚‹ãƒªãƒ³ãƒˆã‚¨ãƒ©ãƒ¼ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦æ‰±ã†ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚ãƒªãƒ³ã‚¿ã‚’æŠ‘åˆ¶ã—ãªã‘ã‚Œã°ã€ã“ã®ã‚ˆã†ãªãƒã‚°ã«ã¯æ±ºã—ã¦é­é‡ã›ãšã«æ¸ˆã¿ã¾ã™</strong>ã€‚ã“ã®ãƒšãƒ¼ã‚¸ã®æ®‹ã‚Šã®éƒ¨åˆ†ã§ã€ã“ã®ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã‚„ä»–ã®ã‚±ãƒ¼ã‚¹ã§ä»£ã‚ã‚Šã«è¡Œãˆã‚‹å¯¾å¿œç­–ã‚’èª¬æ˜ã—ã¾ã™ã€‚</section></deepdive></section></section><section class="level2"aria-labelledby="ä¸è¦ãªä¾å­˜å€¤ã‚’å–ã‚Šé™¤ã-removing-unnecessary-dependencies"><h2 id="ä¸è¦ãªä¾å­˜å€¤ã‚’å–ã‚Šé™¤ã-removing-unnecessary-dependencies">ä¸è¦ãªä¾å­˜å€¤ã‚’å–ã‚Šé™¤ã {/<em>removing-unnecessary-dependencies</em>/}</h2><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜é…åˆ—ã‚’ã‚³ãƒ¼ãƒ‰ã«åˆã‚ã›ã¦èª¿æ•´ã™ã‚‹ãŸã³ã«ã€ãã®ãƒªã‚¹ãƒˆã®ä¸­èº«ã‚’è¦‹ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚ä¾å­˜å€¤ã®ã©ã‚Œã‹ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’å†å®Ÿè¡Œã™ã‚‹ã“ã¨ã¯ã€ç†ã«ã‹ãªã£ã¦ã„ã¾ã™ã‹ï¼Ÿ æ™‚ã€…ã€ç­”ãˆã¯ã€Œã„ã„ãˆã€ã§ã—ã‚‡ã†ã€‚<ul><li>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®<em>ç•°ãªã‚‹éƒ¨åˆ†</em>ã‚’ç•°ãªã‚‹æ¡ä»¶ã§å†å®Ÿè¡Œã—ãŸã„ã€‚<li>ä¾å­˜å€¤ã®<em>æœ€æ–°ã®å€¤</em>ã‚’èª­ã¿å–ã‚ŠãŸã„ã ã‘ã§ã€ãã®å¤‰åŒ–ã«ã€Œåå¿œã€ã—ãŸã„ã‚ã‘ã§ã¯ãªã„ã€‚<li>ä¾å­˜å€¤ã®å‹ãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã§ã‚ã‚‹ãŸã‚ã«ã€<em>æ„å›³ã›ãšã«</em>é »ç¹ã«å¤‰æ›´ã•ã‚Œã‚‹ã€‚</ul><p>é©åˆ‡ãªè§£æ±ºç­–ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ã¯ã€ã‚ãªãŸã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã«é–¢ã™ã‚‹ã„ãã¤ã‹ã®è³ªå•ã«ç­”ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã‚Œã‚‰ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚<section class="level3"aria-labelledby="ã‚³ãƒ¼ãƒ‰ã‚’ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã«ç§»å‹•ã™ã¹ãã§ã¯-should-this-code-move-to-an-event-handler"><h3 id="ã‚³ãƒ¼ãƒ‰ã‚’ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã«ç§»å‹•ã™ã¹ãã§ã¯-should-this-code-move-to-an-event-handler">ã‚³ãƒ¼ãƒ‰ã‚’ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã«ç§»å‹•ã™ã¹ãã§ã¯ï¼Ÿ {/<em>should-this-code-move-to-an-event-handler</em>/}</h3><p>ã¾ãšè€ƒãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã¯ã€ãã®ã‚³ãƒ¼ãƒ‰ãŒãã‚‚ãã‚‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã¹ãã‹ã©ã†ã‹ã§ã™ã€‚<p>ãƒ•ã‚©ãƒ¼ãƒ ã‚’æƒ³åƒã—ã¦ãã ã•ã„ã€‚é€ä¿¡æ™‚ã«ã€<code>submitted</code> ã¨ã„ã† state å¤‰æ•°ã‚’ <code>true</code> ã«è¨­å®šã—ã¾ã™ã€‚POST ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦ã‹ã‚‰é€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<code>submitted</code> ãŒ <code>true</code> ã«ãªã‚‹ã“ã¨ã«ã€Œåå¿œã€ã™ã‚‹ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¸­ã«ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ­ã‚¸ãƒƒã‚¯ã‚’å…¥ã‚Œã¾ã—ãŸã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>submitted<span class="token punctuation">,</span> setSubmitted<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>submitted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/register'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token string">'Successfully registered!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>submitted<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleSubmit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setSubmitted</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>å¾Œã§ã€ç¾åœ¨ã®ãƒ†ãƒ¼ãƒã«å¿œã˜ã¦é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨ã™ã‚‹ãŸã‚ã«ã€ç¾åœ¨ã®ãƒ†ãƒ¼ãƒã‚’èª­ã¿å–ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚<code>theme</code> ã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæœ¬ä½“ã§å®£è¨€ã•ã‚Œã¦ã„ã‚‹ãŸã‚ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã§ã‚ã‚Šã€ä¾å­˜å€¤ã¨ã—ã¦è¿½åŠ ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>submitted<span class="token punctuation">,</span> setSubmitted<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> theme <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span><span class="token maybe-class-name">ThemeContext</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>submitted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/register'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token string">'Successfully registered!'</span><span class="token punctuation">,</span> theme<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>submitted<span class="token punctuation">,</span> theme<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>

  <span class="token keyword">function</span> <span class="token function">handleSubmit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setSubmitted</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>  

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>ã—ã‹ã—ã“ã‚Œã«ã‚ˆã‚Šãƒã‚°ã‚’ç™ºç”Ÿã•ã›ã¦ã—ã¾ã„ã¾ã—ãŸã€‚ã¾ãšãƒ•ã‚©ãƒ¼ãƒ ã‚’é€ä¿¡ã—ã¦ã‹ã‚‰ã€ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒã¨ãƒ©ã‚¤ãƒˆãƒ†ãƒ¼ãƒã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã¨ã“ã‚ã‚’æƒ³åƒã—ã¦ãã ã•ã„ã€‚<code>theme</code> ãŒå¤‰æ›´ã•ã‚Œã‚‹ã“ã¨ã«ã‚ˆã‚Šã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒå†å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€åŒã˜é€šçŸ¥ãŒå†åº¦è¡¨ç¤ºã•ã‚Œã¾ã™ï¼<p><strong>ã“ã“ã§ã®å•é¡Œã¯ã€ãã‚‚ãã‚‚ã“ã‚ŒãŒã‚¨ãƒ•ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã¹ãã§ã¯ãªã‹ã£ãŸã¨ã„ã†ã“ã¨ã§ã™</strong>ã€‚ã“ã® POST ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦é€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã¯ã€<em>ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡</em>ã¨ã„ã†ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶æ“ä½œã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶æ“ä½œã«å¯¾å¿œã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã¯ã€ãã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å¯¾å¿œã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã«ç›´æ¥é…ç½®ã—ã¦ãã ã•ã„ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> theme <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span><span class="token maybe-class-name">ThemeContext</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleSubmit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// âœ… Good: Event-specific logic is called from event handlers</span>
    <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/register'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token string">'Successfully registered!'</span><span class="token punctuation">,</span> theme<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>  

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>ã‚³ãƒ¼ãƒ‰ãŒã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã«ã‚ã‚‹ãŸã‚ã€ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ã¯ãªããªã‚Šã¾ã™ã€‚ã¤ã¾ã‚Šã€ãƒ¦ãƒ¼ã‚¶ãŒãƒ•ã‚©ãƒ¼ãƒ ã‚’é€ä¿¡ã—ãŸã¨ãã«ã®ã¿å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚è©³ã—ãã¯ã€<a href="/learn/separating-events-from-effects#reactive-values-and-reactive-logic">ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã¨ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®é¸æŠ</a>ã‚„<a href="/learn/you-might-not-need-an-effect">ä¸è¦ãªã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å‰Šé™¤</a>ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</section><section class="level3"aria-labelledby="ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒè¤‡æ•°ã®äº’ã„ã«ç„¡é–¢ä¿‚ãªã“ã¨ã‚’è¡Œã£ã¦ã„ãªã„ã‹-is-your-effect-doing-several-unrelated-things"><h3 id="ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒè¤‡æ•°ã®äº’ã„ã«ç„¡é–¢ä¿‚ãªã“ã¨ã‚’è¡Œã£ã¦ã„ãªã„ã‹-is-your-effect-doing-several-unrelated-things">ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒè¤‡æ•°ã®äº’ã„ã«ç„¡é–¢ä¿‚ãªã“ã¨ã‚’è¡Œã£ã¦ã„ãªã„ã‹ï¼Ÿ {/<em>is-your-effect-doing-several-unrelated-things</em>/}</h3><p>æ¬¡ã«è‡ªåˆ†ã«å•ã†ã¹ãè³ªå•ã¯ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒè¤‡æ•°ã®é–¢é€£æ€§ã®ãªã„ã“ã¨ã‚’è¡Œã£ã¦ã„ãªã„ã‹ã©ã†ã‹ã§ã™ã€‚<p>ä¾‹ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ã«éƒ½å¸‚ã¨ã‚¨ãƒªã‚¢ã‚’é¸æŠã•ã›ã‚‹é…é€ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¦ã„ã‚‹ã¨ã—ã¾ã™ã€‚é¸æŠã•ã‚ŒãŸ <code>country</code> ã«å¿œã˜ã¦ã‚µãƒ¼ãƒã‹ã‚‰ <code>cities</code> ã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã§è¡¨ç¤ºã—ã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ShippingForm</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> country <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>cities<span class="token punctuation">,</span> setCities<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>city<span class="token punctuation">,</span> setCity<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ignore <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/cities?country=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>country<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token arrow operator">=></span> response<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">json</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ignore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">setCities</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      ignore <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>country<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>

  <span class="token comment">// ...</span></code></pre><p>ã“ã‚Œã¯ã€<a href="/learn/you-might-not-need-an-effect#fetching-data">ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹</a>è‰¯ã„ä¾‹ã§ã™ã€‚<code>country</code> ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å¿œã˜ã¦ã€<code>cities</code> ã¨ã„ã† state ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨åŒæœŸã•ã›ã¦ã„ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿å–å¾—ã¯ <code>ShippingForm</code> ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¨ã™ãã«ã€ã‹ã¤ï¼ˆã©ã‚“ãªãƒ¦ãƒ¼ã‚¶æ“ä½œãŒåŸå› ã§ã‚ã‚Œï¼‰<code>country</code> ãŒå¤‰æ›´ã•ã‚Œã‚‹ãŸã³ã«è¡Œã†å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§è¡Œã†ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚<p>ã•ã¦ã€ç¾åœ¨é¸æŠã•ã‚Œã¦ã„ã‚‹ <code>city</code> ã«å¯¾å¿œã™ã‚‹ <code>areas</code> ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ã€2 ã¤ç›®ã®ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã‚’è¿½åŠ ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã¨ã—ã¾ã—ã‚‡ã†ã€‚åŒã˜ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¸­ã«ã€ã‚¨ãƒªã‚¢ã®ä¸€è¦§ã‚’å–å¾—ã™ã‚‹ãŸã‚ã® 2 ã¤ç›®ã® <code>fetch</code> ã‚³ãƒ¼ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã¨ã“ã‚ã‹ã‚‰å–ã‚Šã‹ã‹ã£ã¦ã—ã¾ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ShippingForm</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> country <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>cities<span class="token punctuation">,</span> setCities<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>city<span class="token punctuation">,</span> setCity<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>areas<span class="token punctuation">,</span> setAreas<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ignore <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/cities?country=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>country<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token arrow operator">=></span> response<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">json</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ignore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">setCities</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>city<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/areas?city=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>city<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token arrow operator">=></span> response<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">json</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ignore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setAreas</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      ignore <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>country<span class="token punctuation">,</span> city<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>

  <span class="token comment">// ...</span></code></pre><p>ã—ã‹ã—ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒ <code>city</code> ã¨ã„ã† state å¤‰æ•°ã‚‚ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«ãªã£ãŸãŸã‚ã€ä¾å­˜å€¤ã®ãƒªã‚¹ãƒˆã« <code>city</code> ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚ãã‚ŒãŒå•é¡Œã‚’å¼•ãèµ·ã“ã—ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãŒåˆ¥ã®éƒ½å¸‚ã‚’é¸æŠã™ã‚‹ã¨ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒå†å®Ÿè¡Œã•ã‚Œã€<code>fetchCities(country)</code> ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚ãã®çµæœã€éƒ½å¸‚ã®ãƒªã‚¹ãƒˆã‚’ä½•åº¦ã‚‚ä¸å¿…è¦ã«å–å¾—ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚<p><strong>ã“ã®ã‚³ãƒ¼ãƒ‰ã®å•é¡Œã¯ã€2 ã¤ã®äº’ã„ã«é–¢é€£æ€§ã®ãªã„ã“ã¨ã«é–¢ã—ã¦åŒæœŸã‚’è¡Œã£ã¦ã„ã‚‹ã“ã¨ã§ã™</strong>ã€‚<ol><li>props ã§ã‚ã‚‹ <code>country</code> ã«åŸºã¥ã„ã¦ã€<code>cities</code> state ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨åŒæœŸã•ã›ãŸã„ã€‚<li>state ã§ã‚ã‚‹ <code>city</code> ã«åŸºã¥ã„ã¦ã€<code>areas</code> state ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨åŒæœŸã•ã›ãŸã„ã€‚</ol><p>ãƒ­ã‚¸ãƒƒã‚¯ã‚’ 2 ã¤ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã«åˆ†å‰²ã—ã¦ã€ãã‚Œãã‚ŒãŒåŒæœŸã™ã‚‹å¿…è¦ãŒã‚ã‚‹å€¤ã«ã®ã¿åå¿œã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ShippingForm</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> country <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>cities<span class="token punctuation">,</span> setCities<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ignore <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/cities?country=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>country<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token arrow operator">=></span> response<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">json</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ignore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">setCities</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      ignore <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>country<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>city<span class="token punctuation">,</span> setCity<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>areas<span class="token punctuation">,</span> setAreas<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>city<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> ignore <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/areas?city=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>city<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token arrow operator">=></span> response<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">json</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ignore<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setAreas</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        ignore <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>city<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>

  <span class="token comment">// ...</span></code></pre><p>ã“ã‚Œã§ã€1 ç•ªç›®ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ <code>country</code> ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã«ã®ã¿å†å®Ÿè¡Œã•ã‚Œã€2 ç•ªç›®ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ <code>city</code> ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã«ã®ã¿å†å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ç›®çš„åˆ¥ã«åˆ†ã‘ãŸã“ã¨ã§ã€2 ã¤ã®ç•°ãªã‚‹ã‚‚ã®ãŒã€2 ã¤ã®åˆ¥ã€…ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã«ã‚ˆã£ã¦åŒæœŸã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚2 ã¤ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒ 2 ã¤ã®åˆ¥ã®ä¾å­˜é…åˆ—ã‚’æœ‰ã—ã¦ã„ã‚‹ã®ã§ã€äº’ã„ã‚’æ„å›³ã›ãšã«ãƒˆãƒªã‚¬ã—ã¦ã—ã¾ã†ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<p>æœ€çµ‚çš„ãªã‚³ãƒ¼ãƒ‰ã¯å…ƒã®ã‚³ãƒ¼ãƒ‰ã‚ˆã‚Šã‚‚é•·ããªã‚Šã¾ã™ãŒã€ã“ã‚Œã‚‰ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’åˆ†å‰²ã™ã‚‹ã“ã¨ã¯æ­£å½“ã§ã™ã€‚<a href="/learn/lifecycle-of-reactive-effects#each-effect-represents-a-separate-synchronization-process">å„ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ç‹¬ç«‹ã—ãŸåŒæœŸãƒ—ãƒ­ã‚»ã‚¹ã‚’è¡¨ã™ã¹ãã§ã™</a>ã€‚ã“ã®ä¾‹ã§ã¯ã€ä¸€æ–¹ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’å‰Šé™¤ã—ã¦ã‚‚ã€ã‚‚ã†ä¸€æ–¹ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ãƒ­ã‚¸ãƒƒã‚¯ãŒå£Šã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã¤ã¾ã‚Šãã‚Œã‚‰ã¯<em>ç•°ãªã‚‹ã‚‚ã®ã‚’åŒæœŸã—ã¦ã„ã‚‹</em>ã¨ã„ã†ã“ã¨ã§ã‚ã‚Šã€åˆ†å‰²ã™ã‚‹ã“ã¨ã¯è‰¯ã„ã“ã¨ã§ã™ã€‚ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ãŒæ°—ã«ãªã‚‹å ´åˆã¯ã€<a href="/learn/reusing-logic-with-custom-hooks#when-to-use-custom-hooks">ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã«ç¹°ã‚Šè¿”ã—ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŠ½å‡º</a>ã™ã‚‹ã“ã¨ã§æ”¹å–„ã§ãã¾ã™ã€‚</section><section class="level3"aria-labelledby="state-ã®èª­ã¿å–ã‚Šã¯æ¬¡ã®-state-ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã‹-are-you-reading-some-state-to-calculate-the-next-state"><h3 id="state-ã®èª­ã¿å–ã‚Šã¯æ¬¡ã®-state-ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã‹-are-you-reading-some-state-to-calculate-the-next-state">state ã®èª­ã¿å–ã‚Šã¯æ¬¡ã® state ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã‹ï¼Ÿ {/<em>are-you-reading-some-state-to-calculate-the-next-state</em>/}</h3><p>ä»¥ä¸‹ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ã€æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±ŠããŸã³ã«ã€æ–°ã—ã„é…åˆ—ã‚’ä½œã£ã¦ <code>messages</code> ã¨ã„ã† state ã«ã‚»ãƒƒãƒˆã—ã¦ã„ã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>messages<span class="token punctuation">,</span> setMessages<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">receivedMessage</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setMessages</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token spread operator">...</span>messages<span class="token punctuation">,</span> receivedMessage<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span></code></pre><p>æ—¢å­˜ã®ã™ã¹ã¦ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰å§‹ã¾ã‚‹<a href="/learn/updating-arrays-in-state">æ–°ãŸãªé…åˆ—ã‚’ä½œæˆã™ã‚‹</a>éƒ¨åˆ†ã§ <code>messages</code> å¤‰æ•°ã‚’ä½¿ã£ã¦ãŠã‚Šã€æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æœ€å¾Œã«è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€<code>messages</code> ã¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã«ã‚ˆã£ã¦èª­ã¿å–ã‚‰ã‚Œã‚‹ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã§ã‚ã‚‹ãŸã‚ã€ä¾å­˜å€¤ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>messages<span class="token punctuation">,</span> setMessages<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">receivedMessage</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setMessages</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token spread operator">...</span>messages<span class="token punctuation">,</span> receivedMessage<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> messages<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>ãã—ã¦ <code>messages</code> ã‚’ä¾å­˜å€¤ã«ã™ã‚‹ã“ã¨ã§å•é¡ŒãŒç™ºç”Ÿã—ã¦ã—ã¾ã„ã¾ã™ã€‚<p>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã™ã‚‹ãŸã³ã«ã€<code>setMessages()</code> ã¯å—ä¿¡ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å«ã‚€æ–°ã—ã„ <code>messages</code> é…åˆ—ã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å†ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã›ã¾ã™ã€‚ã—ã‹ã—ã“ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ <code>messages</code> ã«ä¾å­˜ã™ã‚‹ã‚ˆã†ã«ãªã£ãŸãŸã‚ã€ã“ã‚Œã«ã‚ˆã£ã¦ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å†åŒæœŸã‚‚ç™ºç”Ÿã—ã¾ã™ã€‚ãã®ãŸã‚æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±ŠããŸã³ã«ãƒãƒ£ãƒƒãƒˆãŒå†æ¥ç¶šã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ãƒ¦ãƒ¼ã‚¶ã«ã¨ã£ã¦æœ›ã¾ã—ãã‚ã‚Šã¾ã›ã‚“ï¼<p>å•é¡Œã‚’è§£æ±ºã™ã‚‹ã«ã¯ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…ã§ <code>messages</code> ã‚’èª­ã¿å–ã‚‰ãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚ä»£ã‚ã‚Šã«ã€<code>setMessages</code> ã«<a href="/reference/react/useState#updating-state-based-on-the-previous-state">æ›´æ–°ç”¨é–¢æ•°</a>ã‚’æ¸¡ã—ã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>messages<span class="token punctuation">,</span> setMessages<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">receivedMessage</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setMessages</span><span class="token punctuation">(</span><span class="token parameter">msgs</span> <span class="token arrow operator">=></span> <span class="token punctuation">[</span><span class="token spread operator">...</span>msgs<span class="token punctuation">,</span> receivedMessage<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p><strong>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒ <code>messages</code> å¤‰æ•°ã‚’ä¸€åˆ‡èª­ã¿å–ã‚‰ãªããªã£ã¦ã„ã‚‹ã“ã¨ã«æ³¨ç›®ã—ã¦ãã ã•ã„</strong>ã€‚<code>msgs => [...msgs, receivedMessage]</code> ã®ã‚ˆã†ãªæ›´æ–°ç”¨é–¢æ•°ã‚’æ¸¡ã™ã ã‘ã§æ§‹ã„ã¾ã›ã‚“ã€‚React ã¯<a href="/learn/queueing-a-series-of-state-updates">æ›´æ–°ç”¨é–¢æ•°ã‚’ã‚­ãƒ¥ãƒ¼ã«å…¥ã‚Œ</a>ã€æ¬¡ã®ãƒ¬ãƒ³ãƒ€ãƒ¼æ™‚ã« <code>msgs</code> å¼•æ•°ã«å€¤ã‚’æ¸¡ã—ã¾ã™ã€‚ã§ã™ã®ã§ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè‡ªä½“ã¯ã‚‚ã† <code>messages</code> ã«ä¾å­˜ã™ã‚‹å¿…è¦ãŒãªããªã£ã¦ã„ã¾ã™ã€‚ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šã€ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã—ã¦ã‚‚ãƒãƒ£ãƒƒãƒˆãŒå†æ¥ç¶šã•ã‚Œã‚‹ã“ã¨ã¯ãªããªã‚Šã¾ã™ã€‚</section><section class="level3"aria-labelledby="å¤‰æ›´ã«åå¿œã›ãšå€¤ã‚’èª­ã¿å‡ºã—ãŸã„ã ã‘ã‹-do-you-want-to-read-a-value-without-reacting-to-its-changes"><h3 id="å¤‰æ›´ã«åå¿œã›ãšå€¤ã‚’èª­ã¿å‡ºã—ãŸã„ã ã‘ã‹-do-you-want-to-read-a-value-without-reacting-to-its-changes">å¤‰æ›´ã«ã€Œåå¿œã€ã›ãšå€¤ã‚’èª­ã¿å‡ºã—ãŸã„ã ã‘ã‹ï¼Ÿ {/<em>do-you-want-to-read-a-value-without-reacting-to-its-changes</em>/}</h3><wip><p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ã¾ã å®‰å®šç‰ˆã® React ã§ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ãªã„<strong>å®Ÿé¨“çš„ãª API</strong> ã‚’èª¬æ˜ã—ã¦ã„ã¾ã™ã€‚</p></wip><p><code>isMuted</code> ãŒ <code>true</code> ã§ãªã„å ´åˆã«é™ã‚Šã€ãƒ¦ãƒ¼ã‚¶ãŒæ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã—ãŸã¨ãã«éŸ³ã‚’å†ç”Ÿã—ãŸã„ã¨ã—ã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>messages<span class="token punctuation">,</span> setMessages<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isMuted<span class="token punctuation">,</span> setIsMuted<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">receivedMessage</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setMessages</span><span class="token punctuation">(</span><span class="token parameter">msgs</span> <span class="token arrow operator">=></span> <span class="token punctuation">[</span><span class="token spread operator">...</span>msgs<span class="token punctuation">,</span> receivedMessage<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMuted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">playSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span></code></pre><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒ <code>isMuted</code> ã‚’ã‚³ãƒ¼ãƒ‰å†…ã§ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã€ä¾å­˜é…åˆ—ã«è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>messages<span class="token punctuation">,</span> setMessages<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isMuted<span class="token punctuation">,</span> setIsMuted<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">receivedMessage</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setMessages</span><span class="token punctuation">(</span><span class="token parameter">msgs</span> <span class="token arrow operator">=></span> <span class="token punctuation">[</span><span class="token spread operator">...</span>msgs<span class="token punctuation">,</span> receivedMessage<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMuted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">playSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> isMuted<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>å•é¡Œã¯ã€ï¼ˆãƒ¦ãƒ¼ã‚¶ãŒ "Muted" ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ãªã©ã§ï¼‰<code>isMuted</code> ãŒå¤‰æ›´ã•ã‚Œã‚‹ãŸã³ã«ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒå†åŒæœŸã•ã‚Œã€ãƒãƒ£ãƒƒãƒˆã«å†æ¥ç¶šã•ã‚Œã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã¯æœ›ã¾ã—ã„ãƒ¦ãƒ¼ã‚¶ä½“é¨“ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼ï¼ˆã“ã®ä¾‹ã§ã¯ã€å˜ã«ãƒªãƒ³ã‚¿ã‚’ç„¡åŠ¹ã«ã—ã¦ã‚‚ã†ã¾ãã„ãã¾ã›ã‚“ã€‚ãã†ã™ã‚‹ã¨ <code>isMuted</code> ãŒå¤ã„å€¤ã®ã¾ã¾ã€Œå›ºå®šã€ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚ï¼‰<p>ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã¯ã€ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ã¯ãªã„ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å¤–éƒ¨ã«å–ã‚Šå‡ºã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<code>isMuted</code> ã®å¤‰æ›´ã«å¯¾ã—ã¦ã“ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ã€Œåå¿œã€ã•ã›ãŸãã‚ã‚Šã¾ã›ã‚“ã€‚ãã“ã§<a href="/learn/separating-events-from-effects#declaring-an-effect-event">ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ã¯ãªã„ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã«ç§»å‹•ã—ã¾ã™</a>ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useEffectEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>messages<span class="token punctuation">,</span> setMessages<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isMuted<span class="token punctuation">,</span> setIsMuted<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> onMessage <span class="token operator">=</span> <span class="token function">useEffectEvent</span><span class="token punctuation">(</span><span class="token parameter">receivedMessage</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setMessages</span><span class="token punctuation">(</span><span class="token parameter">msgs</span> <span class="token arrow operator">=></span> <span class="token punctuation">[</span><span class="token spread operator">...</span>msgs<span class="token punctuation">,</span> receivedMessage<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isMuted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">playSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">receivedMessage</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">onMessage</span><span class="token punctuation">(</span>receivedMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã‚’ä½¿ã†ã“ã¨ã§ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªéƒ¨åˆ†ï¼ˆ<code>roomId</code> ã®ã‚ˆã†ãªãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã¨ãã®å¤‰æ›´ã«ã€Œåå¿œã€ã™ã‚‹éƒ¨åˆ†ï¼‰ã¨ã€ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ã¯ãªã„éƒ¨åˆ†ï¼ˆ<code>onMessage</code> ãŒ <code>isMuted</code> ã‚’èª­ã‚€ã‚ˆã†ãªã€æœ€æ–°ã®å€¤ã ã‘ã‚’èª­ã¿ã¨ã‚‹éƒ¨åˆ†ï¼‰ã«åˆ†å‰²ã§ãã¾ã™ã€‚<strong><code>isMuted</code> ã¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆå†…ã§èª­ã¿ã¨ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜å€¤ã§ã‚ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã™</strong>ã€‚ãã®çµæœã€ã€ŒãƒŸãƒ¥ãƒ¼ãƒˆã€è¨­å®šã‚’ã‚ªãƒ³ãƒ»ã‚ªãƒ•ã—ã¦ã‚‚ãƒãƒ£ãƒƒãƒˆãŒå†æ¥ç¶šã•ã‚Œãªããªã‚Šã€ä¸€ä»¶è½ç€ã¨ãªã‚Šã¾ã™ï¼<section class="level4"aria-labelledby="props-ã‹ã‚‰æ¥ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’ãƒ©ãƒƒãƒ—-wrapping-an-event-handler-from-the-props"><h4 id="props-ã‹ã‚‰æ¥ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’ãƒ©ãƒƒãƒ—-wrapping-an-event-handler-from-the-props">props ã‹ã‚‰æ¥ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’ãƒ©ãƒƒãƒ— {/<em>wrapping-an-event-handler-from-the-props</em>/}</h4><p>ä¼¼ãŸå•é¡Œã¯ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’ props ã¨ã—ã¦å—ã‘å–ã‚‹å ´åˆã«ã‚‚ç™ºç”Ÿã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> onReceiveMessage <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>messages<span class="token punctuation">,</span> setMessages<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">receivedMessage</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">onReceiveMessage</span><span class="token punctuation">(</span>receivedMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> onReceiveMessage<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>ã“ã“ã§è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒæ¯å›ã®ãƒ¬ãƒ³ãƒ€ãƒ¼ã§<em>ç•°ãªã‚‹</em> <code>onReceiveMessage</code> é–¢æ•°ã‚’æ¸¡ã—ã¦ãã‚‹å ´åˆã‚’è€ƒãˆã¾ã—ã‚‡ã†ã€‚<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span>
  roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
  onReceiveMessage<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">receivedMessage</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">/</span><span class="token operator">></span></code></pre><p><code>onReceiveMessage</code> ã¯ä¾å­˜å€¤ãªã®ã§ã€è¦ªã®å†ãƒ¬ãƒ³ãƒ€ãƒ¼å¾Œã«æ¯å›ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒå†åŒæœŸã•ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šæ¯å›ãƒãƒ£ãƒƒãƒˆãŒå†æ¥ç¶šã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚ã“ã‚Œã‚’è§£æ¶ˆã™ã‚‹ãŸã‚ã«ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã§ã“ã®é–¢æ•°ã®å‘¼ã³å‡ºã—ã‚’ãƒ©ãƒƒãƒ—ã—ã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> onReceiveMessage <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>messages<span class="token punctuation">,</span> setMessages<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> onMessage <span class="token operator">=</span> <span class="token function">useEffectEvent</span><span class="token punctuation">(</span><span class="token parameter">receivedMessage</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">onReceiveMessage</span><span class="token punctuation">(</span>receivedMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">receivedMessage</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">onMessage</span><span class="token punctuation">(</span>receivedMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã¯ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ã¯ãªã„ãŸã‚ã€ä¾å­˜å€¤ã¨ã—ã¦æŒ‡å®šã™ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã™ã€‚çµæœçš„ã«ã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒæ¯å›ã®å†ãƒ¬ãƒ³ãƒ€ãƒ¼æ™‚ã«ç•°ãªã‚‹é–¢æ•°ã‚’æ¸¡ã—ã¦ããŸå ´åˆã§ã‚‚ã€ãƒãƒ£ãƒƒãƒˆãŒå†æ¥ç¶šã•ã‚Œã‚‹ã“ã¨ã¯ãªããªã‚Šã¾ã™ã€‚</section><section class="level4"aria-labelledby="ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ¼ãƒ‰ã¨éãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ¼ãƒ‰ã®åˆ†é›¢-separating-reactive-and-non-reactive-code"><h4 id="ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ¼ãƒ‰ã¨éãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ¼ãƒ‰ã®åˆ†é›¢-separating-reactive-and-non-reactive-code">ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ¼ãƒ‰ã¨éãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ¼ãƒ‰ã®åˆ†é›¢ {/<em>separating-reactive-and-non-reactive-code</em>/}</h4><p>ã“ã®ä¾‹ã§ã¯ã€<code>roomId</code> ãŒå¤‰æ›´ã•ã‚Œã‚‹ãŸã³ã«è¨ªå•ã‚’ãƒ­ã‚°ã«è¨˜éŒ²ã—ãŸã„ã¨ã—ã¾ã™ã€‚ãƒ­ã‚°ã«ã¯ç¾åœ¨ã® <code>notificationCount</code> ã®å€¤ã‚’å«ã‚ãŸã„ã‚‚ã®ã®ã€<code>notificationCount</code> ã®å¤‰æ›´ã«ã‚ˆã£ã¦ãƒ­ã‚°ã®è¨˜éŒ²ã‚’ç™ºç”Ÿã•ã›ãŸãã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<p>ä»Šå›ã‚‚è§£æ±ºç­–ã¯ã€éãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ¼ãƒ‰ã‚’ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã«åˆ†é›¢ã™ã‚‹ã“ã¨ã§ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Chat</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> notificationCount <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> onVisit <span class="token operator">=</span> <span class="token function">useEffectEvent</span><span class="token punctuation">(</span><span class="token parameter">visitedRoomId</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">logVisit</span><span class="token punctuation">(</span>visitedRoomId<span class="token punctuation">,</span> notificationCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">onVisit</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p><code>roomId</code> ã«å¯¾ã—ã¦ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ãŸã„ã®ã§ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…ã§ <code>roomId</code> ã‚’èª­ã¿å–ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ä¸€æ–¹ã§ <code>notificationCount</code> ã®å¤‰æ›´ã«ã‚ˆã£ã¦ä½™åˆ†ãªè¨ªå•ãƒ­ã‚°ã‚’è¨˜éŒ²ã—ãŸããªã„ã®ã§ã€<code>notificationCount</code> ã®å€¤ã¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆå†…ã§èª­ã¿å–ã‚Šã¾ã™ã€‚<a href="/learn/separating-events-from-effects#reading-latest-props-and-state-with-effect-events">ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‹ã‚‰æœ€æ–°ã® props ã¨ state ã‚’èª­ã‚€æ–¹æ³•ã«ã¤ã„ã¦è©³ã—ãå­¦ã¶ã€‚</a></section></section><section class="level3"aria-labelledby="ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ãŒæ„å›³ã›ãšå¤‰æ›´ã•ã‚Œã¦ã„ãªã„ã‹-does-some-reactive-value-change-unintentionally"><h3 id="ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ãŒæ„å›³ã›ãšå¤‰æ›´ã•ã‚Œã¦ã„ãªã„ã‹-does-some-reactive-value-change-unintentionally">ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ãŒæ„å›³ã›ãšå¤‰æ›´ã•ã‚Œã¦ã„ãªã„ã‹ï¼Ÿ {/<em>does-some-reactive-value-change-unintentionally</em>/}</h3><p>å ´åˆã«ã‚ˆã£ã¦ã¯ã€ç‰¹å®šã®å€¤ã«å¯¾ã—ã¦ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒã€Œãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã€ã§<em>ã‚ã£ã¦ã¯ã»ã—ã„</em>ãŒã€ãƒ¦ãƒ¼ã‚¶è¦–ç‚¹ã‹ã‚‰ã®å®Ÿè³ªçš„ãªå¤‰åŒ–ãŒãªã„ã®ã«å€¤ãŒé »ç¹ã«å¤‰ã‚ã‚Šã™ãã¦ã—ã¾ã†ã€ã¨ã„ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æœ¬ä½“ã§ <code>options</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…ã§èª­ã¿å–ã£ã¦ã„ã‚‹ã¨ã—ã¾ã—ã‚‡ã†ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl<span class="token punctuation">,</span>
    <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span></code></pre><p>ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æœ¬ä½“å†…ã§å®£è¨€ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€<a href="/learn/lifecycle-of-reactive-effects#effects-react-to-reactive-values">ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤</a>ã§ã™ã€‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…ã§ã“ã®ã‚ˆã†ãªãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã‚’èª­ã¿å–ã‚‹å ´åˆã¯ä¾å­˜å€¤ã¨ã—ã¦å®£è¨€ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒãã®å¤‰æ›´ã«ã€Œåå¿œã€ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚<pre class="language-js"><code class="language-js">  <span class="token comment">// ...</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>ä¾å­˜å€¤ã¨ã—ã¦å®£è¨€ã™ã‚‹ã“ã¨ã¯é‡è¦ã§ã™ï¼ ã“ã‚Œã«ã‚ˆã‚Šã€ä¾‹ãˆã° <code>roomId</code> ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã«ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒæ–°ã—ã„ <code>options</code> ã§ãƒãƒ£ãƒƒãƒˆã«å†æ¥ç¶šã™ã‚‹ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚ãŸã ã—ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã«ã¯å•é¡Œã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’ç¢ºèªã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ã®å…¥åŠ›æ¬„ã«å…¥åŠ›ã—ã¦ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ä½•ãŒèµ·ã“ã‚‹ã‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Temporarily disable the linter to demonstrate the problem</span>
  <span class="token comment">// eslint-disable-next-line react-hooks/exhaustive-deps</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl<span class="token punctuation">,</span>
    <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Welcome</span> to the <span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> room<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>message<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setMessage</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> setRoomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'general'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Choose</span> the chat room<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>select
          value<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setRoomId</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"general"</span><span class="token operator">></span>general<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"travel"</span><span class="token operator">></span>travel<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"music"</span><span class="token operator">></span>music<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>select<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span> roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> serverUrl<span class="token punctuation">,</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl <span class="token operator">+</span> <span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><p>ä¸Šè¨˜ã®ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ã§ã¯ã€å…¥åŠ›æ¬„ã¯ <code>message</code> ã¨ã„ã† state å¤‰æ•°ã®ã¿ã‚’æ›´æ–°ã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶è¦–ç‚¹ã‹ã‚‰ã™ã‚‹ã¨ã€ã“ã‚ŒãŒãƒãƒ£ãƒƒãƒˆã®æ¥ç¶šã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã¹ãã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã—ã‹ã—ã€<code>message</code> ã‚’æ›´æ–°ã™ã‚‹ãŸã³ã«ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å†ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚Œã¾ã™ã€‚ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å†ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚Œã‚‹ãŸã³ã«ã€ãã®å†…éƒ¨ã®ã‚³ãƒ¼ãƒ‰ãŒæœ€åˆã‹ã‚‰å†å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚<p><code>ChatRoom</code> ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†ãƒ¬ãƒ³ãƒ€ãƒ¼ã”ã¨ã«ã€æ–°ã—ã„ <code>options</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚¼ãƒ­ã‹ã‚‰å†ä½œæˆã•ã‚Œã¾ã™ã€‚React ã¯ã€<code>options</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå‰å›ã®ãƒ¬ãƒ³ãƒ€ãƒ¼æ™‚ã«ä½œæˆã•ã‚ŒãŸ <code>options</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã¯<em>ç•°ãªã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</em>ã§ã‚ã‚‹ã¨èªè­˜ã—ã¾ã™ã€‚å¾“ã£ã¦ã€ï¼ˆ<code>options</code> ã«ä¾å­˜ã™ã‚‹ï¼‰ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å†åŒæœŸãŒç™ºç”Ÿã—ã€ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã«ã‚ˆã‚Šãƒãƒ£ãƒƒãƒˆã®å†æ¥ç¶šãŒç™ºç”Ÿã—ã¦ã—ã¾ã„ã¾ã™ã€‚<p><strong>ã“ã®å•é¡Œã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨é–¢æ•°ã«ã®ã¿å½±éŸ¿ã—ã¾ã™ã€‚JavaScript ã§ã¯ã€æ–°ã—ãä½œæˆã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã¯ã€ä»–ã®ã™ã¹ã¦ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã¨ã¯ç•°ãªã‚‹ã¨è¦‹ãªã•ã‚Œã¾ã™ã€‚ä¸­èº«ãŒåŒã˜ã§ã‚ã£ã¦ã‚‚é–¢ä¿‚ã‚ã‚Šã¾ã›ã‚“ï¼</strong><pre class="language-js"><code class="language-js"><span class="token comment">// During the first render</span>
<span class="token keyword">const</span> options1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">,</span> <span class="token literal-property property">roomId</span><span class="token operator">:</span> <span class="token string">'music'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// During the next render</span>
<span class="token keyword">const</span> options2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">,</span> <span class="token literal-property property">roomId</span><span class="token operator">:</span> <span class="token string">'music'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// These are two different objects!</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">is</span><span class="token punctuation">(</span>options1<span class="token punctuation">,</span> options2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span></code></pre><p><strong>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã‚„é–¢æ•°å‹ã®ä¾å­˜å€¤ã¯ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒå¿…è¦ä»¥ä¸Šã«å†åŒæœŸã•ã‚Œã‚‹åŸå› ã¨ãªã‚Šã¾ã™</strong>ã€‚<p>ã—ãŸãŒã£ã¦ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜å€¤ã¨ã—ã¦ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã¯ã€å¯èƒ½ãªé™ã‚Šé¿ã‘ã‚‹ã¹ãã§ã™ã€‚ä»£ã‚ã‚Šã«ã€ãã‚Œã‚‰ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¤–å´ã‚„ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å†…å´ã«ç§»å‹•ã•ã›ã‚‹ã‹ã€ã‚ã‚‹ã„ã¯ãã‚Œã‚‰ã‹ã‚‰ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãªå€¤ã‚’æŠ½å‡ºã™ã‚‹ã‚ˆã†è©¦ã¿ã¦ãã ã•ã„ã€‚<section class="level4"aria-labelledby="é™çš„ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå¤–ã«ç§»å‹•-move-static-objects-and-functions-outside-your-component"><h4 id="é™çš„ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå¤–ã«ç§»å‹•-move-static-objects-and-functions-outside-your-component">é™çš„ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå¤–ã«ç§»å‹• {/<em>move-static-objects-and-functions-outside-your-component</em>/}</h4><p>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒ props ã‚„ state ã«ä¾å­˜ã—ãªã„å ´åˆã€ãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¤–ã«ç§»å‹•ã§ãã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">roomId</span><span class="token operator">:</span> <span class="token string">'music'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>ã“ã‚Œã«ã‚ˆã‚Šã€ãã‚ŒãŒãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ãªã„ã“ã¨ã‚’ãƒªãƒ³ã‚¿ã«å¯¾ã—ã¦<em>è¨¼æ˜</em>ã§ãã¾ã™ã€‚å†ãƒ¬ãƒ³ãƒ€ãƒ¼ã®çµæœã¨ã—ã¦å¤‰æ›´ã•ã‚Œã‚‹ã“ã¨ãŒãªã„ãŸã‚ã€ä¾å­˜å€¤ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€<code>ChatRoom</code> ã‚’å†ãƒ¬ãƒ³ãƒ€ãƒ¼ã—ã¦ã‚‚ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒå†åŒæœŸã•ã‚Œã‚‹ã“ã¨ã¯ãªããªã‚Šã¾ã™ã€‚<p>ã“ã‚Œã¯é–¢æ•°ã§ã‚‚åŒæ§˜ã§ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">createOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">roomId</span><span class="token operator">:</span> <span class="token string">'music'</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token function">createOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p><code>createOptions</code> ã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¤–ã§å®£è¨€ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã—ãŸãŒã£ã¦ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜å€¤ã«æŒ‡å®šã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã—ã€ã“ã®é–¢æ•°ãŒã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å†åŒæœŸã‚’ç™ºç”Ÿã•ã›ã‚‹ã“ã¨ã‚‚æ±ºã—ã¦ã‚ã‚Šã¾ã›ã‚“ã€‚</section><section class="level4"aria-labelledby="ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã‚’ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…éƒ¨ã«ç§»å‹•-move-dynamic-objects-and-functions-inside-your-effect"><h4 id="ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã‚’ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…éƒ¨ã«ç§»å‹•-move-dynamic-objects-and-functions-inside-your-effect">ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã‚’ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…éƒ¨ã«ç§»å‹• {/<em>move-dynamic-objects-and-functions-inside-your-effect</em>/}</h4><p>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå†ãƒ¬ãƒ³ãƒ€ãƒ¼ã®çµæœã¨ã—ã¦å¤‰æ›´ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ï¼ˆä¾‹ï¼šprops ã¨ã—ã¦ã® <code>roomId</code>ï¼‰ã«ä¾å­˜ã—ã¦ã„ã‚‹å ´åˆã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®<em>å¤–å´</em>ã«å¼•ã£å¼µã‚Šå‡ºã™ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ã—ã‹ã—ãã‚Œã‚’ä½œæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰<em>å†…éƒ¨</em>ã«ç§»å‹•ã•ã›ã‚‹ã“ã¨ã¯å¯èƒ½ã§ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl<span class="token punctuation">,</span>
      <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p><code>options</code> ã¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å†…éƒ¨ã§å®£è¨€ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜å€¤ã§ã¯ãªããªã‚Šã¾ã™ã€‚ä»£ã‚ã‚Šã«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã§ä½¿ç”¨ã•ã‚Œã‚‹å”¯ä¸€ã®ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã¯ <code>roomId</code> ã¨ãªã‚Šã¾ã™ã€‚<code>roomId</code> ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã§ã¯ãªã„ãŸã‚ã€<em>æ„å›³ã›ãš</em>å¤‰ã‚ã£ã¦ã—ã¾ã†ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚JavaScript ã§ã¯ã€æ•°å€¤ã‚„æ–‡å­—åˆ—ã¯å†…å®¹ã«ã‚ˆã£ã¦æ¯”è¼ƒã•ã‚Œã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token comment">// During the first render</span>
<span class="token keyword">const</span> roomId1 <span class="token operator">=</span> <span class="token string">'music'</span><span class="token punctuation">;</span>

<span class="token comment">// During the next render</span>
<span class="token keyword">const</span> roomId2 <span class="token operator">=</span> <span class="token string">'music'</span><span class="token punctuation">;</span>

<span class="token comment">// These two strings are the same!</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">is</span><span class="token punctuation">(</span>roomId1<span class="token punctuation">,</span> roomId2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre><p>ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šã€å…¥åŠ›æ¬„ã‚’ç·¨é›†ã—ã¦ã‚‚ãƒãƒ£ãƒƒãƒˆã®å†æ¥ç¶šã¯èµ·ã“ã‚‰ãªããªã‚Šã¾ã™ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl<span class="token punctuation">,</span>
      <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Welcome</span> to the <span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> room<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>message<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setMessage</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> setRoomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'general'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Choose</span> the chat room<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>select
          value<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setRoomId</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"general"</span><span class="token operator">></span>general<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"travel"</span><span class="token operator">></span>travel<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"music"</span><span class="token operator">></span>music<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>select<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span> roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> serverUrl<span class="token punctuation">,</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl <span class="token operator">+</span> <span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><p>ãŸã ã— <code>roomId</code> ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€æœŸå¾…é€šã‚Šå†æ¥ç¶šãŒç™ºç”Ÿã—ã¾ã™ã€‚<p>ã“ã‚Œã¯é–¢æ•°ã®å ´åˆã§ã‚‚åŒæ§˜ã§ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> serverUrl <span class="token operator">=</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">createOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl<span class="token punctuation">,</span>
        <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token function">createOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…ã§ãƒ­ã‚¸ãƒƒã‚¯ã®ä¸€éƒ¨ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã™ã‚‹ãŸã‚ã®ç‹¬è‡ªã®é–¢æ•°ã‚’ä½œæˆã§ãã¾ã™ã€‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®<em>å†…éƒ¨</em>ã§å®£è¨€ã—ã¦ã„ã‚‹é™ã‚Šã€ãã‚Œã‚‰ã¯ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå€¤ã§ã¯ãªã„ã®ã§ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜å€¤ã«ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</section><section class="level4"aria-labelledby="ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å€¤ã‚’èª­ã¿å–ã‚‹-read-primitive-values-from-objects"><h4 id="ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å€¤ã‚’èª­ã¿å–ã‚‹-read-primitive-values-from-objects">ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å€¤ã‚’èª­ã¿å–ã‚‹ {/<em>read-primitive-values-from-objects</em>/}</h4><p>props ã‹ã‚‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å—ã‘å–ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> options <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>ã—ã‹ã—ã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã‚’ãƒ¬ãƒ³ãƒ€ãƒ¼ä¸­ã«è¡Œã£ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã¨ã„ã†å¿ƒé…ãŒã‚ã‚Šã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span>
  roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
  options<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
    <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl<span class="token punctuation">,</span>
    <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
  <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">/</span><span class="token operator">></span></code></pre><p>ã“ã‚Œã«ã‚ˆã‚Šã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ãŸã³ã«ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã«ã‚ˆã‚‹å†æ¥ç¶šãŒç™ºç”Ÿã—ã¦ã—ã¾ã„ã¾ã™ã€‚ã“ã‚Œã‚’ä¿®æ­£ã™ã‚‹ã«ã¯ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®<em>å¤–å´</em>ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰æƒ…å ±ã‚’èª­ã¿å–ã£ã¦ãŠãã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°è‡ªä½“ã‚’ä¾å­˜å€¤ã¨ã—ã¦æŒãŸã›ãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> options <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> serverUrl <span class="token punctuation">}</span> <span class="token operator">=</span> options<span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId<span class="token punctuation">,</span>
      <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> serverUrl<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>ãƒ­ã‚¸ãƒƒã‚¯ã¯å°‘ã—ç¹°ã‚Šè¿”ã—ã«ãªã‚Šã¾ã™ï¼ˆã‚¨ãƒ•ã‚§ã‚¯ãƒˆå¤–ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å€¤ã‚’èª­ã¿å–ã‚Šã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…ã§åŒã˜å€¤ã‚’æŒã¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ã„ã‚‹ï¼‰ã€‚ã—ã‹ã—ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒ<em>å®Ÿéš›ã«</em>ä¾å­˜ã—ã¦ã„ã‚‹æƒ…å ±ãŒä½•ãªã®ã‹ãŒã€éå¸¸ã«æ˜ç¢ºã«ãªã‚Šã¾ã™ã€‚è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒèª¤ã£ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å†ä½œæˆã—ã¦ã„ã‚‹å ´åˆã§ã‚‚ã€ãƒãƒ£ãƒƒãƒˆã®å†æ¥ç¶šã¯èµ·ã“ã‚Šã¾ã›ã‚“ã€‚ã§ã™ãŒ <code>options.roomId</code> ã‚„ <code>options.serverUrl</code> ãŒå®Ÿéš›ã«ç•°ãªã‚‹å ´åˆã¯ã€ãƒãƒ£ãƒƒãƒˆãŒå†æ¥ç¶šã•ã‚Œã¾ã™ã€‚</section><section class="level4"aria-labelledby="é–¢æ•°ã‹ã‚‰ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å€¤ã‚’è¨ˆç®—ã™ã‚‹-calculate-primitive-values-from-functions"><h4 id="é–¢æ•°ã‹ã‚‰ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å€¤ã‚’è¨ˆç®—ã™ã‚‹-calculate-primitive-values-from-functions">é–¢æ•°ã‹ã‚‰ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å€¤ã‚’è¨ˆç®—ã™ã‚‹ {/<em>calculate-primitive-values-from-functions</em>/}</h4><p>åŒã˜ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯é–¢æ•°ã«ã‚‚é©ç”¨ã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒé–¢æ•°ã‚’æ¸¡ã—ã¦ãã‚‹å ´åˆã‚’è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚<pre class="language-js"><code class="language-js"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span>
  roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
  getOptions<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl<span class="token punctuation">,</span>
      <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">/</span><span class="token operator">></span></code></pre><p>ã“ã‚Œã‚’ä¾å­˜å€¤ã«ã—ãªã„ï¼ˆå†ãƒ¬ãƒ³ãƒ€ãƒ¼æ™‚ã®å†æ¥ç¶šã‚’é˜²ãï¼‰ãŸã‚ã«ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å¤–å´ã§ãã‚Œã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…ã§èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã‚‹ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ãªã„ <code>roomId</code> ã¨ <code>serverUrl</code> ã®å€¤ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> getOptions <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> serverUrl <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId<span class="token punctuation">,</span>
      <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> serverUrl<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span>
  <span class="token comment">// ...</span></code></pre><p>ã“ã‚Œã¯ã€ãƒ¬ãƒ³ãƒ€ãƒ¼ä¸­ã«å‘¼ã³å‡ºã—ã¦ã‚‚å®‰å…¨ãª<a href="/learn/keeping-components-pure">ç´”ç²‹</a>ãªé–¢æ•°ã«å¯¾ã—ã¦ã®ã¿æ©Ÿèƒ½ã—ã¾ã™ã€‚é–¢æ•°ãŒã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã‚ã‚Šã€ãã®å¤‰æ›´ãŒã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å†åŒæœŸã‚’å¼•ãèµ·ã“ã•ãªã„ã‚ˆã†ã«ã—ãŸã„å ´åˆã¯ã€<a href="#do-you-want-to-read-a-value-without-reacting-to-its-changes">ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã«ãƒ©ãƒƒãƒ—ã—ã¦ãã ã•ã„</a>ã€‚</p><recap><ul><li>ä¾å­˜é…åˆ—ã¯å¸¸ã«ã‚³ãƒ¼ãƒ‰ã¨ä¸€è‡´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚<li>ä¾å­˜é…åˆ—ãŒæ°—ã«å…¥ã‚‰ãªã„å ´åˆã€ç·¨é›†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã¯ã‚³ãƒ¼ãƒ‰ã®æ–¹ã§ã‚ã‚‹ã€‚<li>ãƒªãƒ³ã‚¿ã‚’æŠ‘åˆ¶ã™ã‚‹ã¨éå¸¸ã«ã‚ã‹ã‚Šã«ãã„ãƒã‚°ãŒç™ºç”Ÿã™ã‚‹ãŸã‚ã€ã„ã‹ãªã‚‹å ´åˆã‚‚é¿ã‘ã‚‹ã¹ãã§ã‚ã‚‹ã€‚<li>ä¾å­˜å€¤ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€ãƒªãƒ³ã‚¿ã«ãã‚ŒãŒä¸è¦ã§ã‚ã‚‹ã“ã¨ã‚’ã€Œè¨¼æ˜ã€ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚<li>ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶æ“ä½œã«å¿œç­”ã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã€ãã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã«ç§»å‹•ã™ã‚‹ã€‚<li>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ç•°ãªã‚‹éƒ¨åˆ†ãŒç•°ãªã‚‹ç†ç”±ã§å†å®Ÿè¡Œã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã€è¤‡æ•°ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã«åˆ†å‰²ã™ã‚‹ã€‚<li>å‰ã® state ã«åŸºã¥ã„ã¦ state ã‚’æ›´æ–°ã—ãŸã„å ´åˆã¯ã€æ›´æ–°ç”¨é–¢æ•°ã‚’æ¸¡ã™ã€‚<li>æœ€æ–°ã®å€¤ã‚’èª­ã¿å–ã‚ŠãŸã„ãŒãã‚Œã«ã€Œåå¿œã€ã—ãŸããªã„å ´åˆã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‹ã‚‰ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã‚’æŠ½å‡ºã™ã‚‹ã€‚<li>JavaScript ã§ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é–¢æ•°ã¯ã€ç•°ãªã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ä½œæˆã•ã‚ŒãŸå ´åˆã€ç•°ãªã‚‹å€¤ã ã¨è¦‹ãªã•ã‚Œã‚‹ã€‚<li>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã‚„é–¢æ•°å‹ã®ä¾å­˜å€¤ã¯ãªã‚‹ã¹ãé¿ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¤–å´ã‹ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å†…å´ã«ç§»å‹•ã•ã›ã‚‹ã€‚</ul></recap><challenges></challenges></section><section class="level4"aria-labelledby="ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹å•é¡Œã‚’ä¿®æ­£-fix-a-resetting-interval"><h4 id="ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹å•é¡Œã‚’ä¿®æ­£-fix-a-resetting-interval">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹å•é¡Œã‚’ä¿®æ­£ {/<em>fix-a-resetting-interval</em>/}</h4><p>ã“ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ 1 ç§’ã”ã¨ã«ç™ºç«ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¦ã„ã¾ã™ã€‚ã—ã‹ã—ä½•ã‹ãŒãŠã‹ã—ã„ã“ã¨ã«æ°—ä»˜ãã¾ã—ãŸã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ãŒç™ºç«ã™ã‚‹ãŸã³ã«ç ´æ£„ã•ã‚Œã€å†ä½œæˆã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ãŒä½•åº¦ã‚‚å†ä½œæˆã•ã‚Œãªã„ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚</p><hint><p>ã“ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰ã¯ <code>count</code> ã«ä¾å­˜ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ã“ã®ä¾å­˜å€¤ã®å¿…è¦æ€§ã‚’ãªãã™æ–¹æ³•ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ <code>count</code> ã®å€¤ã«ä¾å­˜ã›ãšã€å‰å›ã®å€¤ã«åŸºã¥ã„ã¦ state ã‚’æ›´æ–°ã™ã‚‹æ–¹æ³•ãŒã‚ã‚‹ã¯ãšã§ã™ã€‚</p></hint><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Timer</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Creating an interval'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'â° Interval tick'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Clearing an interval'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Counter</span><span class="token operator">:</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
<span class="token punctuation">}</span></code></pre></sandpack><solution><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¸­ã§ <code>count</code> ã® state ã‚’ <code>count + 1</code> ã«æ›´æ–°ã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€ã“ã‚Œã«ã‚ˆã‚Šã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒ <code>count</code> ã«ä¾å­˜ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚<code>count</code> ã¯æ¯å›æ›´æ–°ã•ã‚Œã‚‹ãŸã‚ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚‚æ¯å›å†ä½œæˆã•ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚<p>ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ã«ã¯ã€<a href="/reference/react/useState#updating-state-based-on-the-previous-state">æ›´æ–°ç”¨é–¢æ•°</a>ã‚’ä½¿ã„ã€<code>setCount(count + 1)</code> ã§ã¯ãªã <code>setCount(c => c + 1)</code> ã¨æ›¸ãã‚ˆã†ã«ã—ã¾ã™ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Timer</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Creating an interval'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'â° Interval tick'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setCount</span><span class="token punctuation">(</span><span class="token parameter">c</span> <span class="token arrow operator">=></span> c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Clearing an interval'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Counter</span><span class="token operator">:</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
<span class="token punctuation">}</span></code></pre></sandpack><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¸­ã§ <code>count</code> ã‚’èª­ã¿å–ã‚‹ä»£ã‚ã‚Šã«ã€<code>c => c + 1</code> ã¨ã„ã†æŒ‡ç¤ºï¼ˆã€Œã“ã®æ•°å€¤ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã›ã‚ˆã€ï¼‰ã‚’ React ã«æ¸¡ã—ã¾ã™ã€‚React ã¯æ¬¡ã®ãƒ¬ãƒ³ãƒ€ãƒ¼æ™‚ã«ãã‚Œã‚’é©ç”¨ã—ã¾ã™ã€‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¸­ã§ <code>count</code> ã®å€¤ã‚’èª­ã¿å–ã‚‹å¿…è¦ãŒãªããªã£ãŸã®ã§ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜é…åˆ—ã‚’ç©º (<code>[]</code>) ã«ä¿ã¤ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒæ¯ç§’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚’å†ä½œæˆã™ã‚‹ã®ã‚’é˜²ãã“ã¨ãŒã§ãã¾ã™ã€‚</p></solution></section><section class="level4"aria-labelledby="ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®å†ãƒˆãƒªã‚¬ã‚’ä¿®æ­£-fix-a-retriggering-animation"><h4 id="ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®å†ãƒˆãƒªã‚¬ã‚’ä¿®æ­£-fix-a-retriggering-animation">ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®å†ãƒˆãƒªã‚¬ã‚’ä¿®æ­£ {/<em>fix-a-retriggering-animation</em>/}</h4><p>ã“ã®ä¾‹ã§ã¯ã€"Show" ã‚’æŠ¼ã™ã¨ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã—ã¾ã™ã€‚ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯ 1 ç§’ã‹ã‹ã‚Šã¾ã™ã€‚"Remove" ã‚’æŠ¼ã™ã¨ã€ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã™ãã«æ¶ˆãˆã¾ã™ã€‚ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯ã€<code>animation.js</code> ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ãƒ—ãƒ¬ãƒ¼ãƒ³ãª JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—</a>ã‚’ä½¿ã£ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯å¤‰æ›´ã®å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã®ã§ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚ˆã†ã«æ‰±ã£ã¦ãã ã•ã„ã€‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ DOM ãƒãƒ¼ãƒ‰ã«å¯¾ã—ã¦ <code>FadeInAnimation</code> ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã« <code>start(duration)</code> ã¾ãŸã¯ <code>stop()</code> ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚<code>duration</code> ã¯ã‚¹ãƒ©ã‚¤ãƒ€ã§åˆ¶å¾¡ã•ã‚Œã¾ã™ã€‚ã‚¹ãƒ©ã‚¤ãƒ€ã‚’èª¿æ•´ã—ã¦ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚<p>ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã™ã§ã«å‹•ä½œã—ã¦ã„ã¾ã™ãŒã€å¤‰æ›´ã—ãŸã„ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚ç¾åœ¨ã€<code>duration</code> state å¤‰æ•°ã‚’åˆ¶å¾¡ã™ã‚‹ã‚¹ãƒ©ã‚¤ãƒ€ã‚’å‹•ã‹ã™ã¨ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå†ãƒˆãƒªã‚¬ã•ã‚Œã¦ã—ã¾ã£ã¦ã„ã¾ã™ã€‚<code>duration</code> å¤‰æ•°ã«å¯¾ã—ã¦ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒã€Œåå¿œã€ã—ãªã„ã‚ˆã†ã€å‹•ä½œã‚’å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚"Show" ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã«ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ã‚¹ãƒ©ã‚¤ãƒ€ã§æŒ‡å®šã™ã‚‹ç¾åœ¨ã® <code>duration</code> ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã—ã‹ã—ã‚¹ãƒ©ã‚¤ãƒ€ã®æ“ä½œãã‚Œè‡ªä½“ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå†ãƒˆãƒªã‚¬ã•ã‚Œã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚</p><hint><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…ã«ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¦ã¯ã„ã‘ãªã„ã‚³ãƒ¼ãƒ‰ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å¤–ã«éãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ¼ãƒ‰ã‚’ç§»å‹•ã™ã‚‹ã«ã¯ã©ã†ã™ã‚Œã°ã„ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ</p></hint><sandpack><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"experimental"</span><span class="token punctuation">,</span>
    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"experimental"</span><span class="token punctuation">,</span>
    <span class="token property">"react-scripts"</span><span class="token operator">:</span> <span class="token string">"latest"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"react-scripts start"</span><span class="token punctuation">,</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"react-scripts build"</span><span class="token punctuation">,</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"react-scripts test --env=jsdom"</span><span class="token punctuation">,</span>
    <span class="token property">"eject"</span><span class="token operator">:</span> <span class="token string">"react-scripts eject"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> experimental_useEffectEvent <span class="token keyword module">as</span> useEffectEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">FadeInAnimation</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./animation.js'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Welcome</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> duration <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> animation <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FadeInAnimation</span><span class="token punctuation">(</span>ref<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    animation<span class="token punctuation">.</span><span class="token method function property-access">start</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      animation<span class="token punctuation">.</span><span class="token method function property-access">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>duration<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>h1
      ref<span class="token operator">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span>
      style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
        <span class="token literal-property property">textAlign</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
        <span class="token literal-property property">backgroundImage</span><span class="token operator">:</span> <span class="token string">'radial-gradient(circle, rgba(63,94,251,1) 0%, rgba(252,70,107,1) 100%)'</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">></span>
      <span class="token maybe-class-name">Welcome</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>duration<span class="token punctuation">,</span> setDuration<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>show<span class="token punctuation">,</span> setShow<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>input
          type<span class="token operator">=</span><span class="token string">"range"</span>
          min<span class="token operator">=</span><span class="token string">"100"</span>
          max<span class="token operator">=</span><span class="token string">"3000"</span>
          value<span class="token operator">=</span><span class="token punctuation">{</span>duration<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setDuration</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>br <span class="token operator">/</span><span class="token operator">></span>
        <span class="token maybe-class-name">Fade</span> <span class="token keyword">in</span> <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token punctuation">{</span>duration<span class="token punctuation">}</span> ms
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setShow</span><span class="token punctuation">(</span><span class="token operator">!</span>show<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token punctuation">{</span>show <span class="token operator">?</span> <span class="token string">'Remove'</span> <span class="token operator">:</span> <span class="token string">'Show'</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">{</span>show <span class="token operator">&#x26;&#x26;</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Welcome</span> duration<span class="token operator">=</span><span class="token punctuation">{</span>duration<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name">FadeInAnimation</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">node</span> <span class="token operator">=</span> node<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">duration</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">duration</span> <span class="token operator">=</span> duration<span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">duration</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Jump to end immediately</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">onProgress</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">onProgress</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// Start animating</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">startTime</span> <span class="token operator">=</span> <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">frameId</span> <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">onFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">onFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> timePassed <span class="token operator">=</span> <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">startTime</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> progress <span class="token operator">=</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">min</span><span class="token punctuation">(</span>timePassed <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">duration</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">onProgress</span><span class="token punctuation">(</span>progress<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>progress <span class="token operator">&#x3C;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// We still have more frames to paint</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">frameId</span> <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">onFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">onProgress</span><span class="token punctuation">(</span><span class="token parameter">progress</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">node</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">opacity</span> <span class="token operator">=</span> progress<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">frameId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">startTime</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">frameId</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">duration</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label<span class="token punctuation">,</span> button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">html<span class="token punctuation">,</span> body</span> <span class="token punctuation">{</span> <span class="token property">min-height</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><solution><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ <code>duration</code> ã®æœ€æ–°ã®å€¤ã‚’èª­ã¿å–ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€<code>duration</code> ã®å¤‰æ›´ã«å¯¾ã—ã¦ã€Œåå¿œã€ã•ã›ãŸãã‚ã‚Šã¾ã›ã‚“ã€‚ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã« <code>duration</code> ã‚’ä½¿ç”¨ã—ã¾ã™ãŒã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«é–‹å§‹ã•ã‚Œã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚éãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚³ãƒ¼ãƒ‰ã‚’ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã«æŠ½å‡ºã—ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‹ã‚‰ãã®é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ãã ã•ã„ã€‚</p><sandpack><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"experimental"</span><span class="token punctuation">,</span>
    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"experimental"</span><span class="token punctuation">,</span>
    <span class="token property">"react-scripts"</span><span class="token operator">:</span> <span class="token string">"latest"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"react-scripts start"</span><span class="token punctuation">,</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"react-scripts build"</span><span class="token punctuation">,</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"react-scripts test --env=jsdom"</span><span class="token punctuation">,</span>
    <span class="token property">"eject"</span><span class="token operator">:</span> <span class="token string">"react-scripts eject"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">FadeInAnimation</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./animation.js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> experimental_useEffectEvent <span class="token keyword module">as</span> useEffectEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Welcome</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> duration <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> onAppear <span class="token operator">=</span> <span class="token function">useEffectEvent</span><span class="token punctuation">(</span><span class="token parameter">animation</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    animation<span class="token punctuation">.</span><span class="token method function property-access">start</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> animation <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FadeInAnimation</span><span class="token punctuation">(</span>ref<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onAppear</span><span class="token punctuation">(</span>animation<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      animation<span class="token punctuation">.</span><span class="token method function property-access">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>h1
      ref<span class="token operator">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span>
      style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
        <span class="token literal-property property">textAlign</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
        <span class="token literal-property property">backgroundImage</span><span class="token operator">:</span> <span class="token string">'radial-gradient(circle, rgba(63,94,251,1) 0%, rgba(252,70,107,1) 100%)'</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">></span>
      <span class="token maybe-class-name">Welcome</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>duration<span class="token punctuation">,</span> setDuration<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>show<span class="token punctuation">,</span> setShow<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>input
          type<span class="token operator">=</span><span class="token string">"range"</span>
          min<span class="token operator">=</span><span class="token string">"100"</span>
          max<span class="token operator">=</span><span class="token string">"3000"</span>
          value<span class="token operator">=</span><span class="token punctuation">{</span>duration<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setDuration</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Number</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>br <span class="token operator">/</span><span class="token operator">></span>
        <span class="token maybe-class-name">Fade</span> <span class="token keyword">in</span> <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token punctuation">{</span>duration<span class="token punctuation">}</span> ms
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setShow</span><span class="token punctuation">(</span><span class="token operator">!</span>show<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token punctuation">{</span>show <span class="token operator">?</span> <span class="token string">'Remove'</span> <span class="token operator">:</span> <span class="token string">'Show'</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">{</span>show <span class="token operator">&#x26;&#x26;</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Welcome</span> duration<span class="token operator">=</span><span class="token punctuation">{</span>duration<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name">FadeInAnimation</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">node</span> <span class="token operator">=</span> node<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">duration</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">duration</span> <span class="token operator">=</span> duration<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">onProgress</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">startTime</span> <span class="token operator">=</span> <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">frameId</span> <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">onFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">onFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> timePassed <span class="token operator">=</span> <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">startTime</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> progress <span class="token operator">=</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">min</span><span class="token punctuation">(</span>timePassed <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">duration</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">onProgress</span><span class="token punctuation">(</span>progress<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>progress <span class="token operator">&#x3C;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// We still have more frames to paint</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">frameId</span> <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">onFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">onProgress</span><span class="token punctuation">(</span><span class="token parameter">progress</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">node</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">opacity</span> <span class="token operator">=</span> progress<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">frameId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">startTime</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">frameId</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">duration</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label<span class="token punctuation">,</span> button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">html<span class="token punctuation">,</span> body</span> <span class="token punctuation">{</span> <span class="token property">min-height</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><p><code>onAppear</code> ã®ã‚ˆã†ãªã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã¯ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ã¯ãªã„ãŸã‚ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†ãƒˆãƒªã‚¬ã™ã‚‹ã“ã¨ãªã <code>duration</code> ã‚’å†…éƒ¨ã§èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p></solution></section><section class="level4"aria-labelledby="ãƒãƒ£ãƒƒãƒˆã®å†æ¥ç¶šã‚’ä¿®æ­£-fix-a-reconnecting-chat"><h4 id="ãƒãƒ£ãƒƒãƒˆã®å†æ¥ç¶šã‚’ä¿®æ­£-fix-a-reconnecting-chat">ãƒãƒ£ãƒƒãƒˆã®å†æ¥ç¶šã‚’ä¿®æ­£ {/<em>fix-a-reconnecting-chat</em>/}</h4><p>ã“ã®ä¾‹ã§ã¯ã€"Toggle theme" ã‚’æŠ¼ã™ãŸã³ã«ãƒãƒ£ãƒƒãƒˆã®å†æ¥ç¶šãŒç™ºç”Ÿã—ã¾ã™ã€‚ãªãœã“ã‚ŒãŒèµ·ã“ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ ã‚µãƒ¼ãƒã® URL ã‚’ç·¨é›†ã—ãŸã‚Šã€åˆ¥ã®ãƒãƒ£ãƒƒãƒˆãƒ«ãƒ¼ãƒ ã‚’é¸æŠã—ãŸã‚Šã—ãŸã¨ãã«ã®ã¿ãƒãƒ£ãƒƒãƒˆãŒå†æ¥ç¶šã•ã‚Œã‚‹ã‚ˆã†ã€ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚<p><code>chat.js</code> ã¯å¤–éƒ¨ã®ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦æ‰±ã£ã¦ãã ã•ã„ã€‚API ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«å‚ç…§ã—ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ãŒã€ç·¨é›†ã¯ã—ãªã„ã§ãã ã•ã„ã€‚</p><hint><p>ã“ã‚Œã‚’ä¿®æ­£ã™ã‚‹æ–¹æ³•ã¯è¤‡æ•°ã‚ã‚Šã¾ã™ãŒã€æœ€çµ‚çš„ã«ã¯ä¾å­˜å€¤ã¨ã—ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ã‚ãªã„ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p></hint><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ChatRoom</span></span> <span class="token keyword module">from</span> <span class="token string">'./ChatRoom.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isDark<span class="token punctuation">,</span> setIsDark<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> setRoomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'general'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>serverUrl<span class="token punctuation">,</span> setServerUrl<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'https://localhost:1234'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl<span class="token punctuation">,</span>
    <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>isDark <span class="token operator">?</span> <span class="token string">'dark'</span> <span class="token operator">:</span> <span class="token string">'light'</span><span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setIsDark</span><span class="token punctuation">(</span><span class="token operator">!</span>isDark<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Toggle</span> theme
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Server</span> <span class="token constant">URL</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>serverUrl<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setServerUrl</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Choose</span> the chat room<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>select
          value<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setRoomId</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"general"</span><span class="token operator">></span>general<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"travel"</span><span class="token operator">></span>travel<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"music"</span><span class="token operator">></span>music<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>select<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span> options<span class="token operator">=</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> options <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Welcome</span> to the <span class="token punctuation">{</span>options<span class="token punctuation">.</span><span class="token property-access">roomId</span><span class="token punctuation">}</span> room<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> serverUrl<span class="token punctuation">,</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> serverUrl <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected serverUrl to be a string. Received: '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> roomId <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected roomId to be a string. Received: '</span> <span class="token operator">+</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl <span class="token operator">+</span> <span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label<span class="token punctuation">,</span> button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector"><span class="token class">.dark</span></span> <span class="token punctuation">{</span> <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#222</span><span class="token punctuation">;</span> <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#eee</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><solution><p>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒå†å®Ÿè¡Œã•ã‚Œã‚‹ã®ã¯ã€<code>options</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ä¾å­˜ã—ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã†ã£ã‹ã‚Šå†ä½œæˆã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€å¯èƒ½ãªå ´åˆã¯å¸¸ã«ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜å€¤ã¨ã—ã¦ã¯ä½¿ç”¨ã—ãªã„ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚<p>æœ€ã‚‚å½±éŸ¿ç¯„å›²ã®å°ã•ã„ä¿®æ­£æ–¹æ³•ã¯ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®å¤–ã§ <code>roomId</code> ã¨ <code>serverUrl</code> ã‚’èª­ã¿å–ã‚Šã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ã“ã‚Œã‚‰ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãªå€¤ï¼ˆæ„å›³ã›ãšå¤‰æ›´ã•ã‚Œã‚‹ã“ã¨ãŒãªã„ï¼‰ã«ä¾å­˜ã•ã›ã‚‹ã“ã¨ã§ã™ã€‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå†…ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€ãã‚Œã‚’ <code>createConnection</code> ã«æ¸¡ã—ã¾ã™ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ChatRoom</span></span> <span class="token keyword module">from</span> <span class="token string">'./ChatRoom.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isDark<span class="token punctuation">,</span> setIsDark<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> setRoomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'general'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>serverUrl<span class="token punctuation">,</span> setServerUrl<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'https://localhost:1234'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl<span class="token punctuation">,</span>
    <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>isDark <span class="token operator">?</span> <span class="token string">'dark'</span> <span class="token operator">:</span> <span class="token string">'light'</span><span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setIsDark</span><span class="token punctuation">(</span><span class="token operator">!</span>isDark<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Toggle</span> theme
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Server</span> <span class="token constant">URL</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>serverUrl<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setServerUrl</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Choose</span> the chat room<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>select
          value<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setRoomId</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"general"</span><span class="token operator">></span>general<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"travel"</span><span class="token operator">></span>travel<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"music"</span><span class="token operator">></span>music<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>select<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span> options<span class="token operator">=</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> options <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> serverUrl <span class="token punctuation">}</span> <span class="token operator">=</span> options<span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId<span class="token punctuation">,</span>
      <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> serverUrl<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Welcome</span> to the <span class="token punctuation">{</span>options<span class="token punctuation">.</span><span class="token property-access">roomId</span><span class="token punctuation">}</span> room<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> serverUrl<span class="token punctuation">,</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> serverUrl <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected serverUrl to be a string. Received: '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> roomId <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected roomId to be a string. Received: '</span> <span class="token operator">+</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl <span class="token operator">+</span> <span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label<span class="token punctuation">,</span> button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector"><span class="token class">.dark</span></span> <span class="token punctuation">{</span> <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#222</span><span class="token punctuation">;</span> <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#eee</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><p>ã•ã‚‰ã«è‰¯ã„æ–¹æ³•ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ã® props ã§ã‚ã‚‹ <code>options</code> ã‚’ã€ã‚ˆã‚Šå…·ä½“çš„ãª <code>roomId</code> ã¨ <code>serverUrl</code> ã«ç½®ãæ›ãˆã‚‹ã“ã¨ã§ã™ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ChatRoom</span></span> <span class="token keyword module">from</span> <span class="token string">'./ChatRoom.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isDark<span class="token punctuation">,</span> setIsDark<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> setRoomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'general'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>serverUrl<span class="token punctuation">,</span> setServerUrl<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'https://localhost:1234'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>isDark <span class="token operator">?</span> <span class="token string">'dark'</span> <span class="token operator">:</span> <span class="token string">'light'</span><span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setIsDark</span><span class="token punctuation">(</span><span class="token operator">!</span>isDark<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Toggle</span> theme
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Server</span> <span class="token constant">URL</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>serverUrl<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setServerUrl</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Choose</span> the chat room<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>select
          value<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setRoomId</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"general"</span><span class="token operator">></span>general<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"travel"</span><span class="token operator">></span>travel<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"music"</span><span class="token operator">></span>music<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>select<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span>
        roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
        serverUrl<span class="token operator">=</span><span class="token punctuation">{</span>serverUrl<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> serverUrl <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId<span class="token punctuation">,</span>
      <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> serverUrl
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> serverUrl<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Welcome</span> to the <span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> room<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> serverUrl<span class="token punctuation">,</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> serverUrl <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected serverUrl to be a string. Received: '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> roomId <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected roomId to be a string. Received: '</span> <span class="token operator">+</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl <span class="token operator">+</span> <span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room at '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label<span class="token punctuation">,</span> button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector"><span class="token class">.dark</span></span> <span class="token punctuation">{</span> <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#222</span><span class="token punctuation">;</span> <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#eee</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><p>å¯èƒ½ãªé™ã‚Š props ã‚’ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å€¤ã«ã™ã‚‹ã“ã¨ã§ã€å¾Œã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æœ€é©åŒ–ãŒã‚„ã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚</p></solution></section><section class="level4"aria-labelledby="åˆ¥ã®ãƒãƒ£ãƒƒãƒˆå†æ¥ç¶šå•é¡Œã‚’ä¿®æ­£-fix-a-reconnecting-chat-again"><h4 id="åˆ¥ã®ãƒãƒ£ãƒƒãƒˆå†æ¥ç¶šå•é¡Œã‚’ä¿®æ­£-fix-a-reconnecting-chat-again">åˆ¥ã®ãƒãƒ£ãƒƒãƒˆå†æ¥ç¶šå•é¡Œã‚’ä¿®æ­£ {/<em>fix-a-reconnecting-chat-again</em>/}</h4><p>ã“ã®ä¾‹ã§ã¯ãƒãƒ£ãƒƒãƒˆã«æ¥ç¶šã™ã‚‹éš›ã«æš—å·åŒ– (encryption) ã®æœ‰ç„¡ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ã€æš—å·åŒ–ãŒã‚ªãƒ³ã®å ´åˆã¨ã‚ªãƒ•ã®å ´åˆã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç•°ãªã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ãƒ«ãƒ¼ãƒ ã‚’å¤‰æ›´ã—ã¦ã¿ã¦ãã ã•ã„ã€‚æ¬¡ã«ã€ãƒ†ãƒ¼ãƒã‚’åˆ‡ã‚Šæ›¿ãˆã¦ã¿ã¦ãã ã•ã„ã€‚ãƒãƒ£ãƒƒãƒˆãƒ«ãƒ¼ãƒ ã«æ¥ç¶šã—ã¦ã„ã‚‹é–“ã€æ•°ç§’ã”ã¨ã«æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šãã¾ã™ã€‚å—ä¿¡ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è‰²ãŒé¸æŠã—ãŸãƒ†ãƒ¼ãƒã«ä¸€è‡´ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚<p>ã“ã®ä¾‹ã§ã¯ã€ãƒ†ãƒ¼ãƒã‚’å¤‰æ›´ã™ã‚‹ãŸã³ã«ãƒãƒ£ãƒƒãƒˆãŒå†æ¥ç¶šã•ã‚Œã¦ã—ã¾ã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚’ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚ä¿®æ­£å¾Œã¯ã€ãƒ†ãƒ¼ãƒã‚’å¤‰æ›´ã—ã¦ã‚‚ãƒãƒ£ãƒƒãƒˆãŒå†æ¥ç¶šã•ã‚Œãšã€æš—å·åŒ–è¨­å®šã‚’åˆ‡ã‚Šæ›¿ãˆãŸã‚Šãƒ«ãƒ¼ãƒ ã‚’å¤‰æ›´ã—ãŸã‚Šã—ãŸå ´åˆã«ã®ã¿å†æ¥ç¶šã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚<p><code>chat.js</code> ã®ã‚³ãƒ¼ãƒ‰ã¯å¤‰æ›´ã—ãªã„ã§ãã ã•ã„ã€‚æŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆãªã„é™ã‚Šã€ãã‚Œä»¥å¤–ã®ã‚³ãƒ¼ãƒ‰ã¯å¤‰æ›´ã—ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚ä¾‹ãˆã°ã€ã©ã® props ã‚’æ¸¡ã™ã‹å¤‰ãˆã¦ã¿ã‚‹ã¨æœ‰ç”¨ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p><hint><p>props ã¨ã—ã¦ <code>onMessage</code> ã¨ <code>createConnection</code> ã¨ã„ã† 2 ã¤ã®é–¢æ•°ã‚’æ¸¡ã—ã¦ã„ã¾ã™ã€‚ã©ã¡ã‚‰ã‚‚ <code>App</code> ãŒå†ãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚Œã‚‹ãŸã³ã«æœ€åˆã‹ã‚‰ä½œæˆã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã¯æ¯å›æ–°ã—ã„å€¤ã¨è¦‹ãªã•ã‚Œã‚‹ãŸã‚ã€ãã‚ŒãŒåŸå› ã§ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒå†ãƒˆãƒªã‚¬ã•ã‚Œã¦ã—ã¾ã£ã¦ã„ã¾ã™ã€‚<p>ã“ã‚Œã‚‰ã®é–¢æ•°ã®ã†ã¡ä¸€æ–¹ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ã™ã€‚æ–°ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã«ã€Œåå¿œã€ã›ãšã«ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã§ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’å‘¼ã³å‡ºã™æ–¹æ³•ã‚’çŸ¥ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ ãã‚ŒãŒå½¹ç«‹ã¡ãã†ã§ã™ï¼<p>ã‚‚ã†ä¸€æ–¹ã®é–¢æ•°ã¯ã€ã‚ã‚‹ state ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸ API ãƒ¡ã‚½ãƒƒãƒ‰ã«æ¸¡ã™ãŸã‚ã ã‘ã«å­˜åœ¨ã—ã¾ã™ã€‚ã“ã®é–¢æ•°ã¯æœ¬å½“ã«å¿…è¦ã§ã™ã‹ï¼Ÿ æœ¬è³ªçš„ã«æ¸¡ã•ã‚Œã¦ã„ã‚‹æƒ…å ±ã¯ä½•ã§ã™ã‹ï¼Ÿ <code>App.js</code> ã‹ã‚‰ <code>ChatRoom.js</code> ã«ã„ãã¤ã‹ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ç§»å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p></hint><sandpack><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"experimental"</span><span class="token punctuation">,</span>
    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"experimental"</span><span class="token punctuation">,</span>
    <span class="token property">"react-scripts"</span><span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>
    <span class="token property">"toastify-js"</span><span class="token operator">:</span> <span class="token string">"1.12.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"react-scripts start"</span><span class="token punctuation">,</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"react-scripts build"</span><span class="token punctuation">,</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"react-scripts test --env=jsdom"</span><span class="token punctuation">,</span>
    <span class="token property">"eject"</span><span class="token operator">:</span> <span class="token string">"react-scripts eject"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ChatRoom</span></span> <span class="token keyword module">from</span> <span class="token string">'./ChatRoom.js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>
  createEncryptedConnection<span class="token punctuation">,</span>
  createUnencryptedConnection<span class="token punctuation">,</span>
<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> showNotification <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./notifications.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isDark<span class="token punctuation">,</span> setIsDark<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> setRoomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'general'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isEncrypted<span class="token punctuation">,</span> setIsEncrypted<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>input
          type<span class="token operator">=</span><span class="token string">"checkbox"</span>
          checked<span class="token operator">=</span><span class="token punctuation">{</span>isDark<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setIsDark</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">checked</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token maybe-class-name">Use</span> dark theme
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>input
          type<span class="token operator">=</span><span class="token string">"checkbox"</span>
          checked<span class="token operator">=</span><span class="token punctuation">{</span>isEncrypted<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setIsEncrypted</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">checked</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token maybe-class-name">Enable</span> encryption
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Choose</span> the chat room<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>select
          value<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setRoomId</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"general"</span><span class="token operator">></span>general<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"travel"</span><span class="token operator">></span>travel<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"music"</span><span class="token operator">></span>music<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>select<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span>
        roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
        onMessage<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">msg</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token string">'New message: '</span> <span class="token operator">+</span> msg<span class="token punctuation">,</span> isDark <span class="token operator">?</span> <span class="token string">'dark'</span> <span class="token operator">:</span> <span class="token string">'light'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span>
        createConnection<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>isEncrypted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword control-flow">return</span> <span class="token function">createEncryptedConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
            <span class="token keyword control-flow">return</span> <span class="token function">createUnencryptedConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> experimental_useEffectEvent <span class="token keyword module">as</span> useEffectEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> createConnection<span class="token punctuation">,</span> onMessage <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">onMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>createConnection<span class="token punctuation">,</span> onMessage<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Welcome</span> to the <span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> room<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createEncryptedConnection</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> serverUrl<span class="token punctuation">,</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> serverUrl <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected serverUrl to be a string. Received: '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> roomId <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected roomId to be a string. Received: '</span> <span class="token operator">+</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> intervalId<span class="token punctuation">;</span>
  <span class="token keyword">let</span> messageCallback<span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… ğŸ” Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room... (encrypted)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>messageCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">messageCallback</span><span class="token punctuation">(</span><span class="token string">'hey'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
            <span class="token function">messageCallback</span><span class="token punctuation">(</span><span class="token string">'lol'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      messageCallback <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ ğŸ” Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room (encrypted)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>messageCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Cannot add the handler twice.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event <span class="token operator">!==</span> <span class="token string">'message'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Only "message" event is supported.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      messageCallback <span class="token operator">=</span> callback<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createUnencryptedConnection</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> serverUrl<span class="token punctuation">,</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> serverUrl <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected serverUrl to be a string. Received: '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> roomId <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected roomId to be a string. Received: '</span> <span class="token operator">+</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> intervalId<span class="token punctuation">;</span>
  <span class="token keyword">let</span> messageCallback<span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room (unencrypted)...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>messageCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">messageCallback</span><span class="token punctuation">(</span><span class="token string">'hey'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
            <span class="token function">messageCallback</span><span class="token punctuation">(</span><span class="token string">'lol'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      messageCallback <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room (unencrypted)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>messageCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Cannot add the handler twice.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event <span class="token operator">!==</span> <span class="token string">'message'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Only "message" event is supported.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      messageCallback <span class="token operator">=</span> callback<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">Toastify</span></span> <span class="token keyword module">from</span> <span class="token string">'toastify-js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token string">'toastify-js/src/toastify.css'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> theme</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function"><span class="token maybe-class-name">Toastify</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">text</span><span class="token operator">:</span> message<span class="token punctuation">,</span>
    <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
    <span class="token literal-property property">gravity</span><span class="token operator">:</span> <span class="token string">'top'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">'right'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">background</span><span class="token operator">:</span> theme <span class="token operator">===</span> <span class="token string">'dark'</span> <span class="token operator">?</span> <span class="token string">'black'</span> <span class="token operator">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> theme <span class="token operator">===</span> <span class="token string">'dark'</span> <span class="token operator">?</span> <span class="token string">'white'</span> <span class="token operator">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">showToast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label<span class="token punctuation">,</span> button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><solution><p>æ­£ã—ã„è§£æ±ºæ³•ã¯è¤‡æ•°ã‚ã‚Šã¾ã™ãŒã€ã“ã“ã§ã¯å¯èƒ½ãªè§£æ±ºç­–ã®ã†ã¡ 1 ã¤ã‚’ç¤ºã—ã¾ã™ã€‚<p>å…ƒã®ä¾‹ã§ã¯ã€ãƒ†ãƒ¼ãƒã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã¨ã€ç•°ãªã‚‹ <code>onMessage</code> ã¨ <code>createConnection</code> é–¢æ•°ãŒä½œæˆã•ã‚Œã€æ¸¡ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒã“ã‚Œã‚‰ã®é–¢æ•°ã«ä¾å­˜ã—ã¦ã„ãŸãŸã‚ã€ãƒ†ãƒ¼ãƒã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ãŸã³ã«ãƒãƒ£ãƒƒãƒˆã®å†æ¥ç¶šãŒèµ·ãã¦ã„ã¾ã—ãŸã€‚<p><code>onMessage</code> ã®å•é¡Œã‚’ä¿®æ­£ã™ã‚‹ã«ã¯ã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã«ãƒ©ãƒƒãƒ—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> createConnection<span class="token punctuation">,</span> onMessage <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> onReceiveMessage <span class="token operator">=</span> <span class="token function">useEffectEvent</span><span class="token punctuation">(</span>onMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">onReceiveMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span></code></pre><p>props ã§ã‚ã‚‹ <code>onMessage</code> ã¨ã¯ç•°ãªã‚Šã€<code>onReceiveMessage</code> ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã¯ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã—ãŸãŒã£ã¦ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ä¾å­˜å€¤ã«ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã®çµæœã€<code>onMessage</code> ãŒå¤‰ã‚ã£ã¦ã‚‚ãƒãƒ£ãƒƒãƒˆã®å†æ¥ç¶šãŒå¼•ãèµ·ã“ã•ã‚Œã‚‹ã“ã¨ãŒãªããªã‚Šã¾ã™ã€‚<p><code>createConnection</code> ã¯ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§<em>ã‚ã‚‹ã¹ã</em> ã§ã™ã®ã§ã€åŒã˜ã“ã¨ã‚’ã‚„ã£ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚æš—å·åŒ–æ¥ç¶šã¨éæš—å·åŒ–æ¥ç¶šã‚’åˆ‡ã‚Šæ›¿ãˆãŸã‚Šã€ç¾åœ¨ã®ãƒ«ãƒ¼ãƒ ã‚’åˆ‡ã‚Šæ›¿ãˆãŸã‚Šã™ã‚‹å ´åˆã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒå†ãƒˆãƒªã‚¬ã•ã‚Œã‚‹ã“ã¨ã¯<em>æœ›ã¾ã—ã„ã“ã¨</em>ã§ã™ã€‚ã—ã‹ã—ã€<code>createConnection</code> ã¯é–¢æ•°ã§ã‚ã‚‹ãŸã‚ã€èª­ã¿å–ã‚Šæƒ…å ±ãŒ<em>æœ¬å½“ã«</em>å¤‰æ›´ã•ã‚ŒãŸã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€<code>App</code> ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ <code>createConnection</code> ã‚’æ¸¡ã™ä»£ã‚ã‚Šã«ã€ç”Ÿã® <code>roomId</code> ã¨ <code>isEncrypted</code> ã®å€¤ã‚’æ¸¡ã™ã‚ˆã†ã«ã—ã¾ã™ã€‚<pre class="language-js"><code class="language-js">      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span>
        roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
        isEncrypted<span class="token operator">=</span><span class="token punctuation">{</span>isEncrypted<span class="token punctuation">}</span>
        onMessage<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">msg</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token string">'New message: '</span> <span class="token operator">+</span> msg<span class="token punctuation">,</span> isDark <span class="token operator">?</span> <span class="token string">'dark'</span> <span class="token operator">:</span> <span class="token string">'light'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span></code></pre><p>ã“ã‚Œã§ã€<code>createConnection</code> é–¢æ•°ã‚’ <code>App</code> ã‹ã‚‰æ¸¡ã™ã®ã§ã¯ãªãã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®<em>å†…éƒ¨</em>ã«ç§»å‹•ã§ãã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>
  createEncryptedConnection<span class="token punctuation">,</span>
  createUnencryptedConnection<span class="token punctuation">,</span>
<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> isEncrypted<span class="token punctuation">,</span> onMessage <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> onReceiveMessage <span class="token operator">=</span> <span class="token function">useEffectEvent</span><span class="token punctuation">(</span>onMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>isEncrypted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> <span class="token function">createEncryptedConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> <span class="token function">createUnencryptedConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span></code></pre><p>ã“ã‚Œã‚‰ã®å¤‰æ›´ã®å¾Œã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã¯ã‚‚ã¯ã‚„é–¢æ•°å‹ã®å€¤ã«ä¾å­˜ã—ãªããªã‚Šã¾ã™ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> isEncrypted<span class="token punctuation">,</span> onMessage <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Reactive values</span>
  <span class="token keyword">const</span> onReceiveMessage <span class="token operator">=</span> <span class="token function">useEffectEvent</span><span class="token punctuation">(</span>onMessage<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Not reactive</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId <span class="token comment">// Reading a reactive value</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>isEncrypted<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Reading a reactive value</span>
        <span class="token keyword control-flow">return</span> <span class="token function">createEncryptedConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> <span class="token function">createUnencryptedConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">onReceiveMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> isEncrypted<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… All dependencies declared</span></code></pre><p>çµæœã¨ã—ã¦ã€ãƒãƒ£ãƒƒãƒˆã¯æ„å‘³ã®ã‚ã‚‹ã‚‚ã®ï¼ˆ<code>roomId</code> ã‚„ <code>isEncrypted</code>ï¼‰ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã«ã®ã¿å†æ¥ç¶šã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><sandpack><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"experimental"</span><span class="token punctuation">,</span>
    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"experimental"</span><span class="token punctuation">,</span>
    <span class="token property">"react-scripts"</span><span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>
    <span class="token property">"toastify-js"</span><span class="token operator">:</span> <span class="token string">"1.12.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"react-scripts start"</span><span class="token punctuation">,</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"react-scripts build"</span><span class="token punctuation">,</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"react-scripts test --env=jsdom"</span><span class="token punctuation">,</span>
    <span class="token property">"eject"</span><span class="token operator">:</span> <span class="token string">"react-scripts eject"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ChatRoom</span></span> <span class="token keyword module">from</span> <span class="token string">'./ChatRoom.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> showNotification <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./notifications.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isDark<span class="token punctuation">,</span> setIsDark<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> setRoomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'general'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isEncrypted<span class="token punctuation">,</span> setIsEncrypted<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>input
          type<span class="token operator">=</span><span class="token string">"checkbox"</span>
          checked<span class="token operator">=</span><span class="token punctuation">{</span>isDark<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setIsDark</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">checked</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token maybe-class-name">Use</span> dark theme
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>input
          type<span class="token operator">=</span><span class="token string">"checkbox"</span>
          checked<span class="token operator">=</span><span class="token punctuation">{</span>isEncrypted<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setIsEncrypted</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">checked</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token maybe-class-name">Enable</span> encryption
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Choose</span> the chat room<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>select
          value<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setRoomId</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"general"</span><span class="token operator">></span>general<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"travel"</span><span class="token operator">></span>travel<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
          <span class="token operator">&#x3C;</span>option value<span class="token operator">=</span><span class="token string">"music"</span><span class="token operator">></span>music<span class="token operator">&#x3C;</span><span class="token operator">/</span>option<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>select<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>hr <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ChatRoom</span>
        roomId<span class="token operator">=</span><span class="token punctuation">{</span>roomId<span class="token punctuation">}</span>
        isEncrypted<span class="token operator">=</span><span class="token punctuation">{</span>isEncrypted<span class="token punctuation">}</span>
        onMessage<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">msg</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token string">'New message: '</span> <span class="token operator">+</span> msg<span class="token punctuation">,</span> isDark <span class="token operator">?</span> <span class="token string">'dark'</span> <span class="token operator">:</span> <span class="token string">'light'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> experimental_useEffectEvent <span class="token keyword module">as</span> useEffectEvent <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>
  createEncryptedConnection<span class="token punctuation">,</span>
  createUnencryptedConnection<span class="token punctuation">,</span>
<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./chat.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ChatRoom</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> roomId<span class="token punctuation">,</span> isEncrypted<span class="token punctuation">,</span> onMessage <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> onReceiveMessage <span class="token operator">=</span> <span class="token function">useEffectEvent</span><span class="token punctuation">(</span>onMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">serverUrl</span><span class="token operator">:</span> <span class="token string">'https://localhost:1234'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">roomId</span><span class="token operator">:</span> roomId
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>isEncrypted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> <span class="token function">createEncryptedConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> <span class="token function">createUnencryptedConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">onReceiveMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    connection<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> connection<span class="token punctuation">.</span><span class="token method function property-access">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>roomId<span class="token punctuation">,</span> isEncrypted<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Welcome</span> to the <span class="token punctuation">{</span>roomId<span class="token punctuation">}</span> room<span class="token operator">!</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createEncryptedConnection</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> serverUrl<span class="token punctuation">,</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> serverUrl <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected serverUrl to be a string. Received: '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> roomId <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected roomId to be a string. Received: '</span> <span class="token operator">+</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> intervalId<span class="token punctuation">;</span>
  <span class="token keyword">let</span> messageCallback<span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… ğŸ” Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room... (encrypted)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>messageCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">messageCallback</span><span class="token punctuation">(</span><span class="token string">'hey'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
            <span class="token function">messageCallback</span><span class="token punctuation">(</span><span class="token string">'lol'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      messageCallback <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ ğŸ” Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room (encrypted)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>messageCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Cannot add the handler twice.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event <span class="token operator">!==</span> <span class="token string">'message'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Only "message" event is supported.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      messageCallback <span class="token operator">=</span> callback<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">createUnencryptedConnection</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> serverUrl<span class="token punctuation">,</span> roomId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A real implementation would actually connect to the server</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> serverUrl <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected serverUrl to be a string. Received: '</span> <span class="token operator">+</span> serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> roomId <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Expected roomId to be a string. Received: '</span> <span class="token operator">+</span> roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> intervalId<span class="token punctuation">;</span>
  <span class="token keyword">let</span> messageCallback<span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âœ… Connecting to "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room (unencrypted)...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>messageCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">messageCallback</span><span class="token punctuation">(</span><span class="token string">'hey'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
            <span class="token function">messageCallback</span><span class="token punctuation">(</span><span class="token string">'lol'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      messageCallback <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'âŒ Disconnected from "'</span> <span class="token operator">+</span> roomId <span class="token operator">+</span> <span class="token string">'" room (unencrypted)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>messageCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Cannot add the handler twice.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>event <span class="token operator">!==</span> <span class="token string">'message'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">throw</span> <span class="token known-class-name class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Only "message" event is supported.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      messageCallback <span class="token operator">=</span> callback<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">Toastify</span></span> <span class="token keyword module">from</span> <span class="token string">'toastify-js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token string">'toastify-js/src/toastify.css'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">showNotification</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> theme</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function"><span class="token maybe-class-name">Toastify</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">text</span><span class="token operator">:</span> message<span class="token punctuation">,</span>
    <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
    <span class="token literal-property property">gravity</span><span class="token operator">:</span> <span class="token string">'top'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">'right'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">background</span><span class="token operator">:</span> theme <span class="token operator">===</span> <span class="token string">'dark'</span> <span class="token operator">?</span> <span class="token string">'black'</span> <span class="token operator">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> theme <span class="token operator">===</span> <span class="token string">'dark'</span> <span class="token operator">?</span> <span class="token string">'white'</span> <span class="token operator">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">showToast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label<span class="token punctuation">,</span> button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack></solution><span style="float:footnote"><a href="../index.html#toc">Go to TOC</a></span></section></section></section></section>