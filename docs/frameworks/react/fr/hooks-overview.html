<!doctype html><html lang="fr"><meta charset="utf-8"><title>AperÃ§u des Hooks</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="aperÃ§u-des-hooks"class="level1"><h1>AperÃ§u des Hooks</h1><p>Les <em>Hooks</em> sont une nouveautÃ© de React 16.8. Ils permettent de bÃ©nÃ©ficier dâ€™un Ã©tat local et d'autres fonctionnalitÃ©s de React sans avoir Ã  Ã©crire de classes.<p>Les Hooks sont <a href="./hooks-intro.html#no-breaking-changes">rÃ©tro-compatibles</a>. Cette page fournit un survol des Hooks pour les utilisateurs expÃ©rimentÃ©s de React. C'est un tour dâ€™horizon rapide. Si vous trouvez le contenu dÃ©routant, cherchez un panneau jaune comme celui-ci :<blockquote><p>Explication dÃ©taillÃ©e<p>Lisez les <a href="./hooks-intro.html#motivation">raisons</a> qui nous ont fait ajouter les Hooks Ã  React.</blockquote><p><strong>â†‘â†‘â†‘ Chaque section se termine par un panneau jaune comme celui ci.</strong> Ils pointent vers une documentation dÃ©taillÃ©e.<section id="state-hook"class="level2"><h2>ğŸ“Œ Hook dâ€™Ã©tat</h2><p>Cet exemple affiche un compteur. Quand vous cliquez sur le bouton, la valeur augmente :<pre class="language-js{1,4,5}"><code class="language-js{1,4,5}">import React, { useState } from 'react';

function Example() {
  // DÃ©claration d'une nouvelle variable d'Ã©tat, que l'on appellera â€œcountâ€
  const [count, setCount] = useState(0);

  return (
    &#x3C;div>
      &#x3C;p>Vous avez cliquÃ© {count} fois&#x3C;/p>
      &#x3C;button onClick={() => setCount(count + 1)}>
        Cliquez ici
      &#x3C;/button>
    &#x3C;/div>
  );
}</code></pre><p>Dans le code ci-dessus, <code>useState</code> est un <em>Hook</em> (nous verrons ce que Ã§a veut dire dans un instant). Nous l'appelons au sein dâ€™une fonction composant pour y ajouter un Ã©tat local. React va prÃ©server cet Ã©tat dâ€™un affichage Ã  lâ€™autre. <code>useState</code> retourne une paireÂ : la valeur de l'Ã©tat <em>actuel</em> et une fonction qui vous permet de la mettre Ã  jour. Vous pouvez appeler cette fonction depuis un gestionnaire d'Ã©vÃ©nements, par exemple. Elle est similaire Ã  <code>this.setState</code> dans une classe, Ã  ceci prÃ¨s quâ€™elle ne fusionne pas l'ancien Ã©tat et le nouveau. (Nous verrons un exemple de comparaison entre <code>useState</code> et <code>this.state</code> dans <a href="./hooks-state.html">Utiliser le Hook d'Ã©tat</a>.)<p>Le seul argument de <code>useState</code> est l'Ã©tat initial. Dans l'exemple prÃ©cÃ©dent, c'est <code>0</code> puisque notre compteur dÃ©marre Ã  zÃ©ro. Remarquez que contrairement Ã  <code>this.state</code>, ici l'Ã©tat n'est pas nÃ©cessairement un objet, mÃªme si Ã§a reste possible. L'argument d'Ã©tat initial nâ€™est utilisÃ© que pour le premier affichage.<section id="declaring-multiple-state-variables"class="level4"><h4>DÃ©clarer plusieurs variables dâ€™Ã©tat</h4><p>Vous pouvez utiliser le Hook d'Ã©tat plus d'une fois dans un seul composant :<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ExampleWithManyStates</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// DÃ©claration de multiples variables d'Ã©tat !</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>fruit<span class="token punctuation">,</span> setFruit<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'banane'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'Apprendre les Hooks'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>La syntaxe de la <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Op%C3%A9rateurs/Affecter_par_d%C3%A9composition#D%C3%A9composition_d&#x27;un_tableau">dÃ©structuration positionnelle</a> nous permet de donner des noms distincts aux variables d'Ã©tat que nous dÃ©clarons en appelant <code>useState</code>. Ces noms ne font pas partie de l'API <code>useState</code>. Au lieu de Ã§a, React suppose que si vous appelez <code>useState</code> plusieurs fois, vous le faites dans le mÃªme ordre Ã  chaque affichage. Nous reviendrons plus tard sur ce qui fait que Ã§a fonctionne et les situations oÃ¹ c'est utile.</section><section id="but-what-is-a-hook"class="level4"><h4>Mais qu'est ce qu'un Hook ?</h4><p>Les Hooks sont des fonctions qui permettent de Â«Â se brancherÂ Â» sur la gestion dâ€™Ã©tat local et de cycle de vie de React depuis des fonctions composants. Les Hooks ne fonctionnent pas dans des classesÂ : ils vous permettent d'utiliser React sans classes. (Nous <a href="./hooks-intro.html#gradual-adoption-strategy">ne recommandons pas</a> de rÃ©-Ã©crire vos composants existants du jour au lendemain, mais vous pouvez si vous le souhaitez commencer Ã  utiliser les Hooks dans vos nouveaux composants.)<p>React fournit quelques Hooks prÃ©dÃ©finis comme <code>useState</code>. Vous pouvez aussi crÃ©er vos propres Hooks pour rÃ©utiliser un comportement Ã  Ã©tat dans diffÃ©rents composants. Dans un premier temps, nous allons aborder les Hooks prÃ©dÃ©finis.<blockquote><p>Explication dÃ©taillÃ©e<p>Vous pouvez en apprendre davantage sur le Hook d'Ã©tat sur la page dÃ©diÃ©e : <a href="./hooks-state.html">Utiliser le Hook d'Ã©tat</a>.</blockquote></section></section><section id="effect-hook"class="level2"><h2>âš¡ï¸ Hook dâ€™effet</h2><p>Vous avez surement dÃ©jÃ  rÃ©alisÃ© un chargement de donnÃ©es distantes, des abonnements ou des modifications manuelles sur le DOM depuis un composant React. Nous appelons ces opÃ©rations Â« effets de bordÂ Â» (ou effets pour faire court) parce qu'elles peuvent affecter d'autres composants et ne peuvent Ãªtre rÃ©alisÃ©es pendant l'affichage.<p>Le Hook d'effet, <code>useEffect</code>, permet aux fonctions composants de gÃ©rer des effets de bord. Il joue le mÃªme rÃ´le que <code>componentDidMount</code>, <code>componentDidUpdate</code>, et <code>componentWillUnmount</code> dans les classes React, mais au travers dâ€™une API unique. (Nous verrons des exemples comparant <code>useEffect</code> Ã  ces mÃ©thodes dans <a href="./hooks-effect.html">Utiliser le Hook d'effet </a>.)<p>Par exemple, ce composant change le titre du document aprÃ¨s que React a mis Ã  jour le DOMÂ :<pre class="language-js{1,6-10}"><code class="language-js{1,6-10}">import React, { useState, useEffect } from 'react';

function Example() {
  const [count, setCount] = useState(0);

  // Ã‰quivalent Ã  componentDidMount plus componentDidUpdateÂ :
  useEffect(() => {
    // Mettre Ã  jour le titre du document en utilisant l'API du navigateur
    document.title = `Vous avez cliquÃ© ${count} fois`;
  });

  return (
    &#x3C;div>
      &#x3C;p>Vous avez cliquÃ© {count} fois&#x3C;/p>
      &#x3C;button onClick={() => setCount(count + 1)}>
        Cliquez ici
      &#x3C;/button>
    &#x3C;/div>
  );
}</code></pre><p>Lorsque vous appelez <code>useEffect</code>, vous dites Ã  React de lancer votre fonction d'Â« effet Â» aprÃ¨s quâ€™il a mis Ã  jour le DOM. Les effets Ã©tant dÃ©clarÃ©s au sein du composant, ils ont accÃ¨s Ã  ses props et son Ã©tat. Par dÃ©faut, React exÃ©cute les effets aprÃ¨s chaque affichage, <em>yÂ compris</em> le premier. (Nous aborderons plus en dÃ©tails la comparaison avec le cycle de vie des classes dans <a href="./hooks-effect.html">Utiliser le Hook d'effet</a>.)<p>Les effets peuvent aussi prÃ©ciser comment les Â« nettoyer Â» en renvoyant une fonction. Par exemple, ce composant utilise un effet pour sâ€™abonner au statut de connexion d'un ami, et se nettoie en rÃ©siliant lâ€™abonnementÂ :<pre class="language-js{10-16}"><code class="language-js{10-16}">import React, { useState, useEffect } from 'react';

function FriendStatus(props) {
  const [isOnline, setIsOnline] = useState(null);

  function handleStatusChange(status) {
    setIsOnline(status.isOnline);
  }

  useEffect(() => {
    ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);

    return () => {
      ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);
    };
  });

  if (isOnline === null) {
    return 'Chargement...';
  }
  return isOnline ? 'En ligne' : 'Hors-ligne';
}</code></pre><p>Dans cet exemple, React nous dÃ©sabonnerait de notre <code>ChatAPI</code> quand le composant est dÃ©montÃ©, mais aussi juste avant de relancer lâ€™effet suite Ã  un nouvel affichage. (Le cas Ã©chÃ©ant, vous pouvez <a href="./hooks-effect.html#tip-optimizing-performance-by-skipping-effects">dire Ã  React de sauter le rÃ©-abonnement</a> si la <code>props.friend.id</code> passÃ©e Ã  <code>ChatAPI</code> n'a pas changÃ©.)<p>Tout comme avec <code>useState</code>, vous pouvez utiliser plus d'un seul effet dans un composant :<pre class="language-js{3,8}"><code class="language-js{3,8}">function FriendStatusWithCounter(props) {
  const [count, setCount] = useState(0);
  useEffect(() => {
    document.title = `Vous avez cliquÃ© ${count} fois`;
  });

  const [isOnline, setIsOnline] = useState(null);
  useEffect(() => {
    ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);
    return () => {
      ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);
    };
  });

  function handleStatusChange(status) {
    setIsOnline(status.isOnline);
  }
  // ...</code></pre><p>Les Hooks vous permettent d'organiser les effets de bord dans un composant en rassemblant leurs parties (telles que lâ€™abonnement et le dÃ©sabonnement), plutÃ´t que de vous forcer Ã  les rÃ©partir dans les mÃ©thodes de cycle de vie.<blockquote><p>Explication dÃ©taillÃ©e<p>Vous pouvez en apprendre davantage sur <code>useEffect</code> sur la page dÃ©diÃ©e : <a href="./hooks-effect.html">Utiliser le Hook dâ€™effet</a>.</blockquote></section><section id="rules-of-hooks"class="level2"><h2>âœŒï¸ RÃ¨gles des Hooks</h2><p>Les Hooks sont des fonctions JavaScript, mais ils imposent deux rÃ¨gles supplÃ©mentaires :<ul><li>Appelez les Hooks uniquement <strong>au niveau racine</strong>. N'appelez pas de Hooks Ã  l'intÃ©rieur de boucles, de code conditionnel ou de fonctions imbriquÃ©es.<li>Appelez les Hooks uniquement <strong>depuis des fonctions composants React</strong>. N'appelez pas les Hooks depuis des fonctions JavaScript classiques. (Il n'y a qu'un seul autre endroit oÃ¹ vous pouvez appeler des HooksÂ : vos propres Hook personnalisÃ©s. Nous en reparlerons dans un moment.)</ul><p>Nous fournissons un <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks">plugin ESLint</a> qui assure le respect de ces deux rÃ¨gles. Nous comprenons que ces rÃ¨gles peuvent sembler limitantes ou dÃ©routantes au premier abord, mais elles sont essentielles pour que les Hooks fonctionnent correctement.<blockquote><p>Explication dÃ©taillÃ©e<p>Vous pouvez en apprendre davantage sur ces rÃ¨gles sur la page dÃ©diÃ©e : <a href="./hooks-rules.html">RÃ¨gles des Hooks</a>.</blockquote></section><section id="building-your-own-hooks"class="level2"><h2>ğŸ’¡ Construire vos propres Hooks</h2><p>Parfois, on veut rÃ©utiliser la mÃªme logique Ã  Ã©tat dans plusieurs composants. Traditionnellement, on avait deux solutions rÃ©pandues Ã  ce besoinÂ : les <a href="./higher-order-components.html">composants d'ordre supÃ©rieur</a> et les <a href="./render-props.html">props de rendu</a>. Les Hooks personnalisÃ©s vous permettent de faire la mÃªme chose, mais sans ajouter de composants Ã  votre arbre.<p>Un peu plus tÃ´t sur cette page, nous avons prÃ©sentÃ© un composant <code>FriendStatus</code> qui appelle les Hooks <code>useState</code> et <code>useEffect</code> pour sâ€˜abonner Ã  l'Ã©tat de connexion d'un ami. Disons que l'on veut rÃ©utiliser cette logique dâ€™abonnement dans un autre composant.<p>Tout d'abord, nous allons extraire cette logique dans un Hook personnalisÃ© appelÃ© <code>useFriendStatus</code> :<pre class="language-js{3}"><code class="language-js{3}">import React, { useState, useEffect } from 'react';

function useFriendStatus(friendID) {
  const [isOnline, setIsOnline] = useState(null);

  function handleStatusChange(status) {
    setIsOnline(status.isOnline);
  }

  useEffect(() => {
    ChatAPI.subscribeToFriendStatus(friendID, handleStatusChange);
    return () => {
      ChatAPI.unsubscribeFromFriendStatus(friendID, handleStatusChange);
    };
  });

  return isOnline;
}</code></pre><p>Il prend <code>friendID</code> comme argument, et renvoie l'Ã©tat de connexion de notre ami.<p>Nous pouvons dÃ©sormais l'utiliser dans les deux composants :<pre class="language-js{2}"><code class="language-js{2}">function FriendStatus(props) {
  const isOnline = useFriendStatus(props.friend.id);

  if (isOnline === null) {
    return 'Chargement...';
  }
  return isOnline ? 'En ligne' : 'Hors-ligne';
}</code></pre><pre class="language-js{2}"><code class="language-js{2}">function FriendListItem(props) {
  const isOnline = useFriendStatus(props.friend.id);

  return (
    &#x3C;li style={{ color: isOnline ? 'green' : 'black' }}>
      {props.friend.name}
    &#x3C;/li>
  );
}</code></pre><p>Les Ã©tats locaux de chaque composant sont complÃ¨tement indÃ©pendants. Les Hooks permettent de rÃ©utiliser la <em>logique Ã  Ã©tat</em>, et non l'Ã©tat lui-mÃªme. En fait, chaque <em>appel</em> Ã  un Hook a un Ã©tat complÃ¨tement isolÃ©Â ; vous pouvez mÃªme utiliser deux fois le mÃªme Hook personnalisÃ© dans un mÃªme composant.<p>Les Hooks personnalisÃ©s sont plus une convention qu'une fonctionnalitÃ©. Si le nom d'une fonction commence par <code>use</code> et qu'elle appelle un autre Hook, nous dirons que câ€™est un Hook personnalisÃ©. La convention de nommage <code>useSomething</code> permet Ã  notre plugin ESLint de dÃ©tecter les bugs dans un code utilisant les Hooks.<p>Vous pouvez Ã©crire des Hooks personnalisÃ©s pour gÃ©rer un large Ã©ventail de cas d'usage tels que la gestion des formulaires, les animations, les abonnements dÃ©claratifs, les horloges et probablement de nombreux autres auxquels nous n'avons pas pensÃ©. Nous avons hÃ¢te de voir quels Hooks personnalisÃ©s la communautÃ© React va inventer.<blockquote><p>Explication dÃ©taillÃ©e<p>Vous pouvez en apprendre davantage sur les Hooks personnalisÃ©s sur une page dÃ©diÃ©e : <a href="./hooks-custom.html">Construire vos propres Hooks</a>.</blockquote></section><section id="other-hooks"class="level2"><h2>ğŸ”Œ Autres Hooks</h2><p>Il y a quelques Hooks prÃ©dÃ©finis plus rarement utilisÃ©s qui pourraient vous intÃ©resser. Par exemple, <a href="./hooks-reference.html#usecontext"><code>useContext</code></a> vous permet dâ€™utiliser les Contextes de React sans imbrication superflueÂ :<pre class="language-js{2,3}"><code class="language-js{2,3}">function Example() {
  const locale = useContext(LocaleContext);
  const theme = useContext(ThemeContext);
  // ...
}</code></pre><p>Et <a href="./hooks-reference.html#usereducer"><code>useReducer</code></a> vous permet de gÃ©rer l'Ã©tat local de composants complexes avec un rÃ©ducteur :<pre class="language-js{2}"><code class="language-js{2}">function Todos() {
  const [todos, dispatch] = useReducer(todosReducer);
  // ...</code></pre><blockquote><p>Explication dÃ©taillÃ©e<p>Vous pouvez en apprendre davantage sur les Hooks prÃ©dÃ©finis sur une page dÃ©diÃ©e : <a href="./hooks-reference.html">RÃ©fÃ©rence de l'API des Hooks</a>.</blockquote></section><section id="next-steps"class="level2"><h2>Prochaines Ã©tapes</h2><p>Eh bien, câ€™Ã©tait rapideÂ ! Si quelque chose nâ€™Ã©tait pas clair ou que vous souhaitez en savoir plus, vous pouvez consulter les prochaines pages, en dÃ©butant avec la documentation du <a href="./hooks-state.html">Hook d'Ã©tat</a>.<p>Vous pouvez aussi consulter la <a href="./hooks-reference.html">rÃ©fÃ©rence de l'API des Hooks</a> et la <a href="./hooks-faq.html">FAQ des Hooks</a>.<p>Pour finir, pensez Ã  lire <a href="./hooks-intro.html">lâ€™introduction aux Hooks</a>, qui explique <em>pourquoi</em> nous avons ajoutÃ© les Hooks et comment nous allons commencer Ã  les utiliser en parallÃ¨le des classesâ€”sans rÃ©-Ã©crire nos applis. <span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section>