<!doctypehtml><html lang="pl"><meta charset="utf-8"><title>Zasady korzystania z hookÃ³w</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../../../docs/themes/packages/prism-coy-theme/theme_common.css"><section id="zasady-korzystania-z-hookÃ³w"class="level1"><h1>Zasady korzystania z hookÃ³w</h1><p><em>Hooki</em> sÄ… nowym dodatkiem w Reakcie 16.8. PozwalajÄ… one uÅ¼ywaÄ‡ stanu i innych funkcjonalnoÅ›ci Reacta, bez uÅ¼ycia klas.<p>Hooki sÄ… javascriptowymi funkcjami, ale podczas korzystania z nich musisz pamiÄ™taÄ‡ o dwÃ³ch waÅ¼nych zasadach. StworzyliÅ›my <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks">wtyczkÄ™ do lintera</a>, ktÃ³ra automatycznie wymusza stosowanie tych zasad:<section id="only-call-hooks-at-the-top-level"class="level3"><h3>WywoÅ‚uj hooki tylko z najwyÅ¼szego poziomu kodu</h3><p><strong>Nie wywoÅ‚uj hookÃ³w wewnÄ…trz pÄ™tli, instrukcji warunkowych czy zagnieÅ¼dÅ¼onych funkcji.</strong> Korzystaj z hookÃ³w tylko z najwyÅ¼szego poziomu kodu twoich komponentÃ³w funkcyjnych, jeszcze przed zwrÃ³ceniem wartoÅ›ci. PrzestrzegajÄ…c tej zasady, zyskujesz pewnoÅ›Ä‡, Å¼e hooki zostanÄ… wywoÅ‚ane w tej samej kolejnoÅ›ci, za kaÅ¼dym razem gdy komponent jest renderowany. To wÅ‚aÅ›nie pozwala Reactowi na wÅ‚aÅ›ciwe przechowywanie stanu pomiÄ™dzy kolejnymi wywoÅ‚aniami <code>useState</code> i <code>useEffect</code> (JeÅ›li ciekawi ciÄ™ ten temat, dogÅ‚Ä™bnie wyjaÅ›nimy go <a href="#explanation">w kolejnym podrozdziale</a>.)</section><section id="only-call-hooks-from-react-functions"class="level3"><h3>WywoÅ‚uj hooki tylko w komponentach funkcyjnych</h3><p><strong>Nie wywoÅ‚uj hookÃ³w wewnÄ…trz zwykÅ‚ych javascriptowych funkcji.</strong> Zamiast tego moÅ¼esz:<ul><li>âœ… WywoÅ‚ywaÄ‡ hooki wewnÄ…trz reactowych komponentÃ³w funkcyjnych.<li>âœ… WywoÅ‚ywaÄ‡ hooki wewnÄ…trz wÅ‚asnych hookÃ³w (wiÄ™cej na ten temat dowiemy siÄ™ <a href="./hooks-custom.html">w nastÄ™pnym rozdziale</a>).</ul><p>PrzestrzegajÄ…c tej zasady, upewniasz siÄ™, Å¼e caÅ‚a logika zwiÄ…zana ze stanem komponentu jest wyraÅºnie widoczna w jego kodzie ÅºrÃ³dÅ‚owym.</section><section id="eslint-plugin"class="level2"><h2>Wtyczka dla ESLinta</h2><p>WydaliÅ›my wtyczkÄ™ dla ESLinta o nazwie <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks"><code>eslint-plugin-react-hooks</code></a>, ktÃ³ra wymusza stosowanie tych dwÃ³ch zasad. JeÅ›li chcesz jÄ… wyprÃ³bowaÄ‡, moÅ¼esz dodaÄ‡ jÄ… do swojego projektu w nastÄ™pujÄ…cy sposÃ³b:<p>Wtyczka ta jest instalowana domyÅ›lnie w <a href="./create-a-new-react-app.html#create-react-app">Create React App</a>.<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> eslint-plugin-react-hooks --save-dev</code></pre><pre class="language-js"><code class="language-js"><span class="token comment">// Twoja konfiguracja ESLint</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// ...</span>
    <span class="token string">"react-hooks"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token string-property property">"react-hooks/rules-of-hooks"</span><span class="token operator">:</span> <span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token comment">// Sprawdza stosowanie zasad hookÃ³w</span>
    <span class="token string-property property">"react-hooks/exhaustive-deps"</span><span class="token operator">:</span> <span class="token string">"warn"</span> <span class="token comment">// Sprawdza zaleÅ¼noÅ›ci efektÃ³w</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p><strong>MoÅ¼esz teraz przejÅ›Ä‡ do nastÄ™pnego rozdziaÅ‚u, gdzie wyjaÅ›niamy, <a href="./hooks-custom.html">jak pisaÄ‡ wÅ‚asne hooki</a>.</strong> W tym rozdziale postaramy siÄ™ uzasadniÄ‡, dlaczego narzucamy takie zasady.</section><section id="explanation"class="level2"><h2>WyjaÅ›nienie</h2><p>Jak <a href="./hooks-state.html#tip-using-multiple-state-variables">dowiedzieliÅ›my siÄ™ wczeÅ›niej</a>, w ramach pojedynczego komponentu moÅ¼emy uÅ¼ywaÄ‡ wielu hookÃ³w stanu i efektÃ³w:<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. UÅ¼yj zmiennej stanu do przechowania imienia</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Mary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 2. UÅ¼yj efektu, aby zapisaÄ‡ dane formularza</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">persistForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">setItem</span><span class="token punctuation">(</span><span class="token string">'formData'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 3. UÅ¼yj zmiennej stanu do przechowania nazwiska</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>surname<span class="token punctuation">,</span> setSurname<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Poppins'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 4. UÅ¼yj efektu, aby zaktualizowaÄ‡ tytuÅ‚ strony</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">updateTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">title</span> <span class="token operator">=</span> name <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> surname<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre><p>SkÄ…d zatem React wie, jakÄ… wartoÅ›Ä‡ stanu zwrÃ³ciÄ‡ przy kolejnych wywoÅ‚aniach funkcji <code>useState</code>? Tajemnica tkwi w tym, Å¼e <strong>React polega na kolejnoÅ›ci, w jakiej hooki sÄ… wywoÅ‚ywane.</strong> Nasz przykÅ‚ad zadziaÅ‚a, poniewaÅ¼ kolejnoÅ›Ä‡ wywoÅ‚ywania hookÃ³w jest taka sama przy kaÅ¼dym renderowaniu:<pre class="language-js"><code class="language-js"><span class="token comment">// ---------</span>
<span class="token comment">// Pierwsze renderowanie</span>
<span class="token comment">// ---------</span>
<span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Mary'</span><span class="token punctuation">)</span>           <span class="token comment">// 1. Zainicjalizuj zmiennÄ… stanu imienia wartoÅ›ciÄ… â€Maryâ€</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span>persistForm<span class="token punctuation">)</span>     <span class="token comment">// 2. Dodaj efekt odpowiedzialny za przechowywanie danych formularza</span>
<span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Poppins'</span><span class="token punctuation">)</span>        <span class="token comment">// 3. Zainicjalizuj zmiennÄ… stanu nazwiska wartoÅ›ciÄ… â€Poppinsâ€</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span>updateTitle<span class="token punctuation">)</span>     <span class="token comment">// 4. Dodaj efekt odpowiedzialny za aktualizacjÄ™ tytuÅ‚u</span>

<span class="token comment">// ----------</span>
<span class="token comment">// Drugie renderowanie</span>
<span class="token comment">// ----------</span>
<span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Mary'</span><span class="token punctuation">)</span>           <span class="token comment">// 1. Odczytaj zmiennÄ… stanu przechowujÄ…cÄ… imiÄ™ (argument zostaÅ‚ zignorowany)</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span>persistForm<span class="token punctuation">)</span>     <span class="token comment">// 2. ZastÄ…p efekt odpowiedzialny za przechowywanie danych</span>
<span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Poppins'</span><span class="token punctuation">)</span>        <span class="token comment">// 3. Odczytaj zmiennÄ… stanu przechowujÄ…cÄ… nazwisko (argument zostaÅ‚ zignorowany)</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span>updateTitle<span class="token punctuation">)</span>     <span class="token comment">// 4. ZastÄ…p efekt odpowiedzialny za aktualizacjÄ™ tytuÅ‚u</span>

<span class="token comment">// ...</span></code></pre><p>Tak dÅ‚ugo, jak kolejnoÅ›Ä‡ wywoÅ‚ywania hookÃ³w pozostaje taka sama pomiÄ™dzy kolejnymi renderowaniami, React moÅ¼e powiÄ…zaÄ‡ lokalny stan z kaÅ¼dym z nich. A co wydarzy siÄ™, jeÅ›li umieÅ›cimy wywoÅ‚anie hooka (na przykÅ‚ad efektu <code>persistForm</code>) wewnÄ…trz instrukcji warunkowej?<pre class="language-js"><code class="language-js">  <span class="token comment">// ğŸ”´ Åamiemy pierwszÄ… zasadÄ™, uÅ¼ywajÄ…c hooka wewnÄ…trz instrukcji warunkowej</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>name <span class="token operator">!==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">persistForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">setItem</span><span class="token punctuation">(</span><span class="token string">'formData'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span></code></pre><p>Warunek <code>name !== ''</code> jest speÅ‚niony przy pierwszym renderze, wiÄ™c uruchamiany jest ten hook. JednakÅ¼e przy kolejnym renderze uÅ¼ytkownik moÅ¼e wyczyÅ›ciÄ‡ wartoÅ›ci formularza, powodujÄ…c, Å¼e warunek nie bÄ™dzie speÅ‚niony. Teraz, w zwiÄ…zku z tym, Å¼e pominÄ™liÅ›my hook podczas renderowania, kolejnoÅ›Ä‡ wywoÅ‚ywania hookÃ³w zostaje zachwiana:<pre class="language-js"><code class="language-js"><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Mary'</span><span class="token punctuation">)</span>           <span class="token comment">// 1.Odczytaj zmiennÄ… stanu przechowujÄ…cÄ… imiÄ™ (argument zostaÅ‚ zignorowany)</span>
<span class="token comment">// useEffect(persistForm)  // ğŸ”´ Ten hook zostaÅ‚ pominiÄ™ty!</span>
<span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Poppins'</span><span class="token punctuation">)</span>        <span class="token comment">// ğŸ”´ 2 (a byÅ‚ 3). Nie uda siÄ™ odczytaÄ‡ zmiennej stanu</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span>updateTitle<span class="token punctuation">)</span>     <span class="token comment">// ğŸ”´ 3 (a byÅ‚ 4). Nie uda siÄ™ zastÄ…piÄ‡ efektu</span></code></pre><p>React nie wiedziaÅ‚by, co zwrÃ³ciÄ‡ dla drugiego wywoÅ‚ania hooka <code>useState</code>. React spodziewaÅ‚ siÄ™, Å¼e drugie wywoÅ‚anie hooka w tym komponencie bÄ™dzie odpowiadaÅ‚o wywoÅ‚aniu efektu <code>persistForm</code>, tak jak podczas poprzedniego renderowania. Nie jest to juÅ¼ jednak prawdÄ…. Od tej chwili kaÅ¼de kolejne wywoÅ‚anie hooka, po tym, jak jeden zostaÅ‚ pominiÄ™ty, rÃ³wnieÅ¼ przesunÄ™Å‚oby siÄ™ o jeden, prowadzÄ…c do bÅ‚Ä™dÃ³w.<p><strong>Dlatego wÅ‚aÅ›nie hooki muszÄ… byÄ‡ wywoÅ‚ywane z najwyÅ¼szego poziomu kodu komponentÃ³w.</strong> JeÅ›li chcesz, Å¼eby efekt dziaÅ‚aÅ‚ pod jakimÅ› warunkiem, moÅ¼esz umieÅ›ciÄ‡ ten warunek <em>wewnÄ…trz</em> hooka:<pre class="language-js"><code class="language-js">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">persistForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ğŸ‘ Tym razem nie Å‚amiemy pierwszej zasady</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>name <span class="token operator">!==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token dom variable">localStorage</span><span class="token punctuation">.</span><span class="token method function property-access">setItem</span><span class="token punctuation">(</span><span class="token string">'formData'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><strong>ZauwaÅ¼, Å¼e nie musisz o tym pamiÄ™taÄ‡, jeÅ›li uÅ¼yjesz <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks">dostarczonej przez nas reguÅ‚y lintera</a>.</strong> Teraz jednak wiesz takÅ¼e, <em>dlaczego</em> hooki dziaÅ‚ajÄ… w ten sposÃ³b i jakim problemom zapobiega stosowanie tej reguÅ‚y.</section><section id="next-steps"class="level2"><h2>Kolejne kroki</h2><p>W koÅ„cu jesteÅ›my gotowi na to, aby nauczyÄ‡ siÄ™ <a href="./hooks-custom.html">pisaÄ‡ wÅ‚asne hooki</a>! WÅ‚asne hooki pozwalajÄ… Å‚Ä…czyÄ‡ hooki dostarczone przez Reacta we wÅ‚asne abstrakcje i wspÃ³Å‚dzieliÄ‡ logikÄ™ zwiÄ…zanÄ… ze stanem pomiÄ™dzy komponentami. <span style="float:footnote"><a href="./index.html#toc">Go to TOC</a></span></section></section>