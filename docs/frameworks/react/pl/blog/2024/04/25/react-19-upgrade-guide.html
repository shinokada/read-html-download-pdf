<!doctype html><html lang="pl"><meta charset="utf-8"><title>"React 19 RC Upgrade Guide"</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"type="text/css"href="../../../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="react-19-rc-upgrade-guide"><h1 id="react-19-rc-upgrade-guide">"React 19 RC Upgrade Guide"</h1><p>author: Ricky Hanlon date: 2024/04/25 description: The improvements added to React 19 require some breaking changes, but we've worked to make the upgrade as smooth as possible and we don't expect the changes to impact most apps. In this post, we will guide you through the steps for upgrading apps and libraries to React 19.<p>April 25, 2024 by <a href="https://twitter.com/rickhanlonii">Ricky Hanlon</a></p><intro><p>The improvements added to React 19 RC require some breaking changes, but we've worked to make the upgrade as smooth as possible, and we don't expect the changes to impact most apps.</p></intro><note><section class="level4"aria-labelledby="react-183-has-also-been-published-react-18-3"><h4 id="react-183-has-also-been-published-react-18-3">React 18.3 has also been published {/<em>react-18-3</em>/}</h4><p>To help make the upgrade to React 19 easier, we've published a <code>react@18.3</code> release that is identical to 18.2 but adds warnings for deprecated APIs and other changes that are needed for React 19.<p>We recommend upgrading to React 18.3 first to help identify any issues before upgrading to React 19.<p>For a list of changes in 18.3 see the <a href="https://github.com/facebook/react/blob/main/CHANGELOG.md">Release Notes</a>.</section></note><p>In this post, we will guide you through the steps for upgrading to React 19:<ul><li><a href="#installing">Installing</a><li><a href="#codemods">Codemods</a><li><a href="#breaking-changes">Breaking changes</a><li><a href="#new-deprecations">New deprecations</a><li><a href="#notable-changes">Notable changes</a><li><a href="#typescript-changes">TypeScript changes</a><li><a href="#changelog">Changelog</a></ul><p>If you'd like to help us test React 19, follow the steps in this upgrade guide and <a href="https://github.com/facebook/react/issues/new?assignees=&#x26;labels=React+19&#x26;projects=&#x26;template=19.md&#x26;title=%5BReact+19%5D">report any issues</a> you encounter. For a list of new features added to React 19, see the <a href="/blog/2024/04/25/react-19">React 19 release post</a>.<section class="level2"aria-labelledby="installing-installing"><h2 id="installing-installing">Installing {/<em>installing</em>/}</h2><note><section class="level4"aria-labelledby="new-jsx-transform-is-now-required-new-jsx-transform-is-now-required"><h4 id="new-jsx-transform-is-now-required-new-jsx-transform-is-now-required">New JSX Transform is now required {/<em>new-jsx-transform-is-now-required</em>/}</h4><p>We introduced a <a href="https://legacy.reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html">new JSX transform</a> in 2020 to improve bundle size and use JSX without importing React. In React 19, we're adding additional improvements like using ref as a prop and JSX speed improvements that require the new transform.<p>If the new transform is not enabled, you will see this warning:</p><consoleblockmulti><consolelogline level="error"><p>Your app (or one of its dependencies) is using an outdated JSX transform. Update to the modern JSX transform for faster performance: <a href="https://react.dev/link/new-jsx-transform">https://react.dev/link/new-jsx-transform</a></p></consolelogline></consoleblockmulti><p>We expect most apps will not be affected since the transform is enabled in most environments already. For manual instructions on how to upgrade, please see the <a href="https://legacy.reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html">announcement post</a>.</section></note><p>To install the latest version of React and React DOM:<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-exact react@rc react-dom@rc</code></pre><p>Or, if you're using Yarn:<pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> --exact react@rc react-dom@rc</code></pre><p>If you're using TypeScript, you also need to update the types. Once React 19 is released as stable, you can install the types as usual from <code>@types/react</code> and <code>@types/react-dom</code>. Until the stable release, the types are available in different packages which need to be enforced in your <code>package.json</code>:<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"@types/react"</span><span class="token operator">:</span> <span class="token string">"npm:types-react@rc"</span><span class="token punctuation">,</span>
    <span class="token property">"@types/react-dom"</span><span class="token operator">:</span> <span class="token string">"npm:types-react-dom@rc"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"overrides"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"@types/react"</span><span class="token operator">:</span> <span class="token string">"npm:types-react@rc"</span><span class="token punctuation">,</span>
    <span class="token property">"@types/react-dom"</span><span class="token operator">:</span> <span class="token string">"npm:types-react-dom@rc"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>We're also including a codemod for the most common replacements. See <a href="#typescript-changes">TypeScript changes</a> below.</section><section class="level2"aria-labelledby="codemods-codemods"><h2 id="codemods-codemods">Codemods {/<em>codemods</em>/}</h2><p>To help with the upgrade, we've worked with the team at <a href="https://codemod.com">codemod.com</a> to publish codemods that will automatically update your code to many of the new APIs and patterns in React 19.<p>All codemods are available in the <a href="https://github.com/reactjs/react-codemod"><code>react-codemod</code> repo</a> and the Codemod team have joined in helping maintain the codemods. To run these codemods, we recommend using the <code>codemod</code> command instead of the <code>react-codemod</code> because it runs faster, handles more complex code migrations, and provides better support for TypeScript.</p><note><section class="level4"aria-labelledby="run-all-react-19-codemods-run-all-react-19-codemods"><h4 id="run-all-react-19-codemods-run-all-react-19-codemods">Run all React 19 codemods {/<em>run-all-react-19-codemods</em>/}</h4><p>Run all codemods listed in this guide with the React 19 <code>codemod</code> recipe:<pre class="language-bash"><code class="language-bash">npx codemod@latest react/19/migration-recipe</code></pre><p>This will run the following codemods from <code>react-codemod</code>:<ul><li><a href="https://github.com/reactjs/react-codemod?tab=readme-ov-file#replace-reactdom-render"><code>replace-reactdom-render</code></a><li><a href="https://github.com/reactjs/react-codemod?tab=readme-ov-file#replace-string-ref"><code>replace-string-ref</code></a><li><a href="https://github.com/reactjs/react-codemod?tab=readme-ov-file#replace-act-import"><code>replace-act-import</code></a><li><a href="https://github.com/reactjs/react-codemod?tab=readme-ov-file#replace-use-form-state"><code>replace-use-form-state</code></a><li><a href="TODO"><code>prop-types-typescript</code></a></ul><p>This does not include the TypeScript changes. See <a href="#typescript-changes">TypeScript changes</a> below.</section></note><p>Changes that include a codemod include the command below.<p>For a list of all available codemods, see the <a href="https://github.com/reactjs/react-codemod"><code>react-codemod</code> repo</a>.</section><section class="level2"aria-labelledby="breaking-changes-breaking-changes"><h2 id="breaking-changes-breaking-changes">Breaking changes {/<em>breaking-changes</em>/}</h2><section class="level3"aria-labelledby="errors-in-render-are-not-re-thrown-errors-in-render-are-not-re-thrown"><h3 id="errors-in-render-are-not-re-thrown-errors-in-render-are-not-re-thrown">Errors in render are not re-thrown {/<em>errors-in-render-are-not-re-thrown</em>/}</h3><p>In previous versions of React, errors thrown during render were caught and rethrown. In DEV, we would also log to <code>console.error</code>, resulting in duplicate error logs.<p>In React 19, we've <a href="/blog/2024/04/25/react-19#error-handling">improved how errors are handled</a> to reduce duplication by not re-throwing:<ul><li><strong>Uncaught Errors</strong>: Errors that are not caught by an Error Boundary are reported to <code>window.reportError</code>.<li><strong>Caught Errors</strong>: Errors that are caught by an Error Boundary are reported to <code>console.error</code>.</ul><p>This change should not impact most apps, but if your production error reporting relies on errors being re-thrown, you may need to update your error handling. To support this, we've added new methods to <code>createRoot</code> and <code>hydrateRoot</code> for custom error handling:<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">createRoot</span><span class="token punctuation">(</span>container<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">onUncaughtError</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> errorInfo</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// ... log error report</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onCaughtError</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> errorInfo</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// ... log error report</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>For more info, see the docs for <a href="https://react.dev/reference/react-dom/client/createRoot"><code>createRoot</code></a> and <a href="https://react.dev/reference/react-dom/client/hydrateRoot"><code>hydrateRoot</code></a>.</section><section class="level3"aria-labelledby="removed-deprecated-react-apis-removed-deprecated-react-apis"><h3 id="removed-deprecated-react-apis-removed-deprecated-react-apis">Removed deprecated React APIs {/<em>removed-deprecated-react-apis</em>/}</h3><section class="level4"aria-labelledby="removed-proptypes-and-defaultprops-for-functions-removed-proptypes-and-defaultprops"><h4 id="removed-proptypes-and-defaultprops-for-functions-removed-proptypes-and-defaultprops">Removed: <code>propTypes</code> and <code>defaultProps</code> for functions {/<em>removed-proptypes-and-defaultprops</em>/}</h4><p><code>PropTypes</code> were deprecated in <a href="https://legacy.reactjs.org/blog/2017/04/07/react-v15.5.0.html#new-deprecation-warnings">April 2017 (v15.5.0)</a>.<p>In React 19, we're removing the <code>propType</code> checks from the React package, and using them will be silently ignored. If you're using <code>propTypes</code>, we recommend migrating to TypeScript or another type-checking solution.<p>We're also removing <code>defaultProps</code> from function components in place of ES6 default parameters. Class components will continue to support <code>defaultProps</code> since there is no ES6 alternative.<pre class="language-js"><code class="language-js"><span class="token comment">// Before</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">PropTypes</span></span> <span class="token keyword module">from</span> <span class="token string">'prop-types'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Heading</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>text<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token maybe-class-name">Heading</span><span class="token punctuation">.</span><span class="token property-access">propTypes</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token maybe-class-name">PropTypes</span><span class="token punctuation">.</span><span class="token property-access">string</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token maybe-class-name">Heading</span><span class="token punctuation">.</span><span class="token property-access">defaultProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'Hello, world!'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><pre class="language-ts"><code class="language-ts"><span class="token comment">// After</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">Props</span></span> <span class="token punctuation">{</span>
  text<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Heading</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>text <span class="token operator">=</span> <span class="token string">'Hello, world!'</span><span class="token punctuation">}</span><span class="token operator">:</span> <span class="token maybe-class-name">Props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>text<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><note><p>Codemod <code>propTypes</code> to TypeScript with:<pre class="language-bash"><code class="language-bash">npx codemod@latest react/prop-types-typescript</code></pre></note></section><section class="level4"aria-labelledby="removed-legacy-context-using-contexttypes-and-getchildcontext-removed-removing-legacy-context"><h4 id="removed-legacy-context-using-contexttypes-and-getchildcontext-removed-removing-legacy-context">Removed: Legacy Context using <code>contextTypes</code> and <code>getChildContext</code> {/<em>removed-removing-legacy-context</em>/}</h4><p>Legacy Context was deprecated in <a href="https://legacy.reactjs.org/blog/2018/10/23/react-v-16-6.html">October 2018 (v16.6.0)</a>.<p>Legacy Context was only available in class components using the APIs <code>contextTypes</code> and <code>getChildContext</code>, and was replaced with <code>contextType</code> due to subtle bugs that were easy to miss. In React 19, we're removing Legacy Context to make React slightly smaller and faster.<p>If you're still using Legacy Context in class components, you'll need to migrate to the new <code>contextType</code> API:<pre class="language-js"><code class="language-js"><span class="token comment">// Before</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">PropTypes</span></span> <span class="token keyword module">from</span> <span class="token string">'prop-types'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> childContextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token maybe-class-name">PropTypes</span><span class="token punctuation">.</span><span class="token property-access">string</span><span class="token punctuation">.</span><span class="token property-access">isRequired</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">getChildContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">'bar'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Child</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token maybe-class-name">PropTypes</span><span class="token punctuation">.</span><span class="token property-access">string</span><span class="token punctuation">.</span><span class="token property-access">isRequired</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>div<span class="token operator">></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">context</span><span class="token punctuation">.</span><span class="token property-access">foo</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token comment">// After</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">FooContext</span> <span class="token operator">=</span> <span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">FooContext</span> value<span class="token operator">=</span><span class="token string">'bar'</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Child</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token maybe-class-name">FooContext</span><span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> contextType <span class="token operator">=</span> <span class="token maybe-class-name">FooContext</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>div<span class="token operator">></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">context</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></section><section class="level4"aria-labelledby="removed-string-refs-removed-string-refs"><h4 id="removed-string-refs-removed-string-refs">Removed: string refs {/<em>removed-string-refs</em>/}</h4><p>String refs were deprecated in <a href="https://legacy.reactjs.org/blog/2018/03/27/update-on-async-rendering.html">March, 2018 (v16.3.0)</a>.<p>Class components supported string refs before being replaced by ref callbacks due to <a href="https://github.com/facebook/react/issues/1373">multiple downsides</a>. In React 19, we're removing string refs to make React simpler and easier to understand.<p>If you're still using string refs in class components, you'll need to migrate to ref callbacks:<pre class="language-js"><code class="language-js"><span class="token comment">// Before</span>
<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">refs</span><span class="token punctuation">.</span><span class="token property-access">input</span><span class="token punctuation">.</span><span class="token method function property-access">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>input ref<span class="token operator">=</span><span class="token string">'input'</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token comment">// After</span>
<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">input</span><span class="token punctuation">.</span><span class="token method function property-access">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>input ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">input</span> <span class="token arrow operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">input</span> <span class="token operator">=</span> input<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><note><p>Codemod string refs with <code>ref</code> callbacks:<pre class="language-bash"><code class="language-bash">npx codemod@latest react/19/replace-string-ref</code></pre></note></section><section class="level4"aria-labelledby="removed-module-pattern-factories-removed-module-pattern-factories"><h4 id="removed-module-pattern-factories-removed-module-pattern-factories">Removed: Module pattern factories {/<em>removed-module-pattern-factories</em>/}</h4><p>Module pattern factories were deprecated in <a href="https://legacy.reactjs.org/blog/2019/08/08/react-v16.9.0.html#deprecating-module-pattern-factories">August 2019 (v16.9.0)</a>.<p>This pattern was rarely used and supporting it causes React to be slightly larger and slower than necessary. In React 19, we're removing support for module pattern factories, and you'll need to migrate to regular functions:<pre class="language-js"><code class="language-js"><span class="token comment">// Before</span>
<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">FactoryComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>div <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token comment">// After</span>
<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">FactoryComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>div <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section><section class="level4"aria-labelledby="removed-reactcreatefactory-removed-createfactory"><h4 id="removed-reactcreatefactory-removed-createfactory">Removed: <code>React.createFactory</code> {/<em>removed-createfactory</em>/}</h4><p><code>createFactory</code> was deprecated in <a href="https://legacy.reactjs.org/blog/2020/02/26/react-v16.13.0.html#deprecating-createfactory">February 2020 (v16.13.0)</a>.<p>Using <code>createFactory</code> was common before broad support for JSX, but it's rarely used today and can be replaced with JSX. In React 19, we're removing <code>createFactory</code> and you'll need to migrate to JSX:<pre class="language-js"><code class="language-js"><span class="token comment">// Before</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createFactory <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> button <span class="token operator">=</span> <span class="token function">createFactory</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-js"><code class="language-js"><span class="token comment">// After</span>
<span class="token keyword">const</span> button <span class="token operator">=</span> <span class="token operator">&#x3C;</span>button <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span></code></pre></section><section class="level4"aria-labelledby="removed-react-test-renderershallow-removed-react-test-renderer-shallow"><h4 id="removed-react-test-renderershallow-removed-react-test-renderer-shallow">Removed: <code>react-test-renderer/shallow</code> {/<em>removed-react-test-renderer-shallow</em>/}</h4><p>In React 18, we updated <code>react-test-renderer/shallow</code> to re-export <a href="https://github.com/enzymejs/react-shallow-renderer">react-shallow-renderer</a>. In React 19, we're removing <code>react-test-render/shallow</code> to prefer installing the package directly:<pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> react-shallow-renderer --save-dev</code></pre><pre class="language-diff"><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import ShallowRenderer from 'react-test-renderer/shallow';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import ShallowRenderer from 'react-shallow-renderer';</span></span></code></pre><note><section class="level5"aria-labelledby="please-reconsider-shallow-rendering-please-reconsider-shallow-rendering"><h5 id="please-reconsider-shallow-rendering-please-reconsider-shallow-rendering">Please reconsider shallow rendering {/<em>please-reconsider-shallow-rendering</em>/}</h5><p>Shallow rendering depends on React internals and can block you from future upgrades. We recommend migrating your tests to <a href="https://testing-library.com/docs/react-testing-library/intro/">@testing-library/react</a> or <a href="https://callstack.github.io/react-native-testing-library/docs/getting-started">@testing-library/react-native</a>.</section></note></section></section><section class="level3"aria-labelledby="removed-deprecated-react-dom-apis-removed-deprecated-react-dom-apis"><h3 id="removed-deprecated-react-dom-apis-removed-deprecated-react-dom-apis">Removed deprecated React DOM APIs {/<em>removed-deprecated-react-dom-apis</em>/}</h3><section class="level4"aria-labelledby="removed-react-domtest-utils-removed-react-dom-test-utils"><h4 id="removed-react-domtest-utils-removed-react-dom-test-utils">Removed: <code>react-dom/test-utils</code> {/<em>removed-react-dom-test-utils</em>/}</h4><p>We've moved <code>act</code> from <code>react-dom/test-utils</code> to the <code>react</code> package:</p><consoleblockmulti><consolelogline level="error"><p><code>ReactDOMTestUtils.act</code> is deprecated in favor of <code>React.act</code>. Import <code>act</code> from <code>react</code> instead of <code>react-dom/test-utils</code>. See <a href="https://react.dev/warnings/react-dom-test-utils">https://react.dev/warnings/react-dom-test-utils</a> for more info.</p></consolelogline></consoleblockmulti><p>To fix this warning, you can import <code>act</code> from <code>react</code>:<pre class="language-diff"><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import {act} from 'react-dom/test-utils'
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import {act} from 'react';</span></span></code></pre><p>All other <code>test-utils</code> functions have been removed. These utilities were uncommon, and made it too easy to depend on low level implementation details of your components and React. In React 19, these functions will error when called and their exports will be removed in a future version.<p>See the <a href="https://react.dev/warnings/react-dom-test-utils">warning page</a> for alternatives.</p><note><p>Codemod <code>ReactDOMTestUtils.act</code> to <code>React.act</code>:<pre class="language-bash"><code class="language-bash">npx codemod@latest react/19/replace-act-import</code></pre></note></section><section class="level4"aria-labelledby="removed-reactdomrender-removed-reactdom-render"><h4 id="removed-reactdomrender-removed-reactdom-render">Removed: <code>ReactDOM.render</code> {/<em>removed-reactdom-render</em>/}</h4><p><code>ReactDOM.render</code> was deprecated in <a href="https://react.dev/blog/2022/03/08/react-18-upgrade-guide">March 2022 (v18.0.0)</a>. In React 19, we're removing <code>ReactDOM.render</code> and you'll need to migrate to using <a href="https://react.dev/reference/react-dom/client/createRoot"><code>ReactDOM.createRoot</code></a>:<pre class="language-js"><code class="language-js"><span class="token comment">// Before</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>render<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// After</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>createRoot<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">createRoot</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
root<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><note><p>Codemod <code>ReactDOM.render</code> to <code>ReactDOMClient.createRoot</code>:<pre class="language-bash"><code class="language-bash">npx codemod@latest react/19/replace-reactdom-render</code></pre></note></section><section class="level4"aria-labelledby="removed-reactdomhydrate-removed-reactdom-hydrate"><h4 id="removed-reactdomhydrate-removed-reactdom-hydrate">Removed: <code>ReactDOM.hydrate</code> {/<em>removed-reactdom-hydrate</em>/}</h4><p><code>ReactDOM.hydrate</code> was deprecated in <a href="https://react.dev/blog/2022/03/08/react-18-upgrade-guide">March 2022 (v18.0.0)</a>. In React 19, we're removing <code>ReactDOM.hydrate</code> you'll need to migrate to using <a href="https://react.dev/reference/react-dom/client/hydrateRoot"><code>ReactDOM.hydrateRoot</code></a>,<pre class="language-js"><code class="language-js"><span class="token comment">// Before</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>hydrate<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token function">hydrate</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// After</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>hydrateRoot<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom/client'</span><span class="token punctuation">;</span>
<span class="token function">hydrateRoot</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><note><p>Codemod <code>ReactDOM.hydrate</code> to <code>ReactDOMClient.hydrateRoot</code>:<pre class="language-bash"><code class="language-bash">npx codemod@latest react/19/replace-reactdom-render</code></pre></note></section><section class="level4"aria-labelledby="removed-unmountcomponentatnode-removed-unmountcomponentatnode"><h4 id="removed-unmountcomponentatnode-removed-unmountcomponentatnode">Removed: <code>unmountComponentAtNode</code> {/<em>removed-unmountcomponentatnode</em>/}</h4><p><code>ReactDOM.unmountComponentAtNode</code> was deprecated in <a href="https://react.dev/blog/2022/03/08/react-18-upgrade-guide">March 2022 (v18.0.0)</a>. In React 19, you'll need to migrate to using <code>root.unmount()</code>.<pre class="language-js"><code class="language-js"><span class="token comment">// Before</span>
<span class="token function">unmountComponentAtNode</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// After</span>
root<span class="token punctuation">.</span><span class="token method function property-access">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>For more see <code>root.unmount()</code> for <a href="https://react.dev/reference/react-dom/client/createRoot#root-unmount"><code>createRoot</code></a> and <a href="https://react.dev/reference/react-dom/client/hydrateRoot#root-unmount"><code>hydrateRoot</code></a>.</p><note><p>Codemod <code>unmountComponentAtNode</code> to <code>root.unmount</code>:<pre class="language-bash"><code class="language-bash">npx codemod@latest react/19/replace-reactdom-render</code></pre></note></section><section class="level4"aria-labelledby="removed-reactdomfinddomnode-removed-reactdom-finddomnode"><h4 id="removed-reactdomfinddomnode-removed-reactdom-finddomnode">Removed: <code>ReactDOM.findDOMNode</code> {/<em>removed-reactdom-finddomnode</em>/}</h4><p><code>ReactDOM.findDOMNode</code> was <a href="https://legacy.reactjs.org/blog/2018/10/23/react-v-16-6.html#deprecations-in-strictmode">deprecated in October 2018 (v16.6.0)</a>.<p>We're removing <code>findDOMNode</code> because it was a legacy escape hatch that was slow to execute, fragile to refactoring, only returned the first child, and broke abstraction levels (see more <a href="https://legacy.reactjs.org/docs/strict-mode.html#warning-about-deprecated-finddomnode-usage">here</a>). You can replace <code>ReactDOM.findDOMNode</code> with <a href="/learn/manipulating-the-dom-with-refs">DOM refs</a>:<pre class="language-js"><code class="language-js"><span class="token comment">// Before</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>findDOMNode<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">AutoselectingInput</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> input <span class="token operator">=</span> <span class="token function">findDOMNode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    input<span class="token punctuation">.</span><span class="token method function property-access">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>input defaultValue<span class="token operator">=</span><span class="token string">"Hello"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token comment">// After</span>
<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">AutoselectingInput</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    ref<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">.</span><span class="token method function property-access">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>input ref<span class="token operator">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span> defaultValue<span class="token operator">=</span><span class="token string">"Hello"</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token punctuation">}</span></code></pre></section></section></section><section class="level2"aria-labelledby="new-deprecations-new-deprecations"><h2 id="new-deprecations-new-deprecations">New deprecations {/<em>new-deprecations</em>/}</h2><section class="level3"aria-labelledby="deprecated-elementref-deprecated-element-ref"><h3 id="deprecated-elementref-deprecated-element-ref">Deprecated: <code>element.ref</code> {/<em>deprecated-element-ref</em>/}</h3><p>React 19 supports <a href="/blog/2024/04/25/react-19#ref-as-a-prop"><code>ref</code> as a prop</a>, so we're deprecating the <code>element.ref</code> in place of <code>element.props.ref</code>.<p>Accessing <code>element.ref</code> will warn:</p><consoleblockmulti><consolelogline level="error"><p>Accessing element.ref is no longer supported. ref is now a regular prop. It will be removed from the JSX Element type in a future release.</p></consolelogline></consoleblockmulti></section><section class="level3"aria-labelledby="deprecated-react-test-renderer-deprecated-react-test-renderer"><h3 id="deprecated-react-test-renderer-deprecated-react-test-renderer">Deprecated: <code>react-test-renderer</code> {/<em>deprecated-react-test-renderer</em>/}</h3><p>We are deprecating <code>react-test-renderer</code> because it implements its own renderer environment that doesn't match the environment users use, promotes testing implementation details, and relies on introspection of React's internals.<p>The test renderer was created before there were more viable testing strategies available like <a href="https://testing-library.com">React Testing Library</a>, and we now recommend using a modern testing library instead.<p>In React 19, <code>react-test-renderer</code> logs a deprecation warning, and has switched to concurrent rendering. We recommend migrating your tests to <a href="https://testing-library.com/docs/react-testing-library/intro/">@testing-library/react</a> or <a href="https://callstack.github.io/react-native-testing-library/docs/getting-started">@testing-library/react-native</a> for a modern and well supported testing experience.</section></section><section class="level2"aria-labelledby="notable-changes-notable-changes"><h2 id="notable-changes-notable-changes">Notable changes {/<em>notable-changes</em>/}</h2><section class="level3"aria-labelledby="strictmode-changes-strict-mode-improvements"><h3 id="strictmode-changes-strict-mode-improvements">StrictMode changes {/<em>strict-mode-improvements</em>/}</h3><p>React 19 includes several fixes and improvements to Strict Mode.<p>When double rendering in Strict Mode in development, <code>useMemo</code> and <code>useCallback</code> will reuse the memoized results from the first render during the second render. Components that are already Strict Mode compatible should not notice a difference in behavior.<p>As with all Strict Mode behaviors, these features are designed to proactively surface bugs in your components during development so you can fix them before they are shipped to production. For example, during development, Strict Mode will double-invoke ref callback functions on initial mount, to simulate what happens when a mounted component is replaced by a Suspense fallback.</section><section class="level3"aria-labelledby="umd-builds-removed-umd-builds-removed"><h3 id="umd-builds-removed-umd-builds-removed">UMD builds removed {/<em>umd-builds-removed</em>/}</h3><p>UMD was widely used in the past as a convenient way to load React without a build step. Now, there are modern alternatives for loading modules as scripts in HTML documents. Starting with React 19, React will no longer produce UMD builds to reduce the complexity of its testing and release process.<p>To load React 19 with a script tag, we recommend using an ESM-based CDN such as <a href="https://esm.sh/">esm.sh</a>.<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword module">from</span> <span class="token string">"https://esm.sh/react@19/?dev"</span>
  <span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ReactDOMClient</span></span> <span class="token keyword module">from</span> <span class="token string">"https://esm.sh/react-dom@19/client?dev"</span>
  <span class="token spread operator">...</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span></code></pre></section><section class="level3"aria-labelledby="libraries-depending-on-react-internals-may-block-upgrades-libraries-depending-on-react-internals-may-block-upgrades"><h3 id="libraries-depending-on-react-internals-may-block-upgrades-libraries-depending-on-react-internals-may-block-upgrades">Libraries depending on React internals may block upgrades {/<em>libraries-depending-on-react-internals-may-block-upgrades</em>/}</h3><p>This release includes changes to React internals that may impact libraries that ignore our pleas to not use internals like <code>SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED</code>. These changes are necessary to land improvements in React 19, and will not break libraries that follow our guidelines.<p>Based on our <a href="https://react.dev/community/versioning-policy#what-counts-as-a-breaking-change">Versioning Policy</a>, these updates are not listed as breaking changes, and we are not including docs for how to upgrade them. The recommendation is to remove any code that depends on internals.<p>To reflect the impact of using internals, we have renamed the <code>SECRET_INTERNALS</code> suffix to:<p><code>_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE</code><p>In the future we will more aggressively block accessing internals from React to discourage usage and ensure users are not blocked from upgrading.</section></section><section class="level2"aria-labelledby="typescript-changes-typescript-changes"><h2 id="typescript-changes-typescript-changes">TypeScript changes {/<em>typescript-changes</em>/}</h2><section class="level3"aria-labelledby="removed-deprecated-typescript-types-removed-deprecated-typescript-types"><h3 id="removed-deprecated-typescript-types-removed-deprecated-typescript-types">Removed deprecated TypeScript types {/<em>removed-deprecated-typescript-types</em>/}</h3><p>We've cleaned up the TypeScript types based on the removed APIs in React 19. Some of the removed have types been moved to more relevant packages, and others are no longer needed to describe React's behavior.</p><note>We've published [`types-react-codemod`](https://github.com/eps1lon/types-react-codemod/) to migrate most type related breaking changes:<pre class="language-bash"><code class="language-bash">npx types-react-codemod@latest preset-19 ./path-to-app</code></pre><p>If you have a lot of unsound access to <code>element.props</code>, you can run this additional codemod:<pre class="language-bash"><code class="language-bash">npx types-react-codemod@latest react-element-default-any-props ./path-to-your-react-ts-files</code></pre></note><p>Check out <a href="https://github.com/eps1lon/types-react-codemod/"><code>types-react-codemod</code></a> for a list of supported replacements. If you feel a codemod is missing, it can be tracked in the <a href="https://github.com/eps1lon/types-react-codemod/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3A%22React+19%22+label%3Aenhancement">list of missing React 19 codemods</a>.</section><section class="level3"aria-labelledby="ref-cleanups-required-ref-cleanup-required"><h3 id="ref-cleanups-required-ref-cleanup-required"><code>ref</code> cleanups required {/<em>ref-cleanup-required</em>/}</h3><p><em>This change is included in the <code>react-19</code> codemod preset as <a href="https://github.com/eps1lon/types-react-codemod/#no-implicit-ref-callback-return"><code>no-implicit-ref-callback-return</code></a>.</em><p>Due to the introduction of ref cleanup functions, returning anything else from a ref callback will now be rejected by TypeScript. The fix is usually to stop using implicit returns:<pre class="language-diff"><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> &#x3C;div ref={current => (instance = current)} />
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> &#x3C;div ref={current => {instance = current}} /></span></span></code></pre><p>The original code returned the instance of the <code>HTMLDivElement</code> and TypeScript wouldn't know if this was supposed to be a cleanup function or not.</section><section class="level3"aria-labelledby="useref-requires-an-argument-useref-requires-argument"><h3 id="useref-requires-an-argument-useref-requires-argument"><code>useRef</code> requires an argument {/<em>useref-requires-argument</em>/}</h3><p><em>This change is included in the <code>react-19</code> codemod preset as <a href="https://github.com/eps1lon/types-react-codemod/#refobject-defaults"><code>refobject-defaults</code></a>.</em><p>A long-time complaint of how TypeScript and React work has been <code>useRef</code>. We've changed the types so that <code>useRef</code> now requires an argument. This significantly simplifies its type signature. It'll now behave more like <code>createContext</code>.<pre class="language-ts"><code class="language-ts"><span class="token comment">// @ts-expect-error: Expected 1 argument but saw none</span>
<span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Passes</span>
<span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword nil">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// @ts-expect-error: Expected 1 argument but saw none</span>
<span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Passes</span>
<span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword nil">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>This now also means that all refs are mutable. You'll no longer hit the issue where you can't mutate a ref because you initialised it with <code>null</code>:<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token builtin">number</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Cannot assign to 'current' because it is a read-only property</span>
ref<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></code></pre><p><code>MutableRef</code> is now deprecated in favor of a single <code>RefObject</code> type which <code>useRef</code> will always return:<pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">RefObject</span><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">{</span>
  current<span class="token operator">:</span> <span class="token constant">T</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">function</span> useRef<span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span><span class="token operator">:</span> <span class="token maybe-class-name">RefObject</span><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span></code></pre><p><code>useRef</code> still has a convenience overload for <code>useRef&#x3C;T>(null)</code> that automatically returns <code>RefObject&#x3C;T | null></code>. To ease migration due to the required argument for <code>useRef</code>, a convenience overload for <code>useRef(undefined)</code> was added that automatically returns <code>RefObject&#x3C;T | undefined></code>.<p>Check out <a href="https://github.com/DefinitelyTyped/DefinitelyTyped/pull/64772">[RFC] Make all refs mutable</a> for prior discussions about this change.</section><section class="level3"aria-labelledby="changes-to-the-reactelement-typescript-type-changes-to-the-reactelement-typescript-type"><h3 id="changes-to-the-reactelement-typescript-type-changes-to-the-reactelement-typescript-type">Changes to the <code>ReactElement</code> TypeScript type {/<em>changes-to-the-reactelement-typescript-type</em>/}</h3><p><em>This change is included in the <a href="https://github.com/eps1lon/types-react-codemod#react-element-default-any-props"><code>react-element-default-any-props</code></a> codemod.</em><p>The <code>props</code> of React elements now default to <code>unknown</code> instead of <code>any</code> if the element is typed as <code>ReactElement</code>. This does not affect you if you pass a type argument to <code>ReactElement</code>:<pre class="language-ts"><code class="language-ts"></code></pre><p>But if you relied on the default, you now have to handle <code>unknown</code>:<pre class="language-ts"><code class="language-ts"><span class="token keyword">type</span> <span class="token class-name"><span class="token maybe-class-name">Example</span></span> <span class="token operator">=</span> <span class="token maybe-class-name">ReactElement</span><span class="token punctuation">[</span><span class="token string">"props"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//   ^? Before, was 'any', now 'unknown'</span></code></pre><p>You should only need it if you have a lot of legacy code relying on unsound access of element props. Element introspection only exists as an escape hatch, and you should make it explicit that your props access is unsound via an explicit <code>any</code>.</section><section class="level3"aria-labelledby="the-jsx-namespace-in-typescript-the-jsx-namespace-in-typescript"><h3 id="the-jsx-namespace-in-typescript-the-jsx-namespace-in-typescript">The JSX namespace in TypeScript {/<em>the-jsx-namespace-in-typescript</em>/}</h3><p>This change is included in the <code>react-19</code> codemod preset as <a href="https://github.com/eps1lon/types-react-codemod#scoped-jsx"><code>scoped-jsx</code></a><p>A long-time request is to remove the global <code>JSX</code> namespace from our types in favor of <code>React.JSX</code>. This helps prevent pollution of global types which prevents conflicts between different UI libraries that leverage JSX.<p>You'll now need to wrap module augmentation of the JSX namespace in `declare module "....":<pre class="language-diff"><code class="language-diff">// global.d.ts
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> declare module "react" {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   namespace JSX {
</span><span class="token prefix unchanged"> </span><span class="token line">     interface IntrinsicElements {
</span><span class="token prefix unchanged"> </span><span class="token line">       "my-element": {
</span><span class="token prefix unchanged"> </span><span class="token line">         myElementProps: string;
</span><span class="token prefix unchanged"> </span><span class="token line">       };
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> }</span></span></code></pre><p>The exact module specifier depends on the JSX runtime you specified in the <code>compilerOptions</code> of your <code>tsconfig.json</code>:<ul><li>For <code>"jsx": "react-jsx"</code> it would be <code>react/jsx-runtime</code>.<li>For <code>"jsx": "react-jsxdev"</code> it would be <code>react/jsx-dev-runtime</code>.<li>For <code>"jsx": "react"</code> and <code>"jsx": "preserve"</code> it would be <code>react</code>.</ul></section><section class="level3"aria-labelledby="better-usereducer-typings-better-usereducer-typings"><h3 id="better-usereducer-typings-better-usereducer-typings">Better <code>useReducer</code> typings {/<em>better-usereducer-typings</em>/}</h3><p><code>useReducer</code> now has improved type inference thanks to <a href="https://github.com/mfp22">@mfp22</a>.<p>However, this required a breaking change where <code>useReducer</code> doesn't accept the full reducer type as a type parameter but instead either needs none (and rely on contextual typing) or needs both the state and action type.<p>The new best practice is <em>not</em> to pass type arguments to <code>useReducer</code>.<pre class="language-diff"><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> useReducer&#x3C;React.Reducer&#x3C;State, Action>>(reducer)
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> useReducer(reducer)</span></span></code></pre><p>This may not work in edge cases where you can explicitly type the state and action, by passing in the <code>Action</code> in a tuple:<pre class="language-diff"><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> useReducer&#x3C;React.Reducer&#x3C;State, Action>>(reducer)
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> useReducer&#x3C;State, [Action]>(reducer)</span></span></code></pre><p>If you define the reducer inline, we encourage to annotate the function parameters instead:<pre class="language-diff"><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> useReducer&#x3C;React.Reducer&#x3C;State, Action>>((state, action) => state)
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> useReducer((state: State, action: Action) => state)</span></span></code></pre><p>This is also what you'd also have to do if you move the reducer outside of the <code>useReducer</code> call:<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token maybe-class-name">State</span><span class="token punctuation">,</span> action<span class="token operator">:</span> <span class="token maybe-class-name">Action</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> state<span class="token punctuation">;</span></code></pre></section></section><section class="level2"aria-labelledby="changelog-changelog"><h2 id="changelog-changelog">Changelog {/<em>changelog</em>/}</h2><section class="level3"aria-labelledby="other-breaking-changes-other-breaking-changes"><h3 id="other-breaking-changes-other-breaking-changes">Other breaking changes {/<em>other-breaking-changes</em>/}</h3><ul><li><strong>react-dom</strong>: Error for javascript URLs in src/href <a href="https://github.com/facebook/react/pull/26507">#26507</a><li><strong>react-dom</strong>: Remove <code>errorInfo.digest</code> from <code>onRecoverableError</code> <a href="https://github.com/facebook/react/pull/28222">#28222</a><li><strong>react-dom</strong>: Remove <code>unstable_flushControlled</code> <a href="https://github.com/facebook/react/pull/26397">#26397</a><li><strong>react-dom</strong>: Remove <code>unstable_createEventHandle</code> <a href="https://github.com/facebook/react/pull/28271">#28271</a><li><strong>react-dom</strong>: Remove <code>unstable_renderSubtreeIntoContainer</code> <a href="https://github.com/facebook/react/pull/28271">#28271</a><li><strong>react-dom</strong>: Remove <code>unstable_runWithPrioirty</code> <a href="https://github.com/facebook/react/pull/28271">#28271</a><li><strong>react-is</strong>: Remove deprecated methods from <code>react-is</code> <a href="https://github.com/facebook/react/pull/28224">28224</a></ul></section><section class="level3"aria-labelledby="other-notable-changes-other-notable-changes"><h3 id="other-notable-changes-other-notable-changes">Other notable changes {/<em>other-notable-changes</em>/}</h3><ul><li><strong>react</strong>: Batch sync, default and continuous lanes <a href="https://github.com/facebook/react/pull/25700">#25700</a><li><strong>react</strong>: Don't prerender siblings of suspended component <a href="https://github.com/facebook/react/pull/26380">#26380</a><li><strong>react</strong>: Detect infinite update loops caused by render phase updates <a href="https://github.com/facebook/react/pull/26625">#26625</a><li><strong>react-dom</strong>: Transitions in popstate are now synchronous <a href="https://github.com/facebook/react/pull/26025">#26025</a><li><strong>react-dom</strong>: Remove layout effect warning during SSR <a href="https://github.com/facebook/react/pull/26395">#26395</a><li><strong>react-dom</strong>: Warn and dont set empty string for src/href (except anchor tags) <a href="https://github.com/facebook/react/pull/28124">#28124</a></ul><p>We'll publish the full changelog with the stable release of React 19.<p>Thanks to <a href="https://twitter.com/acdlite">Andrew Clark</a>, <a href="https://twitter.com/Eli_White">Eli White</a>, <a href="https://github.com/jackpope">Jack Pope</a>, <a href="https://github.com/kassens">Jan Kassens</a>, <a href="https://twitter.com/joshcstory">Josh Story</a>, <a href="https://twitter.com/mattcarrollcode">Matt Carroll</a>, <a href="https://twitter.com/noahlemen">Noah Lemen</a>, <a href="https://twitter.com/sophiebits">Sophie Alpert</a>, and <a href="https://twitter.com/sebsilbermann">Sebastian Silbermann</a> for reviewing and editing this post. <span style="float:footnote"><a href="../../../../index.html#toc">Go to TOC</a></span></section></section></section>