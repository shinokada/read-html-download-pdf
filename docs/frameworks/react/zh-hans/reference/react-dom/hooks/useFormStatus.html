<!doctype html><html lang="zh-hans"><meta charset="utf-8"><title>useFormStatus</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="useformstatus"><h1 id="useformstatus">useFormStatus</h1><p>canary: true</p><canary><p><code>useFormStatus</code> Hook ç›®å‰ä»…åœ¨ React Canary ä¸ experimental æ¸ é“ä¸­å¯ç”¨ã€‚åœ¨æ­¤å¤„äº†è§£æ›´å¤šå…³äº <a href="/community/versioning-policy#all-release-channels">React å‘å¸ƒæ¸ é“</a> çš„ä¿¡æ¯ã€‚</p></canary><intro><p><code>useFormStatus</code> æ˜¯ä¸€ä¸ªæä¾›ä¸Šæ¬¡è¡¨å•æäº¤çŠ¶æ€ä¿¡æ¯çš„ Hookã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> pending<span class="token punctuation">,</span> data<span class="token punctuation">,</span> method<span class="token punctuation">,</span> action <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></intro><inlinetoc><section class="level2"aria-labelledby="å‚è€ƒ-reference"><h2 id="å‚è€ƒ-reference">å‚è€ƒ {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="useformstatus-use-form-status"><h3 id="useformstatus-use-form-status"><code>useFormStatus()</code> {/<em>use-form-status</em>/}</h3><p><code>useFormStatus</code> Hook æä¾›äº†ä¸Šæ¬¡è¡¨å•æäº¤çš„çŠ¶æ€ä¿¡æ¯ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useFormStatus <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports">action</span> <span class="token keyword module">from</span> <span class="token string">'./actions'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Submit</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> status <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>button disabled<span class="token operator">=</span><span class="token punctuation">{</span>status<span class="token punctuation">.</span><span class="token property-access">pending</span><span class="token punctuation">}</span><span class="token operator">></span>æäº¤<span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>action<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Submit</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p><code>Submit</code> ç»„ä»¶å¿…é¡»åœ¨ <code>&#x3C;form></code> å†…éƒ¨æ¸²æŸ“ä»¥è·å–çŠ¶æ€ä¿¡æ¯ã€‚è¯¥ Hook è¿”å›è¯¸å¦‚<codestep step="{1}"><code>pending</code></codestep>å±æ€§çš„ä¿¡æ¯ï¼Œç”¨äºæŒ‡ç¤ºè¡¨å•æ˜¯å¦æ­£åœ¨æäº¤ä¸­ã€‚<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ<code>Submit</code> åˆ©ç”¨æ­¤ä¿¡æ¯æ¥åœ¨è¡¨å•æäº¤æ—¶ç¦ç”¨ <code>&#x3C;button></code> æŒ‰é’®çš„æŒ‰å‹æ“ä½œã€‚<p><a href="#usage">å‚è§ä¸‹æ–¹æ›´å¤šç¤ºä¾‹</a>ã€‚<section class="level4"aria-labelledby="å‚æ•°-parameters"><h4 id="å‚æ•°-parameters">å‚æ•° {/<em>parameters</em>/}</h4><p><code>useFormStatus</code> ä¸æ¥æ”¶ä»»ä½•å‚æ•°ã€‚</section><section class="level4"aria-labelledby="è¿”å›å€¼-returns"><h4 id="è¿”å›å€¼-returns">è¿”å›å€¼ {/<em>returns</em>/}</h4><p><code>useFormStatus</code> è¿”å›ä¸€ä¸ªåŒ…å«ä»¥ä¸‹å±æ€§çš„ <code>status</code> å¯¹è±¡ï¼š<ul><li><p><code>pending</code>ï¼šå¸ƒå°”å€¼ã€‚å¦‚æœä¸º <code>true</code>ï¼Œåˆ™è¡¨ç¤ºçˆ¶çº§ <code>&#x3C;form></code> æ­£åœ¨ç­‰å¾…æäº¤ï¼›å¦åˆ™ä¸º <code>false</code>ã€‚<li><p><code>data</code>ï¼šå®ç°äº† <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData"><code>FormData interface</code></a> çš„å¯¹è±¡ï¼ŒåŒ…å«çˆ¶çº§ <code>&#x3C;form></code> æ­£åœ¨æäº¤çš„æ•°æ®ï¼›å¦‚æœæ²¡æœ‰è¿›è¡Œæäº¤æˆ–æ²¡æœ‰çˆ¶çº§ <code>&#x3C;form></code>ï¼Œå®ƒå°†ä¸º <code>null</code>ã€‚<li><p><code>method</code>ï¼šå­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯ <code>'get'</code> æˆ– <code>'post'</code>ã€‚è¡¨ç¤ºçˆ¶çº§ <code>&#x3C;form></code> ä½¿ç”¨ <code>GET</code> æˆ– <code>POST</code> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods">HTTP æ–¹æ³•</a> è¿›è¡Œæäº¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>&#x3C;form></code> å°†ä½¿ç”¨ <code>GET</code> æ–¹æ³•ï¼Œå¹¶å¯ä»¥é€šè¿‡ <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form#method"><code>method</code></a> å±æ€§æŒ‡å®šã€‚</ul><ul><li><code>action</code>ï¼šä¸€ä¸ªä¼ é€’ç»™çˆ¶çº§ <code>&#x3C;form></code> çš„ <code>action</code> å±æ€§çš„å‡½æ•°å¼•ç”¨ã€‚å¦‚æœæ²¡æœ‰çˆ¶çº§ <code>&#x3C;form></code>ï¼Œåˆ™è¯¥å±æ€§ä¸º <code>null</code>ã€‚å¦‚æœåœ¨ <code>action</code> å±æ€§ä¸Šæä¾›äº† URI å€¼ï¼Œæˆ–è€…æœªæŒ‡å®š <code>action</code> å±æ€§ï¼Œ<code>status.action</code> å°†ä¸º <code>null</code>ã€‚</ul></section><section class="level4"aria-labelledby="æ³¨æ„-caveats"><h4 id="æ³¨æ„-caveats">æ³¨æ„ {/<em>caveats</em>/}</h4><ul><li><code>useFormStatus</code> Hook å¿…é¡»ä»åœ¨ <code>&#x3C;form></code> å†…æ¸²æŸ“çš„ç»„ä»¶ä¸­è°ƒç”¨ã€‚<li><code>useFormStatus</code> ä»…ä¼šè¿”å›çˆ¶çº§ <code>&#x3C;form></code> çš„çŠ¶æ€ä¿¡æ¯ã€‚å®ƒä¸ä¼šè¿”å›åŒä¸€ç»„ä»¶æˆ–å­ç»„ä»¶ä¸­æ¸²æŸ“çš„ä»»ä½• <code>&#x3C;form></code> çš„çŠ¶æ€ä¿¡æ¯ã€‚</ul></section></section></section><section class="level2"aria-labelledby="ç”¨æ³•-usage"><h2 id="ç”¨æ³•-usage">ç”¨æ³• {/<em>usage</em>/}</h2><section class="level3"aria-labelledby="åœ¨è¡¨å•æäº¤æœŸé—´æ˜¾ç¤ºå¾…å®šçŠ¶æ€-display-a-pending-state-during-form-submission"><h3 id="åœ¨è¡¨å•æäº¤æœŸé—´æ˜¾ç¤ºå¾…å®šçŠ¶æ€-display-a-pending-state-during-form-submission">åœ¨è¡¨å•æäº¤æœŸé—´æ˜¾ç¤ºå¾…å®šçŠ¶æ€ {/<em>display-a-pending-state-during-form-submission</em>/}</h3><p>å¯ä»¥åœ¨ <code>&#x3C;form></code> ä¸­æ¸²æŸ“çš„å­ç»„ä»¶ä¸­è°ƒç”¨ <code>useFormStatus</code> Hookï¼Œå¹¶è¯»å–è¿”å›çš„ <code>pending</code> å±æ€§ï¼Œä»¥åœ¨è¡¨å•æäº¤æœŸé—´æ˜¾ç¤ºå¾…å®šçŠ¶æ€ã€‚<p>ä¸‹é¢çš„ç¤ºä¾‹ä½¿ç”¨ <code>pending</code> å±æ€§æŒ‡ç¤ºè¡¨å•æ­£åœ¨æäº¤ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useFormStatus <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> submitForm <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"./actions.js"</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Submit</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> pending <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>button type<span class="token operator">=</span><span class="token string">"submit"</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>pending<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token punctuation">{</span>pending <span class="token operator">?</span> <span class="token string">"æäº¤ä¸­â€¦â€¦"</span> <span class="token operator">:</span> <span class="token string">"æäº¤"</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> action <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>action<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Submit</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Form</span> action<span class="token operator">=</span><span class="token punctuation">{</span>submitForm<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">submitForm</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"canary"</span><span class="token punctuation">,</span>
    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"canary"</span><span class="token punctuation">,</span>
    <span class="token property">"react-scripts"</span><span class="token operator">:</span> <span class="token string">"^5.0.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"/index.js"</span><span class="token punctuation">,</span>
  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></sandpack><pitfall><section class="level5"aria-labelledby="useformstatus-ä¸ä¼šè¿”å›åœ¨åŒä¸€ç»„ä»¶ä¸­æ¸²æŸ“çš„-form-çš„çŠ¶æ€ä¿¡æ¯-useformstatus-will-not-return-status-information-for-a-form-rendered-in-the-same-component"><h5 id="useformstatus-ä¸ä¼šè¿”å›åœ¨åŒä¸€ç»„ä»¶ä¸­æ¸²æŸ“çš„-form-çš„çŠ¶æ€ä¿¡æ¯-useformstatus-will-not-return-status-information-for-a-form-rendered-in-the-same-component"><code>useFormStatus</code> ä¸ä¼šè¿”å›åœ¨åŒä¸€ç»„ä»¶ä¸­æ¸²æŸ“çš„ <code>&#x3C;form></code> çš„çŠ¶æ€ä¿¡æ¯ {/<em>useformstatus-will-not-return-status-information-for-a-form-rendered-in-the-same-component</em>/}</h5><p><code>useFormStatus</code> Hook åªä¼šè¿”å›çˆ¶çº§ <code>&#x3C;form></code> çš„çŠ¶æ€ä¿¡æ¯ï¼Œè€Œä¸ä¼šè¿”å›åœ¨è°ƒç”¨ Hook çš„åŒä¸€ç»„ä»¶ä¸­æ¸²æŸ“çš„ä»»ä½• <code>&#x3C;form></code> çš„çŠ¶æ€ä¿¡æ¯ï¼Œä¹Ÿä¸ä¼šè¿”å›å­ç»„ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ğŸš© `pending` æ°¸è¿œä¸ä¼šä¸º true</span>
  <span class="token comment">// useFormStatus ä¸ä¼šè·Ÿè¸ªåœ¨æ­¤ç»„ä»¶ä¸­æ¸²æŸ“çš„è¡¨å•</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> pending <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submit<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>æ­£ç¡®çš„åšæ³•æ˜¯ä»ä½äº <code>&#x3C;form></code> å†…éƒ¨çš„ç»„ä»¶ä¸­è°ƒç”¨ <code>useFormStatus</code>ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Submit</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// âœ… `pending` å°†ä»åŒ…è£¹ Submit ç»„ä»¶çš„è¡¨å•æ´¾ç”Ÿ</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> pending <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>button disabled<span class="token operator">=</span><span class="token punctuation">{</span>pending<span class="token punctuation">}</span><span class="token operator">></span><span class="token spread operator">...</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &#x3C;form> `useFormStatus` å°†ä¼šè¿½è¸ªå®ƒ</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submit<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Submit</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></section></pitfall></section><section class="level3"aria-labelledby="æŸ¥çœ‹æ­£åœ¨æäº¤çš„è¡¨å•æ•°æ®-read-form-data-being-submitted"><h3 id="æŸ¥çœ‹æ­£åœ¨æäº¤çš„è¡¨å•æ•°æ®-read-form-data-being-submitted">æŸ¥çœ‹æ­£åœ¨æäº¤çš„è¡¨å•æ•°æ® {/<em>read-form-data-being-submitted</em>/}</h3><p>å¯ä»¥ä½¿ç”¨ä» <code>useFormStatus</code> è¿”å›çš„çŠ¶æ€ä¿¡æ¯ä¸­çš„ <code>data</code> å±æ€§æ¥æ˜¾ç¤ºç”¨æˆ·æ­£åœ¨æäº¤çš„æ•°æ®æ˜¯ä»€ä¹ˆã€‚<p>ä¸‹é¢çš„ç¤ºä¾‹ä¸­æœ‰ä¸€ä¸ªè¡¨å•ï¼Œç”¨æˆ·å¯ä»¥è¯·æ±‚ä¸€ä¸ªç”¨æˆ·åã€‚é‚£ä¹ˆå¯ä»¥ä½¿ç”¨ <code>useFormStatus</code> æ¥æ˜¾ç¤ºä¸€ä¸ªä¸´æ—¶çŠ¶æ€æ¶ˆæ¯ï¼Œç¡®è®¤è¯·æ±‚äº†ä»€ä¹ˆç”¨æˆ·åã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>useState<span class="token punctuation">,</span> useMemo<span class="token punctuation">,</span> useRef<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span>useFormStatus<span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">UsernameForm</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>pending<span class="token punctuation">,</span> data<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useFormStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>showSubmitted<span class="token punctuation">,</span> setShowSubmitted<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> submittedUsername <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> timeoutId <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>pending<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      submittedUsername<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> data<span class="token operator">?.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>timeoutId<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">!=</span> <span class="token keyword null nil">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      timeoutId<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        timeoutId<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span>
        <span class="token function">setShowSubmitted</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setShowSubmitted</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>pending<span class="token punctuation">,</span> data<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>è¯·æ±‚ç”¨æˆ·åï¼š<span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span><span class="token operator">&#x3C;</span>br <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"username"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button type<span class="token operator">=</span><span class="token string">"submit"</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>pending<span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token punctuation">{</span>pending <span class="token operator">?</span> <span class="token string">'æäº¤ä¸­â€¦â€¦'</span> <span class="token operator">:</span> <span class="token string">'æäº¤'</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token punctuation">{</span>showSubmitted <span class="token operator">?</span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>p<span class="token operator">></span>æäº¤è¯·æ±‚ç”¨æˆ·åï¼š<span class="token punctuation">{</span>submittedUsername<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">UsernameForm</span></span> <span class="token keyword module">from</span> <span class="token string">'./UsernameForm'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> submitForm <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"./actions.js"</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>form action<span class="token operator">=</span><span class="token punctuation">{</span>submitForm<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">UsernameForm</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>form<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">submitForm</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"canary"</span><span class="token punctuation">,</span>
    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"canary"</span><span class="token punctuation">,</span>
    <span class="token property">"react-scripts"</span><span class="token operator">:</span> <span class="token string">"^5.0.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"/index.js"</span><span class="token punctuation">,</span>
  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></sandpack></section></section><section class="level2"aria-labelledby="ç–‘éš¾è§£ç­”-troubleshooting"><h2 id="ç–‘éš¾è§£ç­”-troubleshooting">ç–‘éš¾è§£ç­” {/<em>troubleshooting</em>/}</h2><section class="level3"aria-labelledby="statuspending-ä»ä¸ä¸º-true-pending-is-never-true"><h3 id="statuspending-ä»ä¸ä¸º-true-pending-is-never-true"><code>status.pending</code> ä»ä¸ä¸º <code>true</code> {/<em>pending-is-never-true</em>/}</h3><p><code>useFormStatus</code> ä»…ä¼šè¿”å›çˆ¶çº§ <code>&#x3C;form></code> çš„çŠ¶æ€ä¿¡æ¯ã€‚<p>å¦‚æœè°ƒç”¨ <code>useFormStatus</code> çš„ç»„ä»¶æœªåµŒå¥—åœ¨ <code>&#x3C;form></code> ä¸­ï¼Œ<code>status.pending</code> æ€»æ˜¯è¿”å› <code>false</code>ã€‚è¯·éªŒè¯ <code>useFormStatus</code> æ˜¯å¦åœ¨ <code>&#x3C;form></code> å…ƒç´ çš„å­ç»„ä»¶ä¸­è°ƒç”¨ã€‚<p><code>useFormStatus</code> ä¸ä¼šè¿½è¸ªåŒä¸€ç»„ä»¶ä¸­æ¸²æŸ“çš„ <code>&#x3C;form></code> çš„çŠ¶æ€ã€‚å‚é˜… <a href="#useformstatus-will-not-return-status-information-for-a-form-rendered-in-the-same-component">é™·é˜±</a> ä»¥äº†è§£æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚ <span style="float:footnote"><a href="../../../index.html#toc">Go to TOC</a></span></section></section></inlinetoc></section>