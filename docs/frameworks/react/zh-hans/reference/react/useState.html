<!doctype html><html lang="zh-hans"><meta charset="utf-8"><title>useState</title><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="stylesheet"href="../../../../../themes/packages/prism-coy-theme/theme_common.css"><section class="level1"aria-labelledby="usestate"><h1 id="usestate">useState</h1><intro><p><code>useState</code> æ˜¯ä¸€ä¸ª React Hookï¼Œå®ƒå…è®¸ä½ å‘ç»„ä»¶æ·»åŠ ä¸€ä¸ª <a href="/learn/state-a-components-memory">çŠ¶æ€å˜é‡</a>ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></intro><inlinetoc><section class="level2"aria-labelledby="å‚è€ƒ-reference"><h2 id="å‚è€ƒ-reference">å‚è€ƒ {/<em>reference</em>/}</h2><section class="level3"aria-labelledby="usestateinitialstate-usestate"><h3 id="usestateinitialstate-usestate"><code>useState(initialState)</code> {/<em>usestate</em>/}</h3><p>åœ¨ç»„ä»¶çš„é¡¶å±‚è°ƒç”¨ <code>useState</code> æ¥å£°æ˜ä¸€ä¸ª <a href="/learn/state-a-components-memory">çŠ¶æ€å˜é‡</a>ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Taylor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">createTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre><p>æŒ‰ç…§æƒ¯ä¾‹ä½¿ç”¨ <a href="https://javascript.info/destructuring-assignment">æ•°ç»„è§£æ„</a> æ¥å‘½åçŠ¶æ€å˜é‡ï¼Œä¾‹å¦‚ <code>[something, setSomething]</code>ã€‚<p><a href="#usage">å‚è§ä¸‹é¢æ›´å¤šç¤ºä¾‹</a>ã€‚<section class="level4"aria-labelledby="å‚æ•°-parameters"><h4 id="å‚æ•°-parameters">å‚æ•° {/<em>parameters</em>/}</h4><ul><li><code>initialState</code>ï¼šä½ å¸Œæœ› state åˆå§‹åŒ–çš„å€¼ã€‚å®ƒå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å€¼ï¼Œä½†å¯¹äºå‡½æ•°æœ‰ç‰¹æ®Šçš„è¡Œä¸ºã€‚åœ¨åˆå§‹æ¸²æŸ“åï¼Œæ­¤å‚æ•°å°†è¢«å¿½ç•¥ã€‚<ul><li>å¦‚æœä¼ é€’å‡½æ•°ä½œä¸º <code>initialState</code>ï¼Œåˆ™å®ƒå°†è¢«è§†ä¸º <strong>åˆå§‹åŒ–å‡½æ•°</strong>ã€‚å®ƒåº”è¯¥æ˜¯çº¯å‡½æ•°ï¼Œä¸åº”è¯¥æ¥å—ä»»ä½•å‚æ•°ï¼Œå¹¶ä¸”åº”è¯¥è¿”å›ä¸€ä¸ªä»»ä½•ç±»å‹çš„å€¼ã€‚å½“åˆå§‹åŒ–ç»„ä»¶æ—¶ï¼ŒReact å°†è°ƒç”¨ä½ çš„åˆå§‹åŒ–å‡½æ•°ï¼Œå¹¶å°†å…¶è¿”å›å€¼å­˜å‚¨ä¸ºåˆå§‹çŠ¶æ€ã€‚<a href="#avoiding-recreating-the-initial-state">è¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹</a>ã€‚</ul></ul></section><section class="level4"aria-labelledby="è¿”å›-returns"><h4 id="è¿”å›-returns">è¿”å› {/<em>returns</em>/}</h4><p><code>useState</code> è¿”å›ä¸€ä¸ªç”±ä¸¤ä¸ªå€¼ç»„æˆçš„æ•°ç»„ï¼š<ol><li>å½“å‰çš„ stateã€‚åœ¨é¦–æ¬¡æ¸²æŸ“æ—¶ï¼Œå®ƒå°†ä¸ä½ ä¼ é€’çš„ <code>initialState</code> ç›¸åŒ¹é…ã€‚<li><a href="#setstate"><code>set</code> å‡½æ•°</a>ï¼Œå®ƒå¯ä»¥è®©ä½ å°† state æ›´æ–°ä¸ºä¸åŒçš„å€¼å¹¶è§¦å‘é‡æ–°æ¸²æŸ“ã€‚</ol></section><section class="level4"aria-labelledby="æ³¨æ„äº‹é¡¹-caveats"><h4 id="æ³¨æ„äº‹é¡¹-caveats">æ³¨æ„äº‹é¡¹ {/<em>caveats</em>/}</h4><ul><li><code>useState</code> æ˜¯ä¸€ä¸ª Hookï¼Œå› æ­¤ä½ åªèƒ½åœ¨ <strong>ç»„ä»¶çš„é¡¶å±‚</strong> æˆ–è‡ªå·±çš„ Hook ä¸­è°ƒç”¨å®ƒã€‚ä½ ä¸èƒ½åœ¨å¾ªç¯æˆ–æ¡ä»¶è¯­å¥ä¸­è°ƒç”¨å®ƒã€‚å¦‚æœä½ éœ€è¦è¿™æ ·åšï¼Œè¯·æå–ä¸€ä¸ªæ–°ç»„ä»¶å¹¶å°†çŠ¶æ€ç§»å…¥å…¶ä¸­ã€‚<li>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸­ï¼ŒReact å°† <strong>ä¸¤æ¬¡è°ƒç”¨åˆå§‹åŒ–å‡½æ•°</strong>ï¼Œä»¥ <a href="#my-initializer-or-updater-function-runs-twice">å¸®ä½ æ‰¾åˆ°æ„å¤–çš„ä¸çº¯æ€§</a>ã€‚è¿™åªæ˜¯å¼€å‘æ—¶çš„è¡Œä¸ºï¼Œä¸å½±å“ç”Ÿäº§ã€‚å¦‚æœä½ çš„åˆå§‹åŒ–å‡½æ•°æ˜¯çº¯å‡½æ•°ï¼ˆæœ¬è¯¥æ˜¯è¿™æ ·ï¼‰ï¼Œå°±ä¸åº”å½±å“è¯¥è¡Œä¸ºã€‚å…¶ä¸­ä¸€ä¸ªè°ƒç”¨çš„ç»“æœå°†è¢«å¿½ç•¥ã€‚</ul></section></section><section class="level3"aria-labelledby="set-å‡½æ•°ä¾‹å¦‚-setsomethingnextstate-setstate"><h3 id="set-å‡½æ•°ä¾‹å¦‚-setsomethingnextstate-setstate"><code>set</code> å‡½æ•°ï¼Œä¾‹å¦‚ <code>setSomething(nextState)</code> {/<em>setstate</em>/}</h3><p><code>useState</code> è¿”å›çš„ <code>set</code> å‡½æ•°å…è®¸ä½ å°† state æ›´æ–°ä¸ºä¸åŒçš„å€¼å¹¶è§¦å‘é‡æ–°æ¸²æŸ“ã€‚ä½ å¯ä»¥ç›´æ¥ä¼ é€’æ–°çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªæ ¹æ®å…ˆå‰çŠ¶æ€æ¥è®¡ç®—æ–°çŠ¶æ€çš„å‡½æ•°ï¼š<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Edward'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">'Taylor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token arrow operator">=></span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre><section class="level4"aria-labelledby="å‚æ•°-setstate-parameters"><h4 id="å‚æ•°-setstate-parameters">å‚æ•° {/<em>setstate-parameters</em>/}</h4><ul><li><code>nextState</code>ï¼šä½ æƒ³è¦ state æ›´æ–°ä¸ºçš„å€¼ã€‚å®ƒå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å€¼ï¼Œä½†å¯¹äºå‡½æ•°æœ‰ç‰¹æ®Šçš„è¡Œä¸ºã€‚<ul><li>å¦‚æœä½ å°†å‡½æ•°ä½œä¸º <code>nextState</code> ä¼ é€’ï¼Œå®ƒå°†è¢«è§†ä¸º <strong>æ›´æ–°å‡½æ•°</strong>ã€‚å®ƒå¿…é¡»æ˜¯çº¯å‡½æ•°ï¼Œåªæ¥å—å¾…å®šçš„ state ä½œä¸ºå…¶å”¯ä¸€å‚æ•°ï¼Œå¹¶åº”è¿”å›ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚React å°†æŠŠä½ çš„æ›´æ–°å‡½æ•°æ”¾å…¥é˜Ÿåˆ—ä¸­å¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚åœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æœŸé—´ï¼ŒReact å°†é€šè¿‡æŠŠé˜Ÿåˆ—ä¸­æ‰€æœ‰æ›´æ–°å‡½æ•°åº”ç”¨äºå…ˆå‰çš„çŠ¶æ€æ¥è®¡ç®—ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚<a href="#updating-state-based-on-the-previous-state">è¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹</a>ã€‚</ul></ul></section><section class="level4"aria-labelledby="è¿”å›å€¼-setstate-returns"><h4 id="è¿”å›å€¼-setstate-returns">è¿”å›å€¼ {/<em>setstate-returns</em>/}</h4><p><code>set</code> å‡½æ•°æ²¡æœ‰è¿”å›å€¼ã€‚</section><section class="level4"aria-labelledby="æ³¨æ„äº‹é¡¹-setstate-caveats"><h4 id="æ³¨æ„äº‹é¡¹-setstate-caveats">æ³¨æ„äº‹é¡¹ {/<em>setstate-caveats</em>/}</h4><ul><li><p><code>set</code> å‡½æ•° <strong>ä»…æ›´æ–° <em>ä¸‹ä¸€æ¬¡</em> æ¸²æŸ“çš„çŠ¶æ€å˜é‡</strong>ã€‚å¦‚æœåœ¨è°ƒç”¨ <code>set</code> å‡½æ•°åè¯»å–çŠ¶æ€å˜é‡ï¼Œåˆ™ <a href="#ive-updated-the-state-but-logging-gives-me-the-old-value">ä»ä¼šå¾—åˆ°åœ¨è°ƒç”¨ä¹‹å‰æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„æ—§å€¼</a>ã€‚<li><p>å¦‚æœä½ æä¾›çš„æ–°å€¼ä¸å½“å‰ <code>state</code> ç›¸åŒï¼ˆç”± <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is"><code>Object.is</code></a> æ¯”è¾ƒç¡®å®šï¼‰ï¼ŒReact å°† <strong>è·³è¿‡é‡æ–°æ¸²æŸ“è¯¥ç»„ä»¶åŠå…¶å­ç»„ä»¶</strong>ã€‚è¿™æ˜¯ä¸€ç§ä¼˜åŒ–ã€‚è™½ç„¶åœ¨æŸäº›æƒ…å†µä¸‹ React ä»ç„¶éœ€è¦åœ¨è·³è¿‡å­ç»„ä»¶ä¹‹å‰è°ƒç”¨ä½ çš„ç»„ä»¶ï¼Œä½†è¿™ä¸åº”å½±å“ä½ çš„ä»£ç ã€‚<li><p>React ä¼š <a href="/learn/queueing-a-series-of-state-updates">æ‰¹é‡å¤„ç†çŠ¶æ€æ›´æ–°</a>ã€‚å®ƒä¼šåœ¨æ‰€æœ‰ <strong>äº‹ä»¶å¤„ç†å‡½æ•°è¿è¡Œ</strong> å¹¶è°ƒç”¨å…¶ <code>set</code> å‡½æ•°åæ›´æ–°å±å¹•ã€‚è¿™å¯ä»¥é˜²æ­¢åœ¨å•ä¸ªäº‹ä»¶æœŸé—´å¤šæ¬¡é‡æ–°æ¸²æŸ“ã€‚åœ¨æŸäº›ç½•è§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦å¼ºåˆ¶ React æ›´æ—©åœ°æ›´æ–°å±å¹•ï¼Œä¾‹å¦‚è®¿é—® DOMï¼Œä½ å¯ä»¥ä½¿ç”¨ <a href="/reference/react-dom/flushSync"><code>flushSync</code></a>ã€‚<li><p>åœ¨æ¸²æŸ“æœŸé—´ï¼Œåªå…è®¸åœ¨å½“å‰æ¸²æŸ“ç»„ä»¶å†…éƒ¨è°ƒç”¨ <code>set</code> å‡½æ•°ã€‚React å°†ä¸¢å¼ƒå…¶è¾“å‡ºå¹¶ç«‹å³å°è¯•ä½¿ç”¨æ–°çŠ¶æ€é‡æ–°æ¸²æŸ“ã€‚è¿™ç§æ–¹å¼å¾ˆå°‘éœ€è¦ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥å­˜å‚¨ <strong>å…ˆå‰æ¸²æŸ“ä¸­çš„ä¿¡æ¯</strong>ã€‚<a href="#storing-information-from-previous-renders">è¯·å‚è§ä¸‹é¢çš„ç¤ºä¾‹</a>ã€‚<li><p>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸­ï¼ŒReact å°† <strong>ä¸¤æ¬¡è°ƒç”¨ä½ çš„æ›´æ–°å‡½æ•°</strong>ï¼Œä»¥å¸®åŠ©ä½ æ‰¾åˆ° <a href="#my-initializer-or-updater-function-runs-twice">æ„å¤–çš„ä¸çº¯æ€§</a>ã€‚è¿™åªæ˜¯å¼€å‘æ—¶çš„è¡Œä¸ºï¼Œä¸å½±å“ç”Ÿäº§ã€‚å¦‚æœä½ çš„æ›´æ–°å‡½æ•°æ˜¯çº¯å‡½æ•°ï¼ˆæœ¬è¯¥æ˜¯è¿™æ ·ï¼‰ï¼Œå°±ä¸åº”å½±å“è¯¥è¡Œä¸ºã€‚å…¶ä¸­ä¸€æ¬¡è°ƒç”¨çš„ç»“æœå°†è¢«å¿½ç•¥ã€‚</ul></section></section></section><section class="level2"aria-labelledby="ç”¨æ³•-usage"><h2 id="ç”¨æ³•-usage">ç”¨æ³• {/<em>usage</em>/}</h2><section class="level3"aria-labelledby="ä¸ºç»„ä»¶æ·»åŠ çŠ¶æ€-adding-state-to-a-component"><h3 id="ä¸ºç»„ä»¶æ·»åŠ çŠ¶æ€-adding-state-to-a-component">ä¸ºç»„ä»¶æ·»åŠ çŠ¶æ€ {/<em>adding-state-to-a-component</em>/}</h3><p>åœ¨ç»„ä»¶çš„é¡¶å±‚è°ƒç”¨ <code>useState</code> æ¥å£°æ˜ä¸€ä¸ªæˆ–å¤šä¸ª <a href="/learn/state-a-components-memory">çŠ¶æ€å˜é‡</a>ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyComponent</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Taylor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre><p>æŒ‰ç…§æƒ¯ä¾‹ä½¿ç”¨ <a href="https://javascript.info/destructuring-assignment">æ•°ç»„è§£æ„</a> æ¥å‘½åçŠ¶æ€å˜é‡ï¼Œä¾‹å¦‚ <code>[something, setSomething]</code>ã€‚<p><code>useState</code> è¿”å›ä¸€ä¸ªåªåŒ…å«ä¸¤ä¸ªé¡¹çš„æ•°ç»„ï¼š<ol><li>è¯¥çŠ¶æ€å˜é‡<codestep step="{1}">å½“å‰çš„ state</codestep>ï¼Œæœ€åˆè®¾ç½®ä¸ºä½ æä¾›çš„<codestep step="{3}">åˆå§‹åŒ– state</codestep>ã€‚<li><codestep step="{2}"><code>set</code> å‡½æ•°</codestep>ï¼Œå®ƒå…è®¸ä½ åœ¨å“åº”äº¤äº’æ—¶å°† state æ›´æ”¹ä¸ºä»»ä½•å…¶ä»–å€¼ã€‚</ol><p>è¦æ›´æ–°å±å¹•ä¸Šçš„å†…å®¹ï¼Œè¯·ä½¿ç”¨æ–°çŠ¶æ€è°ƒç”¨ <code>set</code> å‡½æ•°ï¼š<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">'Robin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>React ä¼šå­˜å‚¨æ–°çŠ¶æ€ï¼Œä½¿ç”¨æ–°å€¼é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Œå¹¶æ›´æ–° UIã€‚</p><pitfall><p>è°ƒç”¨ <code>set</code> å‡½æ•° <a href="#ive-updated-the-state-but-logging-gives-me-the-old-value"><strong>ä¸ä¼š</strong> æ”¹å˜å·²ç»æ‰§è¡Œçš„ä»£ç ä¸­å½“å‰çš„ state</a>ï¼š<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">'Robin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Still "Taylor"!</span>
<span class="token punctuation">}</span></code></pre><p>å®ƒåªå½±å“ <strong>ä¸‹ä¸€æ¬¡</strong> æ¸²æŸ“ä¸­ <code>useState</code> è¿”å›çš„å†…å®¹ã€‚</p></pitfall><recipes titletext="åŸºæœ¬çš„ useState ç¤ºä¾‹"titleid="examples-basic"><section class="level4"aria-labelledby="è®¡æ•°å™¨æ•°å­—-counter-number"><h4 id="è®¡æ•°å™¨æ•°å­—-counter-number">è®¡æ•°å™¨ï¼ˆæ•°å­—ï¼‰ {/<em>counter-number</em>/}</h4><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>count</code> çŠ¶æ€å˜é‡ä¿å­˜ä¸€ä¸ªæ•°å­—ã€‚ç‚¹å‡»æŒ‰é’®ä¼šå°†å…¶åŠ ä¸€ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Counter</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">></span>
      <span class="token maybe-class-name">You</span> pressed me <span class="token punctuation">{</span>count<span class="token punctuation">}</span> times
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section><section class="level4"aria-labelledby="æ–‡æœ¬å­—æ®µå­—ç¬¦ä¸²-text-field-string"><h4 id="æ–‡æœ¬å­—æ®µå­—ç¬¦ä¸²-text-field-string">æ–‡æœ¬å­—æ®µï¼ˆå­—ç¬¦ä¸²ï¼‰ {/<em>text-field-string</em>/}</h4><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>text</code> çŠ¶æ€å˜é‡ä¿å­˜ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å½“ä½ è¾“å…¥æ—¶ï¼Œ<code>handleChange</code> ä»æµè§ˆå™¨ input DOM å…ƒç´ ä¸­è¯»å–æœ€æ–°çš„è¾“å…¥å€¼ï¼Œå¹¶è°ƒç”¨ <code>setText</code> æ¥æ›´æ–°çŠ¶æ€ã€‚è¿™å…è®¸ä½ åœ¨ä¸‹é¢å±•ç¤ºå½“å‰çš„ <code>text</code>ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyInput</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setText</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">You</span> typed<span class="token operator">:</span> <span class="token punctuation">{</span>text<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Reset</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section><section class="level4"aria-labelledby="å¤é€‰æ¡†å¸ƒå°”å€¼-checkbox-boolean"><h4 id="å¤é€‰æ¡†å¸ƒå°”å€¼-checkbox-boolean">å¤é€‰æ¡†ï¼ˆå¸ƒå°”å€¼ï¼‰ {/<em>checkbox-boolean</em>/}</h4><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>liked</code> çŠ¶æ€å˜é‡ä¿å­˜ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å½“ä½ ç‚¹å‡» input æ—¶ï¼Œ<code>setLiked</code> ä¼šæ ¹æ®æµè§ˆå™¨å¤é€‰æ¡†æ˜¯å¦é€‰ä¸­æ¥æ›´æ–° <code>liked</code> çŠ¶æ€å˜é‡ã€‚<code>liked</code> å˜é‡ç”¨äºæ¸²æŸ“å¤é€‰æ¡†ä¸‹é¢çš„æ–‡æœ¬ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">MyCheckbox</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>liked<span class="token punctuation">,</span> setLiked<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setLiked</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">checked</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>input
          type<span class="token operator">=</span><span class="token string">"checkbox"</span>
          checked<span class="token operator">=</span><span class="token punctuation">{</span>liked<span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token constant">I</span> liked <span class="token keyword">this</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">You</span> <span class="token punctuation">{</span>liked <span class="token operator">?</span> <span class="token string">'liked'</span> <span class="token operator">:</span> <span class="token string">'did not like'</span><span class="token punctuation">}</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section><section class="level4"aria-labelledby="è¡¨å•ä¸¤ä¸ªå˜é‡-form-two-variables"><h4 id="è¡¨å•ä¸¤ä¸ªå˜é‡-form-two-variables">è¡¨å•ï¼ˆä¸¤ä¸ªå˜é‡ï¼‰ {/<em>form-two-variables</em>/}</h4><p>ä½ å¯ä»¥åœ¨åŒä¸€ä¸ªç»„ä»¶ä¸­å£°æ˜å¤šä¸ªçŠ¶æ€å˜é‡ã€‚æ¯ä¸ªçŠ¶æ€å˜é‡éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Taylor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input
        value<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setAge</span><span class="token punctuation">(</span>age <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Increment</span> age
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">Hello</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">.</span> <span class="token property-access"><span class="token maybe-class-name">You</span></span> are <span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section></recipes></section><section class="level3"aria-labelledby="æ ¹æ®å…ˆå‰çš„-state-æ›´æ–°-state-updating-state-based-on-the-previous-state"><h3 id="æ ¹æ®å…ˆå‰çš„-state-æ›´æ–°-state-updating-state-based-on-the-previous-state">æ ¹æ®å…ˆå‰çš„ state æ›´æ–° state {/<em>updating-state-based-on-the-previous-state</em>/}</h3><p>å‡è®¾ <code>age</code> ä¸º <code>42</code>ï¼Œè¿™ä¸ªå¤„ç†å‡½æ•°ä¸‰æ¬¡è°ƒç”¨ <code>setAge(age + 1)</code>ï¼š<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span>age <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// setAge(42 + 1)</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span>age <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// setAge(42 + 1)</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span>age <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// setAge(42 + 1)</span>
<span class="token punctuation">}</span></code></pre><p>ç„¶è€Œï¼Œç‚¹å‡»ä¸€æ¬¡åï¼Œ<code>age</code> å°†åªä¼šå˜ä¸º <code>43</code> è€Œä¸æ˜¯ <code>45</code>ï¼è¿™æ˜¯å› ä¸ºè°ƒç”¨ <code>set</code> å‡½æ•° <a href="/learn/state-as-a-snapshot">ä¸ä¼šæ›´æ–°</a> å·²ç»è¿è¡Œä»£ç ä¸­çš„ <code>age</code> çŠ¶æ€å˜é‡ã€‚å› æ­¤ï¼Œæ¯ä¸ª <code>setAge(age + 1)</code> è°ƒç”¨å˜æˆäº† <code>setAge(43)</code>ã€‚<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<strong>ä½ å¯ä»¥å‘ <code>setAge</code> ä¼ é€’ä¸€ä¸ª <em>æ›´æ–°å‡½æ•°</em></strong>ï¼Œè€Œä¸æ˜¯ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼š<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token arrow operator">=></span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// setAge(42 => 43)</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token arrow operator">=></span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// setAge(43 => 44)</span>
  <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token arrow operator">=></span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// setAge(44 => 45)</span>
<span class="token punctuation">}</span></code></pre><p>è¿™é‡Œï¼Œ<code>a => a + 1</code> æ˜¯æ›´æ–°å‡½æ•°ã€‚å®ƒè·å–<codestep step="{1}">å¾…å®šçŠ¶æ€</codestep>å¹¶ä»ä¸­è®¡ç®—<codestep step="{2}">ä¸‹ä¸€ä¸ªçŠ¶æ€</codestep>ã€‚<p>React å°†æ›´æ–°å‡½æ•°æ”¾å…¥ <a href="/learn/queueing-a-series-of-state-updates">é˜Ÿåˆ—</a> ä¸­ã€‚ç„¶åï¼Œåœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æœŸé—´ï¼Œå®ƒå°†æŒ‰ç…§ç›¸åŒçš„é¡ºåºè°ƒç”¨å®ƒä»¬ï¼š<ol><li><code>a => a + 1</code> å°†æ¥æ”¶ <code>42</code> ä½œä¸ºå¾…å®šçŠ¶æ€ï¼Œå¹¶è¿”å› <code>43</code> ä½œä¸ºä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚<li><code>a => a + 1</code> å°†æ¥æ”¶ <code>43</code> ä½œä¸ºå¾…å®šçŠ¶æ€ï¼Œå¹¶è¿”å› <code>44</code> ä½œä¸ºä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚<li><code>a => a + 1</code> å°†æ¥æ”¶ <code>44</code> ä½œä¸ºå¾…å®šçŠ¶æ€ï¼Œå¹¶è¿”å› <code>45</code> ä½œä¸ºä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚</ol><p>ç°åœ¨æ²¡æœ‰å…¶ä»–æ’é˜Ÿçš„æ›´æ–°ï¼Œå› æ­¤ React æœ€ç»ˆå°†å­˜å‚¨ <code>45</code> ä½œä¸ºå½“å‰çŠ¶æ€ã€‚<p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œé€šå¸¸å°†å¾…å®šçŠ¶æ€å‚æ•°å‘½åä¸ºçŠ¶æ€å˜é‡åç§°çš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œå¦‚ <code>age</code> ä¸º <code>a</code>ã€‚ç„¶è€Œï¼Œä½ ä¹Ÿå¯ä»¥æŠŠå®ƒå‘½åä¸º <code>prevAge</code> æˆ–è€…å…¶ä»–ä½ è§‰å¾—æ›´æ¸…æ¥šçš„åç§°ã€‚<p>React åœ¨å¼€å‘ç¯å¢ƒä¸­å¯èƒ½ä¼š <a href="#my-initializer-or-updater-function-runs-twice">ä¸¤æ¬¡è°ƒç”¨ä½ çš„æ›´æ–°å‡½æ•°</a> æ¥éªŒè¯å…¶æ˜¯å¦ä¸º <a href="/learn/keeping-components-pure">çº¯å‡½æ•°</a>ã€‚</p><deepdive><section class="level4"aria-labelledby="æ˜¯å¦æ€»æ˜¯ä¼˜å…ˆä½¿ç”¨æ›´æ–°å‡½æ•°-is-using-an-updater-always-preferred"><h4 id="æ˜¯å¦æ€»æ˜¯ä¼˜å…ˆä½¿ç”¨æ›´æ–°å‡½æ•°-is-using-an-updater-always-preferred">æ˜¯å¦æ€»æ˜¯ä¼˜å…ˆä½¿ç”¨æ›´æ–°å‡½æ•°ï¼Ÿ {/<em>is-using-an-updater-always-preferred</em>/}</h4><p>ä½ å¯èƒ½ä¼šå¬åˆ°è¿™æ ·çš„å»ºè®®ï¼Œå¦‚æœè¦è®¾ç½®çš„çŠ¶æ€æ˜¯æ ¹æ®å…ˆå‰çš„çŠ¶æ€è®¡ç®—å¾—å‡ºçš„ï¼Œåˆ™åº”å§‹ç»ˆç¼–å†™ç±»ä¼¼äº <code>setAge(a => a + 1)</code> çš„ä»£ç ã€‚è¿™æ ·åšæ²¡æœ‰å®³å¤„ï¼Œä½†ä¹Ÿä¸æ€»æ˜¯å¿…è¦çš„ã€‚<p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ç§æ–¹æ³•æ²¡æœ‰åŒºåˆ«ã€‚React å§‹ç»ˆç¡®ä¿å¯¹äºæœ‰æ„çš„ç”¨æˆ·æ“ä½œï¼Œå¦‚å•å‡»ï¼Œ<code>age</code> çŠ¶æ€å˜é‡å°†åœ¨ä¸‹ä¸€æ¬¡å•å‡»ä¹‹å‰è¢«æ›´æ–°ã€‚è¿™æ„å‘³ç€å•å‡»äº‹ä»¶å¤„ç†å‡½æ•°åœ¨äº‹ä»¶å¤„ç†å¼€å§‹æ²¡æœ‰å¾—åˆ°â€œè¿‡æ—¶â€ <code>age</code> çš„é£é™©ã€‚<p>ä½†æ˜¯ï¼Œå¦‚æœåœ¨åŒä¸€äº‹ä»¶ä¸­è¿›è¡Œå¤šä¸ªæ›´æ–°ï¼Œåˆ™æ›´æ–°å‡½æ•°å¯èƒ½ä¼šæœ‰å¸®åŠ©ã€‚å¦‚æœè®¿é—®çŠ¶æ€å˜é‡æœ¬èº«ä¸æ–¹ä¾¿ï¼ˆåœ¨ä¼˜åŒ–é‡æ–°æ¸²æŸ“æ—¶å¯èƒ½ä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼‰ï¼Œå®ƒä»¬ä¹Ÿå¾ˆæœ‰ç”¨ã€‚<p>å¦‚æœæ¯”èµ·è½»å¾®çš„å†—ä½™ä½ æ›´å–œæ¬¢è¯­æ³•çš„ä¸€è‡´æ€§ï¼Œä½ æ­£è®¾ç½®çš„çŠ¶æ€åˆæ˜¯æ ¹æ®å…ˆå‰çš„çŠ¶æ€è®¡ç®—å‡ºæ¥çš„ï¼Œé‚£ä¹ˆæ€»æ˜¯ç¼–å†™ä¸€ä¸ªæ›´æ–°å‡½æ•°æ˜¯åˆç†çš„ã€‚å¦‚æœå®ƒæ˜¯ä»æŸä¸ªå…¶ä»–çŠ¶æ€å˜é‡çš„å…ˆå‰çŠ¶æ€è®¡ç®—å‡ºçš„ï¼Œåˆ™ä½ å¯èƒ½å¸Œæœ›å°†å®ƒä»¬ç»“åˆæˆä¸€ä¸ªå¯¹è±¡ç„¶å <a href="/learn/extracting-state-logic-into-a-reducer">ä½¿ç”¨ reducer</a>ã€‚</p><recipes titletext="ä¼ é€’æ›´æ–°å‡½æ•°å’Œç›´æ¥ä¼ é€’ä¸‹ä¸€ä¸ªçŠ¶æ€ä¹‹é—´çš„åŒºåˆ«"titleid="examples-updater"></recipes></section><section class="level4"aria-labelledby="ä¼ é€’æ›´æ–°å‡½æ•°-passing-the-updater-function"><h4 id="ä¼ é€’æ›´æ–°å‡½æ•°-passing-the-updater-function">ä¼ é€’æ›´æ–°å‡½æ•° {/<em>passing-the-updater-function</em>/}</h4><p>è¿™ä¸ªä¾‹å­ä¼ é€’äº†æ›´æ–°å‡½æ•°ï¼Œå› æ­¤â€œ+3â€æŒ‰é’®å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Counter</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token arrow operator">=></span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Your</span> age<span class="token operator">:</span> <span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">+</span><span class="token number">3</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">h1</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section><section class="level4"aria-labelledby="ç›´æ¥ä¼ é€’ä¸‹ä¸€ä¸ªçŠ¶æ€-passing-the-next-state-directly"><h4 id="ç›´æ¥ä¼ é€’ä¸‹ä¸€ä¸ªçŠ¶æ€-passing-the-next-state-directly">ç›´æ¥ä¼ é€’ä¸‹ä¸€ä¸ªçŠ¶æ€ {/<em>passing-the-next-state-directly</em>/}</h4><p>è¿™ä¸ªç¤ºä¾‹ <strong>æ²¡æœ‰</strong> ä¼ é€’æ›´æ–°å‡½æ•°ï¼Œæ‰€ä»¥â€œ+3â€æŒ‰é’® <strong>ä¸èƒ½æŒ‰é¢„æœŸçš„æ–¹å¼å·¥ä½œ</strong>ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Counter</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setAge</span><span class="token punctuation">(</span>age <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Your</span> age<span class="token operator">:</span> <span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">+</span><span class="token number">3</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">h1</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section></deepdive></section><section class="level3"aria-labelledby="æ›´æ–°çŠ¶æ€ä¸­çš„å¯¹è±¡å’Œæ•°ç»„-updating-objects-and-arrays-in-state"><h3 id="æ›´æ–°çŠ¶æ€ä¸­çš„å¯¹è±¡å’Œæ•°ç»„-updating-objects-and-arrays-in-state">æ›´æ–°çŠ¶æ€ä¸­çš„å¯¹è±¡å’Œæ•°ç»„ {/<em>updating-objects-and-arrays-in-state</em>/}</h3><p>ä½ å¯ä»¥å°†å¯¹è±¡å’Œæ•°ç»„æ”¾å…¥çŠ¶æ€ä¸­ã€‚åœ¨ React ä¸­ï¼ŒçŠ¶æ€è¢«è®¤ä¸ºæ˜¯åªè¯»çš„ï¼Œå› æ­¤ <strong>ä½ åº”è¯¥æ›¿æ¢å®ƒè€Œä¸æ˜¯æ”¹å˜ç°æœ‰å¯¹è±¡</strong>ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨çŠ¶æ€ä¸­ä¿å­˜äº†ä¸€ä¸ª <code>form</code> å¯¹è±¡ï¼Œè¯·ä¸è¦æ”¹å˜å®ƒï¼š<pre class="language-js"><code class="language-js"><span class="token comment">// ğŸš© ä¸è¦åƒä¸‹é¢è¿™æ ·æ”¹å˜ä¸€ä¸ªå¯¹è±¡ï¼š</span>
form<span class="token punctuation">.</span><span class="token property-access">firstName</span> <span class="token operator">=</span> <span class="token string">'Taylor'</span><span class="token punctuation">;</span></code></pre><p>ç›¸åï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡æ¥æ›¿æ¢æ•´ä¸ªå¯¹è±¡ï¼š<pre class="language-js"><code class="language-js"><span class="token comment">// âœ… ä½¿ç”¨æ–°å¯¹è±¡æ›¿æ¢ state</span>
<span class="token function">setForm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token spread operator">...</span>form<span class="token punctuation">,</span>
  <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">'Taylor'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>é˜…è¯»æœ‰å…³ <a href="/learn/updating-objects-in-state">æ›´æ–°çŠ¶æ€ä¸­çš„å¯¹è±¡</a> å’Œ <a href="/learn/updating-arrays-in-state">æ›´æ–°çŠ¶æ€ä¸­çš„æ•°ç»„</a> æ¥äº†è§£æ›´å¤šã€‚</p><recipes titletext="çŠ¶æ€ä¸­çš„å¯¹è±¡å’Œæ•°ç»„çš„ç¤ºä¾‹"titleid="examples-objects"><section class="level4"aria-labelledby="è¡¨å•å¯¹è±¡form-object"><h4 id="è¡¨å•å¯¹è±¡form-object">è¡¨å•ï¼ˆå¯¹è±¡ï¼‰{/<em>form-object</em>/}</h4><p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ<code>form</code> çŠ¶æ€å˜é‡ä¿å­˜ä¸€ä¸ªå¯¹è±¡ã€‚æ¯ä¸ªè¾“å…¥æ¡†éƒ½æœ‰ä¸€ä¸ªå˜æ›´å¤„ç†å‡½æ•°ï¼Œç”¨æ•´ä¸ªè¡¨å•çš„ä¸‹ä¸€ä¸ªçŠ¶æ€è°ƒç”¨ <code>setForm</code>ã€‚<code>{ ...form }</code> å±•å¼€è¯­æ³•ç¡®ä¿æ›¿æ¢çŠ¶æ€å¯¹è±¡è€Œä¸æ˜¯æ”¹å˜å®ƒã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>form<span class="token punctuation">,</span> setForm<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">'Barbara'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">'Hepworth'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">'bhepworth@sculpture.com'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">First</span> name<span class="token operator">:</span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token property-access">firstName</span><span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
            <span class="token function">setForm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              <span class="token spread operator">...</span>form<span class="token punctuation">,</span>
              <span class="token literal-property property">firstName</span><span class="token operator">:</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token maybe-class-name">Last</span> name<span class="token operator">:</span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token property-access">lastName</span><span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
            <span class="token function">setForm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              <span class="token spread operator">...</span>form<span class="token punctuation">,</span>
              <span class="token literal-property property">lastName</span><span class="token operator">:</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token literal-property property">Email</span><span class="token operator">:</span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token property-access">email</span><span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
            <span class="token function">setForm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              <span class="token spread operator">...</span>form<span class="token punctuation">,</span>
              <span class="token literal-property property">email</span><span class="token operator">:</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span>
        <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token property-access">firstName</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token property-access">lastName</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        <span class="token punctuation">(</span><span class="token punctuation">{</span>form<span class="token punctuation">.</span><span class="token property-access">email</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section><section class="level4"aria-labelledby="è¡¨å•åµŒå¥—å¯¹è±¡form-nested-object"><h4 id="è¡¨å•åµŒå¥—å¯¹è±¡form-nested-object">è¡¨å•ï¼ˆåµŒå¥—å¯¹è±¡ï¼‰{/<em>form-nested-object</em>/}</h4><p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒçŠ¶æ€æ›´ä¸ºåµŒå¥—ã€‚å½“ä½ æ›´æ–°åµŒå¥—çŠ¶æ€æ—¶ï¼Œä½ éœ€è¦å¤åˆ¶ä¸€ä»½æ­£åœ¨æ›´æ–°çš„å¯¹è±¡ï¼Œä»¥åŠå‘ä¸Šâ€œåŒ…å«â€å®ƒçš„æ‰€æœ‰å¯¹è±¡ã€‚é˜…è¯» <a href="/learn/updating-objects-in-state#updating-a-nested-object">æ›´æ–°åµŒå¥—å¯¹è±¡</a> ä»¥äº†è§£æ›´å¤šã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>person<span class="token punctuation">,</span> setPerson<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Niki de Saint Phalle'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">artwork</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      # <span class="token string">'Blue Nana'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">city</span><span class="token operator">:</span> <span class="token string">'Hamburg'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token string">'https://i.imgur.com/Sd1AgUOm.jpg'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleNameChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setPerson</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token spread operator">...</span>person<span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">handleTitleChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setPerson</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token spread operator">...</span>person<span class="token punctuation">,</span>
      <span class="token literal-property property">artwork</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token spread operator">...</span>person<span class="token punctuation">.</span><span class="token property-access">artwork</span><span class="token punctuation">,</span>
        # e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">handleCityChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setPerson</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token spread operator">...</span>person<span class="token punctuation">,</span>
      <span class="token literal-property property">artwork</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token spread operator">...</span>person<span class="token punctuation">.</span><span class="token property-access">artwork</span><span class="token punctuation">,</span>
        <span class="token literal-property property">city</span><span class="token operator">:</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">handleImageChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setPerson</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token spread operator">...</span>person<span class="token punctuation">,</span>
      <span class="token literal-property property">artwork</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token spread operator">...</span>person<span class="token punctuation">.</span><span class="token property-access">artwork</span><span class="token punctuation">,</span>
        <span class="token literal-property property">image</span><span class="token operator">:</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token literal-property property">Name</span><span class="token operator">:</span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>person<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleNameChange<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token literal-property property">Title</span><span class="token operator">:</span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>person<span class="token punctuation">.</span><span class="token property-access">artwork</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleTitleChange<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token literal-property property">City</span><span class="token operator">:</span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>person<span class="token punctuation">.</span><span class="token property-access">artwork</span><span class="token punctuation">.</span><span class="token property-access">city</span><span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleCityChange<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
        <span class="token literal-property property">Image</span><span class="token operator">:</span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>person<span class="token punctuation">.</span><span class="token property-access">artwork</span><span class="token punctuation">.</span><span class="token property-access">image</span><span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleImageChange<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span>
        <span class="token operator">&#x3C;</span>i<span class="token operator">></span><span class="token punctuation">{</span>person<span class="token punctuation">.</span><span class="token property-access">artwork</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>i<span class="token operator">></span>
        <span class="token punctuation">{</span><span class="token string">' by '</span><span class="token punctuation">}</span>
        <span class="token punctuation">{</span>person<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>br <span class="token operator">/</span><span class="token operator">></span>
        <span class="token punctuation">(</span>located <span class="token keyword">in</span> <span class="token punctuation">{</span>person<span class="token punctuation">.</span><span class="token property-access">artwork</span><span class="token punctuation">.</span><span class="token property-access">city</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>img 
        src<span class="token operator">=</span><span class="token punctuation">{</span>person<span class="token punctuation">.</span><span class="token property-access">artwork</span><span class="token punctuation">.</span><span class="token property-access">image</span><span class="token punctuation">}</span> 
        alt<span class="token operator">=</span><span class="token punctuation">{</span>person<span class="token punctuation">.</span><span class="token property-access">artwork</span><span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">label</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">input</span> <span class="token punctuation">{</span> <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">img</span> <span class="token punctuation">{</span> <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section><section class="level4"aria-labelledby="åˆ—è¡¨æ•°ç»„-list-array"><h4 id="åˆ—è¡¨æ•°ç»„-list-array">åˆ—è¡¨ï¼ˆæ•°ç»„ï¼‰ {/<em>list-array</em>/}</h4><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œ<code>todos</code> çŠ¶æ€å˜é‡ä¿å­˜ä¸€ä¸ªæ•°ç»„ã€‚æ¯ä¸ªæŒ‰é’®çš„å¤„ç†å‡½æ•°ä½¿ç”¨è¯¥æ•°ç»„çš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬è°ƒç”¨ <code>setTodos</code>ã€‚<code>[...todos]</code> å±•å¼€è¯­æ³•ï¼Œ<code>todos.map()</code> å’Œ <code>todos.filter()</code> ç¡®ä¿çŠ¶æ€æ•°ç»„è¢«æ›¿æ¢è€Œä¸æ˜¯æ”¹å˜ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">AddTodo</span></span> <span class="token keyword module">from</span> <span class="token string">'./AddTodo.js'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">TaskList</span></span> <span class="token keyword module">from</span> <span class="token string">'./TaskList.js'</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> nextId <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> initialTodos <span class="token operator">=</span> <span class="token punctuation">[</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TaskApp</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialTodos<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleAddTodo</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTodos</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token spread operator">...</span>todos<span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        # title<span class="token punctuation">,</span>
        <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">handleChangeTodo</span><span class="token punctuation">(</span><span class="token parameter">nextTodo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTodos</span><span class="token punctuation">(</span>todos<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token property-access">id</span> <span class="token operator">===</span> nextTodo<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> nextTodo<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> t<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">handleDeleteTodo</span><span class="token punctuation">(</span><span class="token parameter">todoId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTodos</span><span class="token punctuation">(</span>
      todos<span class="token punctuation">.</span><span class="token method function property-access">filter</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token arrow operator">=></span> t<span class="token punctuation">.</span><span class="token property-access">id</span> <span class="token operator">!==</span> todoId<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">AddTodo</span>
        onAddTodo<span class="token operator">=</span><span class="token punctuation">{</span>handleAddTodo<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">TaskList</span>
        todos<span class="token operator">=</span><span class="token punctuation">{</span>todos<span class="token punctuation">}</span>
        onChangeTodo<span class="token operator">=</span><span class="token punctuation">{</span>handleChangeTodo<span class="token punctuation">}</span>
        onDeleteTodo<span class="token operator">=</span><span class="token punctuation">{</span>handleDeleteTodo<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">AddTodo</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> onAddTodo <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>title<span class="token punctuation">,</span> setTitle<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input
        placeholder<span class="token operator">=</span><span class="token string">"Add todo"</span>
        value<span class="token operator">=</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setTitle</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">onAddTodo</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Add</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TaskList</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>
  todos<span class="token punctuation">,</span>
  onChangeTodo<span class="token punctuation">,</span>
  onDeleteTodo
<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>ul<span class="token operator">></span>
      <span class="token punctuation">{</span>todos<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span><span class="token operator">></span>
          <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Task</span>
            todo<span class="token operator">=</span><span class="token punctuation">{</span>todo<span class="token punctuation">}</span>
            onChange<span class="token operator">=</span><span class="token punctuation">{</span>onChangeTodo<span class="token punctuation">}</span>
            onDelete<span class="token operator">=</span><span class="token punctuation">{</span>onDeleteTodo<span class="token punctuation">}</span>
          <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>li<span class="token operator">></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>ul<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Task</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> todo<span class="token punctuation">,</span> onChange<span class="token punctuation">,</span> onDelete <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isEditing<span class="token punctuation">,</span> setIsEditing<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> todoContent<span class="token punctuation">;</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>isEditing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    todoContent <span class="token operator">=</span> <span class="token punctuation">(</span>
      <span class="token operator">&#x3C;</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>input
          value<span class="token operator">=</span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
            <span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              <span class="token spread operator">...</span>todo<span class="token punctuation">,</span>
              # e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setIsEditing</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
          <span class="token maybe-class-name">Save</span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
    todoContent <span class="token operator">=</span> <span class="token punctuation">(</span>
      <span class="token operator">&#x3C;</span><span class="token operator">></span>
        <span class="token punctuation">{</span>todo<span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span>
        <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setIsEditing</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
          <span class="token maybe-class-name">Edit</span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input
        type<span class="token operator">=</span><span class="token string">"checkbox"</span>
        checked<span class="token operator">=</span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span><span class="token property-access">done</span><span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
          <span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token spread operator">...</span>todo<span class="token punctuation">,</span>
            <span class="token literal-property property">done</span><span class="token operator">:</span> e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">checked</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">{</span>todoContent<span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">onDelete</span><span class="token punctuation">(</span>todo<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Delete</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">li</span> <span class="token punctuation">{</span> <span class="token property">list-style-type</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">ul<span class="token punctuation">,</span> li</span> <span class="token punctuation">{</span> <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section><section class="level4"aria-labelledby="ç”¨-immer-ç¼–å†™ç®€æ´çš„æ›´æ–°é€»è¾‘-writing-concise-update-logic-with-immer"><h4 id="ç”¨-immer-ç¼–å†™ç®€æ´çš„æ›´æ–°é€»è¾‘-writing-concise-update-logic-with-immer">ç”¨ Immer ç¼–å†™ç®€æ´çš„æ›´æ–°é€»è¾‘ {/<em>writing-concise-update-logic-with-immer</em>/}</h4><p>å¦‚æœä¸èƒ½ç›´æ¥æ”¹å˜æ•°ç»„å’Œå¯¹è±¡æ¥è¿›è¡Œæ›´æ–°æ„Ÿè§‰å¾ˆçƒ¦çï¼Œä½ å¯ä»¥ä½¿ç”¨åƒ <a href="https://github.com/immerjs/use-immer">Immer</a> è¿™æ ·çš„åº“æ¥å‡å°‘é‡å¤çš„ä»£ç ã€‚Immer å¯ä»¥è®©ä½ ç¼–å†™ç®€æ´çš„ä»£ç ï¼Œå°±åƒä½ å¯ä»¥ç›´æ¥æ”¹å˜å¯¹è±¡ä¸€æ ·ï¼Œä½†åœ¨åº•å±‚å®ƒæ‰§è¡Œçš„æ˜¯ä¸æ”¹å˜çš„æ›´æ–°ï¼š</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useImmer <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'use-immer'</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> nextId <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> initialList <span class="token operator">=</span> <span class="token punctuation">[</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">BucketList</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>list<span class="token punctuation">,</span> updateList<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useImmer</span><span class="token punctuation">(</span>initialList<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleToggle</span><span class="token punctuation">(</span><span class="token parameter">artworkId<span class="token punctuation">,</span> nextSeen</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">updateList</span><span class="token punctuation">(</span><span class="token parameter">draft</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> artwork <span class="token operator">=</span> draft<span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token parameter">a</span> <span class="token arrow operator">=></span>
        a<span class="token punctuation">.</span><span class="token property-access">id</span> <span class="token operator">===</span> artworkId
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      artwork<span class="token punctuation">.</span><span class="token property-access">seen</span> <span class="token operator">=</span> nextSeen<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token maybe-class-name">Art</span> <span class="token maybe-class-name">Bucket</span> <span class="token maybe-class-name">List</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h2<span class="token operator">></span><span class="token maybe-class-name">My</span> list <span class="token keyword">of</span> art to see<span class="token operator">:</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h2<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">ItemList</span>
        artworks<span class="token operator">=</span><span class="token punctuation">{</span>list<span class="token punctuation">}</span>
        onToggle<span class="token operator">=</span><span class="token punctuation">{</span>handleToggle<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ItemList</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> artworks<span class="token punctuation">,</span> onToggle <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span>ul<span class="token operator">></span>
      <span class="token punctuation">{</span>artworks<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">artwork</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>artwork<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span><span class="token operator">></span>
          <span class="token operator">&#x3C;</span>label<span class="token operator">></span>
            <span class="token operator">&#x3C;</span>input
              type<span class="token operator">=</span><span class="token string">"checkbox"</span>
              checked<span class="token operator">=</span><span class="token punctuation">{</span>artwork<span class="token punctuation">.</span><span class="token property-access">seen</span><span class="token punctuation">}</span>
              onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
                <span class="token function">onToggle</span><span class="token punctuation">(</span>
                  artwork<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">,</span>
                  e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">checked</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">}</span>
            <span class="token operator">/</span><span class="token operator">></span>
            <span class="token punctuation">{</span>artwork<span class="token punctuation">.</span><span class="token property-access">title</span><span class="token punctuation">}</span>
          <span class="token operator">&#x3C;</span><span class="token operator">/</span>label<span class="token operator">></span>
        <span class="token operator">&#x3C;</span><span class="token operator">/</span>li<span class="token operator">></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>ul<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"immer"</span><span class="token operator">:</span> <span class="token string">"1.7.3"</span><span class="token punctuation">,</span>
    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>
    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>
    <span class="token property">"react-scripts"</span><span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>
    <span class="token property">"use-immer"</span><span class="token operator">:</span> <span class="token string">"0.5.1"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"react-scripts start"</span><span class="token punctuation">,</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"react-scripts build"</span><span class="token punctuation">,</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"react-scripts test --env=jsdom"</span><span class="token punctuation">,</span>
    <span class="token property">"eject"</span><span class="token operator">:</span> <span class="token string">"react-scripts eject"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section></recipes></section><section class="level3"aria-labelledby="é¿å…é‡å¤åˆ›å»ºåˆå§‹çŠ¶æ€-avoiding-recreating-the-initial-state"><h3 id="é¿å…é‡å¤åˆ›å»ºåˆå§‹çŠ¶æ€-avoiding-recreating-the-initial-state">é¿å…é‡å¤åˆ›å»ºåˆå§‹çŠ¶æ€ {/<em>avoiding-recreating-the-initial-state</em>/}</h3><p>React åªåœ¨åˆæ¬¡æ¸²æŸ“æ—¶ä¿å­˜åˆå§‹çŠ¶æ€ï¼Œåç»­æ¸²æŸ“æ—¶å°†å…¶å¿½ç•¥ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TodoList</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token function">createInitialTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre><p>å°½ç®¡ <code>createInitialTodos()</code> çš„ç»“æœä»…ç”¨äºåˆå§‹æ¸²æŸ“ï¼Œä½†ä½ ä»ç„¶åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶è°ƒç”¨æ­¤å‡½æ•°ã€‚å¦‚æœå®ƒåˆ›å»ºå¤§æ•°ç»„æˆ–æ‰§è¡Œæ˜‚è´µçš„è®¡ç®—ï¼Œè¿™å¯èƒ½ä¼šæµªè´¹èµ„æºã€‚<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥å°†å®ƒ <strong>ä½œä¸ºåˆå§‹åŒ–å‡½æ•°ä¼ é€’ç»™</strong> <code>useState</code>ï¼š<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TodoList</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>createInitialTodos<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre><p>è¯·æ³¨æ„ï¼Œä½ ä¼ é€’çš„æ˜¯ <code>createInitialTodos</code> <strong>å‡½æ•°æœ¬èº«</strong>ï¼Œè€Œä¸æ˜¯ <code>createInitialTodos()</code> è°ƒç”¨è¯¥å‡½æ•°çš„ç»“æœã€‚å¦‚æœå°†å‡½æ•°ä¼ é€’ç»™ <code>useState</code>ï¼ŒReact ä»…åœ¨åˆå§‹åŒ–æœŸé—´è°ƒç”¨å®ƒã€‚<p>React åœ¨å¼€å‘æ¨¡å¼ä¸‹å¯èƒ½ä¼šè°ƒç”¨ä½ çš„ <a href="#my-initializer-or-updater-function-runs-twice">åˆå§‹åŒ–å‡½æ•°</a> ä¸¤æ¬¡ï¼Œä»¥éªŒè¯å®ƒä»¬æ˜¯å¦æ˜¯ <a href="/learn/keeping-components-pure">çº¯å‡½æ•°</a>ã€‚</p><recipes titletext="ä¼ é€’åˆå§‹åŒ–å‡½æ•°å’Œç›´æ¥ä¼ é€’åˆå§‹çŠ¶æ€ä¹‹é—´çš„åŒºåˆ«"titleid="examples-initializer"><section class="level4"aria-labelledby="ä¼ é€’åˆå§‹åŒ–å‡½æ•°-passing-the-initializer-function"><h4 id="ä¼ é€’åˆå§‹åŒ–å‡½æ•°-passing-the-initializer-function">ä¼ é€’åˆå§‹åŒ–å‡½æ•° {/<em>passing-the-initializer-function</em>/}</h4><p>è¿™ä¸ªä¾‹å­ä¼ é€’äº†åˆå§‹åŒ–å‡½æ•°ï¼Œå› æ­¤ <code>createInitialTodos</code> å‡½æ•°ä»…åœ¨åˆå§‹åŒ–æœŸé—´è¿è¡Œã€‚å½“ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œä¾‹å¦‚ä½ åœ¨è¾“å…¥æ¡†ä¸­é”®å…¥å†…å®¹æ—¶ï¼Œå®ƒä¸ä¼šå†æ¬¡è¿è¡Œã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">createInitialTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> initialTodos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&#x3C;</span> <span class="token number">50</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    initialTodos<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'Item '</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> initialTodos<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TodoList</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>createInitialTodos<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input
        value<span class="token operator">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setText</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setTodos</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> text
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token spread operator">...</span>todos<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Add</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>ul<span class="token operator">></span>
        <span class="token punctuation">{</span>todos<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
          <span class="token operator">&#x3C;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span><span class="token operator">></span>
            <span class="token punctuation">{</span>item<span class="token punctuation">.</span><span class="token property-access">text</span><span class="token punctuation">}</span>
          <span class="token operator">&#x3C;</span><span class="token operator">/</span>li<span class="token operator">></span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>ul<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section><section class="level4"aria-labelledby="ç›´æ¥ä¼ é€’åˆå§‹çŠ¶æ€-passing-the-initial-state-directly"><h4 id="ç›´æ¥ä¼ é€’åˆå§‹çŠ¶æ€-passing-the-initial-state-directly">ç›´æ¥ä¼ é€’åˆå§‹çŠ¶æ€ {/<em>passing-the-initial-state-directly</em>/}</h4><p>è¿™ä¸ªä¾‹å­ <strong>æ²¡æœ‰</strong> ä¼ é€’åˆå§‹åŒ–å‡½æ•°ï¼Œå› æ­¤ <code>createInitialTodos</code> å‡½æ•°ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶è¿è¡Œï¼Œæ¯”å¦‚å½“ä½ åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ—¶ã€‚è¿™ç§è¡Œä¸ºæ²¡æœ‰ä»€ä¹ˆæ˜æ˜¾çš„å·®å¼‚ï¼Œä½†è¿™ç§ä»£ç æ˜¯ä¸é‚£ä¹ˆé«˜æ•ˆçš„ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">createInitialTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> initialTodos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&#x3C;</span> <span class="token number">50</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    initialTodos<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'Item '</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> initialTodos<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TodoList</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token function">createInitialTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input
        value<span class="token operator">=</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setText</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setTodos</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
          <span class="token literal-property property">text</span><span class="token operator">:</span> text
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token spread operator">...</span>todos<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Add</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>ul<span class="token operator">></span>
        <span class="token punctuation">{</span>todos<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token arrow operator">=></span> <span class="token punctuation">(</span>
          <span class="token operator">&#x3C;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span><span class="token operator">></span>
            <span class="token punctuation">{</span>item<span class="token punctuation">.</span><span class="token property-access">text</span><span class="token punctuation">}</span>
          <span class="token operator">&#x3C;</span><span class="token operator">/</span>li<span class="token operator">></span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>ul<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></sandpack><solution></solution></section></recipes></section><section class="level3"aria-labelledby="ä½¿ç”¨-key-é‡ç½®çŠ¶æ€-resetting-state-with-a-key"><h3 id="ä½¿ç”¨-key-é‡ç½®çŠ¶æ€-resetting-state-with-a-key">ä½¿ç”¨ key é‡ç½®çŠ¶æ€ {/<em>resetting-state-with-a-key</em>/}</h3><p>åœ¨ <a href="/learn/rendering-lists">æ¸²æŸ“åˆ—è¡¨</a> æ—¶ï¼Œä½ ç»å¸¸ä¼šé‡åˆ° <code>key</code> å±æ€§ã€‚ç„¶è€Œï¼Œå®ƒè¿˜æœ‰å¦å¤–ä¸€ä¸ªç”¨é€”ã€‚<p>ä½ å¯ä»¥ <strong>é€šè¿‡å‘ç»„ä»¶ä¼ é€’ä¸åŒçš„ <code>key</code> æ¥é‡ç½®ç»„ä»¶çš„çŠ¶æ€</strong>ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé‡ç½®æŒ‰é’®æ”¹å˜ <code>version</code> çŠ¶æ€å˜é‡ï¼Œæˆ‘ä»¬å°†å®ƒä½œä¸ºä¸€ä¸ª <code>key</code> ä¼ é€’ç»™ <code>Form</code> ç»„ä»¶ã€‚å½“ <code>key</code> æ”¹å˜æ—¶ï¼ŒReact ä¼šä»å¤´å¼€å§‹é‡æ–°åˆ›å»º <code>Form</code> ç»„ä»¶ï¼ˆä»¥åŠå®ƒçš„æ‰€æœ‰å­ç»„ä»¶ï¼‰ï¼Œæ‰€ä»¥å®ƒçš„çŠ¶æ€è¢«é‡ç½®äº†ã€‚<p>é˜…è¯» <a href="/learn/preserving-and-resetting-state">ä¿ç•™å’Œé‡ç½®çŠ¶æ€</a> ä»¥äº†è§£æ›´å¤šã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>version<span class="token punctuation">,</span> setVersion<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleReset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setVersion</span><span class="token punctuation">(</span>version <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleReset<span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Reset</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">Form</span> key<span class="token operator">=</span><span class="token punctuation">{</span>version<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">Form</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Taylor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>input
        value<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span>
        onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token arrow operator">=></span> <span class="token function">setName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">Hello</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack></section><section class="level3"aria-labelledby="å­˜å‚¨å‰ä¸€æ¬¡æ¸²æŸ“çš„ä¿¡æ¯-storing-information-from-previous-renders"><h3 id="å­˜å‚¨å‰ä¸€æ¬¡æ¸²æŸ“çš„ä¿¡æ¯-storing-information-from-previous-renders">å­˜å‚¨å‰ä¸€æ¬¡æ¸²æŸ“çš„ä¿¡æ¯ {/<em>storing-information-from-previous-renders</em>/}</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ ä¼šåœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­æ›´æ–°çŠ¶æ€ã€‚ç„¶è€Œï¼Œåœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›åœ¨å“åº”æ¸²æŸ“æ—¶è°ƒæ•´çŠ¶æ€â€”â€”ä¾‹å¦‚ï¼Œå½“ props æ”¹å˜æ—¶ï¼Œä½ å¯èƒ½å¸Œæœ›æ”¹å˜çŠ¶æ€å˜é‡ã€‚<p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦è¿™æ ·åšï¼š<ul><li><strong>å¦‚æœä½ éœ€è¦çš„å€¼å¯ä»¥å®Œå…¨ä»å½“å‰ props æˆ–å…¶ä»– state ä¸­è®¡ç®—å‡ºæ¥ï¼Œé‚£ä¹ˆ <a href="/learn/choosing-the-state-structure#avoid-redundant-state">å®Œå…¨å¯ä»¥ç§»é™¤é‚£äº›å¤šä½™çš„çŠ¶æ€</a></strong>ã€‚å¦‚æœä½ æ‹…å¿ƒé‡æ–°è®¡ç®—çš„é¢‘ç‡è¿‡é«˜ï¼Œå¯ä»¥ä½¿ç”¨ <a href="/reference/react/useMemo"><code>useMemo</code> Hook</a> æ¥å¸®åŠ©ä¼˜åŒ–ã€‚<li>å¦‚æœä½ æƒ³é‡ç½®æ•´ä¸ªç»„ä»¶æ ‘çš„çŠ¶æ€ï¼Œ<a href="#resetting-state-with-a-key">å¯ä»¥å‘ç»„ä»¶ä¼ é€’ä¸€ä¸ªä¸åŒçš„ <code>key</code></a>ã€‚<li>å¦‚æœå¯ä»¥çš„è¯ï¼Œåœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­æ›´æ–°æ‰€æœ‰ç›¸å…³çŠ¶æ€ã€‚</ul><p>åœ¨æä¸ºç½•è§çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä¸Šè¿°æ–¹æ³•éƒ½ä¸é€‚ç”¨ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ä¸€ç§æ–¹å¼ï¼Œåœ¨ç»„ä»¶æ¸²æŸ“æ—¶è°ƒç”¨ <code>set</code> å‡½æ•°æ¥åŸºäºå·²ç»æ¸²æŸ“çš„å€¼æ›´æ–°çŠ¶æ€ã€‚<p>è¿™é‡Œæ˜¯ä¸€ä¸ªä¾‹å­ã€‚è¿™ä¸ª <code>CountLabel</code> ç»„ä»¶æ˜¾ç¤ºä¼ é€’ç»™å®ƒçš„ <code>count</code> propsï¼š<pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">CountLabel</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> count <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
<span class="token punctuation">}</span></code></pre><p>å‡è®¾ä½ æƒ³æ˜¾ç¤ºè®¡æ•°å™¨æ˜¯å¦è‡ªä¸Šæ¬¡æ›´æ”¹ä»¥æ¥ <strong>å¢åŠ æˆ–å‡å°‘</strong>ã€‚<code>count</code> props æ— æ³•å‘Šè¯‰ä½ è¿™ä¸€ç‚¹â€”â€”ä½ éœ€è¦è·Ÿè¸ªå®ƒçš„å…ˆå‰å€¼ã€‚æ·»åŠ  <code>prevCount</code> çŠ¶æ€å˜é‡æ¥è·Ÿè¸ªå®ƒï¼Œå†æ·»åŠ å¦ä¸€ä¸ªçŠ¶æ€å˜é‡ <code>trend</code> æ¥ä¿å­˜è®¡æ•°æ˜¯å¦å¢åŠ æˆ–å‡å°‘ã€‚æ¯”è¾ƒ <code>prevCount</code> å’Œ <code>count</code>ï¼Œå¦‚æœå®ƒä»¬ä¸ç›¸ç­‰ï¼Œåˆ™æ›´æ–° <code>prevCount</code> å’Œ <code>trend</code>ã€‚ç°åœ¨ä½ æ—¢å¯ä»¥æ˜¾ç¤ºå½“å‰çš„ <code>count</code> propsï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤º <strong>è‡ªä¸Šæ¬¡æ¸²æŸ“ä»¥æ¥å®ƒå¦‚ä½•æ”¹å˜</strong>ã€‚</p><sandpack><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">CountLabel</span></span> <span class="token keyword module">from</span> <span class="token string">'./CountLabel.js'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Increment</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token maybe-class-name">Decrement</span>
      <span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>
      <span class="token operator">&#x3C;</span><span class="token maybe-class-name">CountLabel</span> count<span class="token operator">=</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-js"><code class="language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">CountLabel</span></span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> count <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>prevCount<span class="token punctuation">,</span> setPrevCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>trend<span class="token punctuation">,</span> setTrend<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>prevCount <span class="token operator">!==</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setPrevCount</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTrend</span><span class="token punctuation">(</span>count <span class="token operator">></span> prevCount <span class="token operator">?</span> <span class="token string">'increasing'</span> <span class="token operator">:</span> <span class="token string">'decreasing'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&#x3C;</span><span class="token operator">></span>
      <span class="token operator">&#x3C;</span>h1<span class="token operator">></span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>h1<span class="token operator">></span>
      <span class="token punctuation">{</span>trend <span class="token operator">&#x26;&#x26;</span> <span class="token operator">&#x3C;</span>p<span class="token operator">></span><span class="token maybe-class-name">The</span> count is <span class="token punctuation">{</span>trend<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">}</span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">button</span> <span class="token punctuation">{</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></sandpack><p>è¯·æ³¨æ„ï¼Œåœ¨æ¸²æŸ“æ—¶è°ƒç”¨ <code>set</code> å‡½æ•°æ—¶ï¼Œå®ƒå¿…é¡»ä½äºæ¡ä»¶è¯­å¥ä¸­ï¼Œä¾‹å¦‚ <code>prevCount !== count</code>ï¼Œå¹¶ä¸”å¿…é¡»åœ¨è¯¥æ¡ä»¶è¯­å¥ä¸­è°ƒç”¨ <code>setPrevCount(count)</code>ã€‚å¦åˆ™ï¼Œä½ çš„ç»„ä»¶å°†åœ¨å¾ªç¯ä¸­é‡æ–°æ¸²æŸ“ï¼Œç›´åˆ°å´©æºƒã€‚æ­¤å¤–ï¼Œä½ åªèƒ½åƒè¿™æ ·æ›´æ–° <strong>å½“å‰æ¸²æŸ“</strong> ç»„ä»¶çš„çŠ¶æ€ã€‚åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­è°ƒç”¨ <strong>å¦ä¸€ä¸ª</strong> ç»„ä»¶çš„ <code>set</code> å‡½æ•°æ˜¯é”™è¯¯çš„ã€‚æœ€åï¼Œä½ çš„ <code>set</code> è°ƒç”¨ä»åº” <a href="#updating-objects-and-arrays-in-state">ä¸ç›´æ¥æ”¹å˜ state æ¥æ›´æ–°</a> çŠ¶æ€â€”â€”è¿™å¹¶ä¸æ„å‘³ç€ä½ å¯ä»¥è¿åå…¶ä»– <a href="/learn/keeping-components-pure">çº¯å‡½æ•°</a> çš„è§„åˆ™ã€‚<p>è¿™ç§æ–¹å¼å¯èƒ½å¾ˆéš¾ç†è§£ï¼Œé€šå¸¸æœ€å¥½é¿å…ä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œå®ƒæ¯”åœ¨ effect ä¸­æ›´æ–°çŠ¶æ€è¦å¥½ã€‚å½“ä½ åœ¨æ¸²æŸ“æœŸé—´è°ƒç”¨ <code>set</code> å‡½æ•°æ—¶ï¼ŒReact å°†åœ¨ä½ çš„ç»„ä»¶ä½¿ç”¨ <code>return</code> è¯­å¥é€€å‡ºåç«‹å³é‡æ–°æ¸²æŸ“è¯¥ç»„ä»¶ï¼Œå¹¶åœ¨æ¸²æŸ“å­ç»„ä»¶å‰è¿›è¡Œã€‚è¿™æ ·ï¼Œå­ç»„ä»¶å°±ä¸éœ€è¦è¿›è¡Œä¸¤æ¬¡æ¸²æŸ“ã€‚ä½ çš„ç»„ä»¶å‡½æ•°çš„å…¶ä½™éƒ¨åˆ†ä»ä¼šæ‰§è¡Œï¼ˆç„¶åç»“æœå°†è¢«ä¸¢å¼ƒï¼‰ã€‚å¦‚æœä½ çš„æ¡ä»¶åˆ¤æ–­åœ¨æ‰€æœ‰ Hook è°ƒç”¨çš„ä¸‹æ–¹ï¼Œå¯ä»¥æå‰æ·»åŠ ä¸€ä¸ª <code>return;</code> ä»¥ä¾¿æ›´æ—©åœ°é‡æ–°å¼€å§‹æ¸²æŸ“ã€‚</section></section><section class="level2"aria-labelledby="ç–‘éš¾è§£ç­”-troubleshooting"><h2 id="ç–‘éš¾è§£ç­”-troubleshooting">ç–‘éš¾è§£ç­” {/<em>troubleshooting</em>/}</h2><section class="level3"aria-labelledby="æˆ‘å·²ç»æ›´æ–°äº†çŠ¶æ€ä½†æ—¥å¿—ä»æ˜¾ç¤ºæ—§å€¼-ive-updated-the-state-but-logging-gives-me-the-old-value"><h3 id="æˆ‘å·²ç»æ›´æ–°äº†çŠ¶æ€ä½†æ—¥å¿—ä»æ˜¾ç¤ºæ—§å€¼-ive-updated-the-state-but-logging-gives-me-the-old-value">æˆ‘å·²ç»æ›´æ–°äº†çŠ¶æ€ï¼Œä½†æ—¥å¿—ä»æ˜¾ç¤ºæ—§å€¼ {/<em>ive-updated-the-state-but-logging-gives-me-the-old-value</em>/}</h3><p>è°ƒç”¨ <code>set</code> å‡½æ•° <strong>ä¸èƒ½æ”¹å˜è¿è¡Œä¸­ä»£ç çš„çŠ¶æ€</strong>ï¼š<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 0</span>

  <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¯·æ±‚ä½¿ç”¨ 1 é‡æ–°æ¸²æŸ“</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ä»ç„¶æ˜¯ 0!</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿˜æ˜¯ 0!</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>è¿™æ˜¯å› ä¸º <a href="/learn/state-as-a-snapshot">çŠ¶æ€è¡¨ç°ä¸ºå°±åƒä¸€ä¸ªå¿«ç…§</a>ã€‚æ›´æ–°çŠ¶æ€ä¼šä½¿ç”¨æ–°çš„çŠ¶æ€å€¼è¯·æ±‚å¦ä¸€ä¸ªæ¸²æŸ“ï¼Œä½†å¹¶ä¸å½±å“åœ¨ä½ å·²ç»è¿è¡Œçš„äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ <code>count</code> JavaScript å˜é‡ã€‚<p>å¦‚æœä½ éœ€è¦ä½¿ç”¨ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨å°†å…¶ä¼ é€’ç»™ <code>set</code> å‡½æ•°ä¹‹å‰å°†å…¶ä¿å­˜åœ¨ä¸€ä¸ªå˜é‡ä¸­ï¼š<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> nextCount <span class="token operator">=</span> count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">setCount</span><span class="token punctuation">(</span>nextCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 0</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>nextCount<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span></code></pre></section><section class="level3"aria-labelledby="æˆ‘å·²ç»æ›´æ–°äº†çŠ¶æ€ä½†æ˜¯å±å¹•æ²¡æœ‰æ›´æ–°-ive-updated-the-state-but-the-screen-doesnt-update"><h3 id="æˆ‘å·²ç»æ›´æ–°äº†çŠ¶æ€ä½†æ˜¯å±å¹•æ²¡æœ‰æ›´æ–°-ive-updated-the-state-but-the-screen-doesnt-update">æˆ‘å·²ç»æ›´æ–°äº†çŠ¶æ€ï¼Œä½†æ˜¯å±å¹•æ²¡æœ‰æ›´æ–° {/<em>ive-updated-the-state-but-the-screen-doesnt-update</em>/}</h3><p><strong>å¦‚æœä¸‹ä¸€ä¸ªçŠ¶æ€ç­‰äºå…ˆå‰çš„çŠ¶æ€ï¼ŒReact å°†å¿½ç•¥ä½ çš„æ›´æ–°</strong>ï¼Œè¿™æ˜¯ç”± <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is"><code>Object.is</code></a> æ¯”è¾ƒç¡®å®šçš„ã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨ä½ ç›´æ¥æ›´æ”¹çŠ¶æ€ä¸­çš„å¯¹è±¡æˆ–æ•°ç»„æ—¶ï¼š<pre class="language-js"><code class="language-js">obj<span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  <span class="token comment">// ğŸš© é”™è¯¯ï¼šç›´æ¥ä¿®æ”¹ç°æœ‰çš„å¯¹è±¡</span>
<span class="token function">setObj</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš© ä¸ä¼šå‘ç”Ÿä»»ä½•äº‹æƒ…</span></code></pre><p>ä½ ä¿®æ”¹äº†ä¸€ä¸ªç°æœ‰çš„ <code>obj</code> å¯¹è±¡å¹¶å°†å…¶ä¼ é€’å› <code>setObj</code>ï¼Œå› æ­¤ React å¿½ç•¥äº†æ›´æ–°ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ éœ€è¦ç¡®ä¿å§‹ç»ˆ<a href="#updating-objects-and-arrays-in-state">åœ¨çŠ¶æ€ä¸­ <strong>æ›¿æ¢</strong> å¯¹è±¡å’Œæ•°ç»„ï¼Œè€Œä¸æ˜¯å¯¹å®ƒä»¬è¿›è¡Œ <strong>æ›´æ”¹</strong></a>ï¼š<pre class="language-js"><code class="language-js"><span class="token comment">// âœ… æ­£ç¡®ï¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡</span>
<span class="token function">setObj</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token spread operator">...</span>obj<span class="token punctuation">,</span>
  <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></section><section class="level3"aria-labelledby="å‡ºç°é”™è¯¯too-many-re-renders-im-getting-an-error-too-many-re-renders"><h3 id="å‡ºç°é”™è¯¯too-many-re-renders-im-getting-an-error-too-many-re-renders">å‡ºç°é”™è¯¯ï¼šâ€œToo many re-rendersâ€ {/<em>im-getting-an-error-too-many-re-renders</em>/}</h3><p>æœ‰æ—¶å¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼šâ€œToo many re-rendersâ€ã€‚React ä¼šé™åˆ¶æ¸²æŸ“æ¬¡æ•°ï¼Œä»¥é˜²æ­¢è¿›å…¥æ— é™å¾ªç¯ã€‚é€šå¸¸ï¼Œè¿™æ„å‘³ç€ <strong>åœ¨æ¸²æŸ“æœŸé—´</strong> æ— æ¡ä»¶åœ°è®¾ç½®çŠ¶æ€ï¼Œå› æ­¤ç»„ä»¶è¿›å…¥å¾ªç¯ï¼šæ¸²æŸ“ã€è®¾ç½®çŠ¶æ€ï¼ˆå¯¼è‡´é‡æ–°æ¸²æŸ“ï¼‰ã€æ¸²æŸ“ã€è®¾ç½®çŠ¶æ€ï¼ˆå¯¼è‡´é‡æ–°æ¸²æŸ“ï¼‰ç­‰ç­‰ã€‚é€šå¸¸ï¼Œè¿™æ˜¯ç”±é”™è¯¯åœ°æŒ‡å®šäº‹ä»¶å¤„ç†å‡½æ•°æ—¶å¼•èµ·çš„ï¼š<pre class="language-js"><code class="language-js"><span class="token comment">// ğŸš© é”™è¯¯ï¼šåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°</span>
<span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Click</span> me<span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>

<span class="token comment">// âœ… æ­£ç¡®ï¼šå°†äº‹ä»¶å¤„ç†å‡½æ•°ä¼ é€’ä¸‹å»</span>
<span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Click</span> me<span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span>

<span class="token comment">// âœ… æ­£ç¡®ï¼šä¼ é€’ä¸€ä¸ªå†…è”å‡½æ•°</span>
<span class="token keyword control-flow">return</span> <span class="token operator">&#x3C;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">handleClick</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token maybe-class-name">Click</span> me<span class="token operator">&#x3C;</span><span class="token operator">/</span>button<span class="token operator">></span></code></pre><p>å¦‚æœæ‰¾ä¸åˆ°è¿™ä¸ªé”™è¯¯çš„åŸå› ï¼Œè¯·å•å‡»æ§åˆ¶å°ä¸­é”™è¯¯æ—è¾¹çš„ç®­å¤´ï¼ŒæŸ¥çœ‹ JavaScript å †æ ˆä»¥æ‰¾åˆ°å¯¼è‡´é”™è¯¯çš„å…·ä½“ <code>set</code> å‡½æ•°è°ƒç”¨ã€‚</section><section class="level3"aria-labelledby="åˆå§‹åŒ–å‡½æ•°æˆ–æ›´æ–°å‡½æ•°è¿è¡Œäº†ä¸¤æ¬¡-my-initializer-or-updater-function-runs-twice"><h3 id="åˆå§‹åŒ–å‡½æ•°æˆ–æ›´æ–°å‡½æ•°è¿è¡Œäº†ä¸¤æ¬¡-my-initializer-or-updater-function-runs-twice">åˆå§‹åŒ–å‡½æ•°æˆ–æ›´æ–°å‡½æ•°è¿è¡Œäº†ä¸¤æ¬¡ {/<em>my-initializer-or-updater-function-runs-twice</em>/}</h3><p>åœ¨ <a href="/reference/react/StrictMode">ä¸¥æ ¼æ¨¡å¼</a> ä¸‹ï¼ŒReact ä¼šè°ƒç”¨ä½ çš„æŸäº›å‡½æ•°ä¸¤æ¬¡è€Œä¸æ˜¯ä¸€æ¬¡ï¼š<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">TodoList</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¯¥å‡½æ•°ç»„ä»¶ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“è¿è¡Œä¸¤æ¬¡ã€‚</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// è¯¥åˆå§‹åŒ–å‡½æ•°åœ¨åˆå§‹åŒ–æœŸé—´ä¼šè¿è¡Œä¸¤æ¬¡ã€‚</span>
    <span class="token keyword control-flow">return</span> <span class="token function">createTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTodos</span><span class="token punctuation">(</span><span class="token parameter">prevTodos</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// è¯¥æ›´æ–°å‡½æ•°åœ¨æ¯æ¬¡ç‚¹å‡»ä¸­éƒ½ä¼šè¿è¡Œä¸¤æ¬¡</span>
      <span class="token keyword control-flow">return</span> <span class="token punctuation">[</span><span class="token spread operator">...</span>prevTodos<span class="token punctuation">,</span> <span class="token function">createTodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span></code></pre><p>è¿™æ˜¯æ‰€æœŸæœ›çš„ï¼Œä¸”ä¸åº”è¯¥ç ´åä½ çš„ä»£ç ã€‚<p>è¿™ç§ <strong>ä»…åœ¨å¼€å‘ç¯å¢ƒä¸‹ç”Ÿæ•ˆ</strong> çš„è¡Œä¸ºæœ‰åŠ©äº <a href="/learn/keeping-components-pure">ä¿æŒç»„ä»¶çš„çº¯ç²¹æ€§</a>ã€‚React ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªè°ƒç”¨çš„ç»“æœï¼Œè€Œå¿½ç•¥å¦ä¸€ä¸ªè°ƒç”¨çš„ç»“æœã€‚åªè¦ä½ çš„ç»„ä»¶ã€åˆå§‹åŒ–å‡½æ•°å’Œæ›´æ–°å‡½æ•°æ˜¯çº¯ç²¹çš„ï¼Œå°±ä¸ä¼šå½±å“ä½ çš„é€»è¾‘ã€‚ä½†æ˜¯ï¼Œå¦‚æœå®ƒä»¬æ„å¤–åœ°ä¸çº¯ç²¹ï¼Œè¿™å°†å¸®åŠ©ä½ æ³¨æ„åˆ°é”™è¯¯ã€‚<p>ä¾‹å¦‚ï¼Œè¿™ä¸ªä¸çº¯çš„æ›´æ–°å‡½æ•°æ”¹å˜äº† state ä¸­çš„ä¸€ä¸ªæ•°ç»„ï¼š<pre class="language-js"><code class="language-js"><span class="token function">setTodos</span><span class="token punctuation">(</span><span class="token parameter">prevTodos</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// ğŸš© é”™è¯¯ï¼šæ”¹å˜ state</span>
  prevTodos<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token function">createTodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>å› ä¸º React è°ƒç”¨äº†ä¸¤æ¬¡æ›´æ–°å‡½æ•°ï¼Œæ‰€ä»¥ä½ å°†çœ‹åˆ° todo è¢«æ·»åŠ äº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥ä½ å°†çŸ¥é“å‡ºç°äº†é”™è¯¯ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ <a href="#updating-objects-and-arrays-in-state">æ›¿æ¢æ•°ç»„è€Œä¸æ˜¯æ›´æ”¹æ•°ç»„</a> æ¥ä¿®å¤è¿™ä¸ªé”™è¯¯ï¼š<pre class="language-js"><code class="language-js"><span class="token function">setTodos</span><span class="token punctuation">(</span><span class="token parameter">prevTodos</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨æ–°çŠ¶æ€æ›¿æ¢</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">[</span><span class="token spread operator">...</span>prevTodos<span class="token punctuation">,</span> <span class="token function">createTodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ç°åœ¨ï¼Œè¿™ä¸ªæ›´æ–°å‡½æ•°æ˜¯çº¯ç²¹çš„ï¼Œæ‰€ä»¥å¤šè°ƒç”¨ä¸€æ¬¡ä¸ä¼šå¯¹è¡Œä¸ºäº§ç”Ÿå½±å“ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ React è°ƒç”¨å®ƒä¸¤æ¬¡å¯ä»¥å¸®åŠ©ä½ æ‰¾åˆ°é”™è¯¯çš„åŸå› ã€‚<strong>åªæœ‰ç»„ä»¶ã€åˆå§‹åŒ–å‡½æ•°å’Œæ›´æ–°å‡½æ•°éœ€è¦æ˜¯çº¯ç²¹çš„</strong>ã€‚äº‹ä»¶å¤„ç†å‡½æ•°ä¸éœ€è¦æ˜¯çº¯ç²¹çš„ï¼Œæ‰€ä»¥ React ä¸ä¼šä¸¤æ¬¡è°ƒç”¨ä½ çš„äº‹ä»¶å¤„ç†å‡½æ•°ã€‚<p>é˜…è¯» <a href="/learn/keeping-components-pure">ä¿æŒç»„ä»¶çº¯ç²¹</a> ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚</section><section class="level3"aria-labelledby="æˆ‘å°è¯•å°†-state-è®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°ä½†å®ƒå´è¢«è°ƒç”¨äº†-im-trying-to-set-state-to-a-function-but-it-gets-called-instead"><h3 id="æˆ‘å°è¯•å°†-state-è®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°ä½†å®ƒå´è¢«è°ƒç”¨äº†-im-trying-to-set-state-to-a-function-but-it-gets-called-instead">æˆ‘å°è¯•å°† state è®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œä½†å®ƒå´è¢«è°ƒç”¨äº† {/<em>im-trying-to-set-state-to-a-function-but-it-gets-called-instead</em>/}</h3><p>ä½ ä¸èƒ½åƒè¿™æ ·æŠŠå‡½æ•°æ”¾å…¥çŠ¶æ€ï¼š<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>fn<span class="token punctuation">,</span> setFn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>someFunction<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setFn</span><span class="token punctuation">(</span>someOtherFunction<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>å› ä¸ºä½ ä¼ é€’äº†ä¸€ä¸ªå‡½æ•°ï¼ŒReact è®¤ä¸º <code>someFunction</code> æ˜¯ä¸€ä¸ª <a href="#avoiding-recreating-the-initial-state">åˆå§‹åŒ–å‡½æ•°</a>ï¼Œè€Œ <code>someOtherFunction</code> æ˜¯ä¸€ä¸ª <a href="#updating-state-based-on-the-previous-state">æ›´æ–°å‡½æ•°</a>ï¼Œäºæ˜¯å®ƒå°è¯•è°ƒç”¨å®ƒä»¬å¹¶å­˜å‚¨ç»“æœã€‚è¦å®é™… <strong>å­˜å‚¨</strong> ä¸€ä¸ªå‡½æ•°ï¼Œä½ å¿…é¡»åœ¨ä¸¤ç§æƒ…å†µä¸‹åœ¨å®ƒä»¬ä¹‹å‰åŠ ä¸Š <code>() =></code>ã€‚ç„¶å React å°†å­˜å‚¨ä½ ä¼ é€’çš„å‡½æ•°ã€‚<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>fn<span class="token punctuation">,</span> setFn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> someFunction<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setFn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> someOtherFunction<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p><span style="float:footnote"><a href="../../index.html#toc">Go to TOC</a></span></section></section></inlinetoc></section>